Return-Path: <linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-arm-kernel@lfdr.de
Delivered-To: lists+linux-arm-kernel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 4B342C1815
	for <lists+linux-arm-kernel@lfdr.de>; Sun, 29 Sep 2019 19:41:37 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:References:In-Reply-To:
	Message-Id:Date:Subject:To:From:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=htBdApNL76dHoVs80l4/FhsmWQJ71yTQLGHXgNeRa9A=; b=Ph5h2iKB87N/Fw
	zdkqI5k+wNtSU0lHiJaE1ayNjQVsC3SQfzvmKzr9n6DbZOAlaFLhz5G6z0n8Em12gOHscjuDgwsfo
	Tj52V6wirFbPJ/ZljfFguQdhOvS2j30cEb1sbMxnDZgMdpF8u5M28tN83jM59w6orxd5fL8h6ZqOG
	MQoK5zJwl+0kLx2QHhkLC3JUtP2dsXApkwkCuEs6ABu0sbTtiZo/CmQD9m4V0FXH+umEynK+l5vU5
	2/MTLVH/ZiPNWBw5LW50KDbrAvGRiEiLBfPSncs5Yefzs6gDdmv68hKLBnmhIwqwNi9xxmCbtUZQ/
	oINxXGvjLrKfYmWfAZgw==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.2 #3 (Red Hat Linux))
	id 1iEdCI-0003dh-Tj; Sun, 29 Sep 2019 17:41:26 +0000
Received: from mail-wr1-x444.google.com ([2a00:1450:4864:20::444])
 by bombadil.infradead.org with esmtps (Exim 4.92.2 #3 (Red Hat Linux))
 id 1iEdA3-00015S-QV
 for linux-arm-kernel@lists.infradead.org; Sun, 29 Sep 2019 17:39:11 +0000
Received: by mail-wr1-x444.google.com with SMTP id v8so8465430wrt.2
 for <linux-arm-kernel@lists.infradead.org>;
 Sun, 29 Sep 2019 10:39:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=linaro.org; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=kCa/p54jEWDgK9V5rpRIaYdtgQsE53yTWCdIDmjZhv8=;
 b=j8fwr9VpbSeUihX8Lzi3S+M/4+apAk1rQt+tMvliyGuiQi9EugwIy6x7NWAd9Hwh+p
 mrBP9pXAbDXaXg+jnmH1EcwfyCcQ5q9XeXeM9k6waFtpuSr/Qey9Tt6MmWkHitspQb04
 RciIcASioWjm7jWfNQfWGyd+th9s+mAsA+JWe/bdEQ61FPUKguxtfDLe1smfJ9IoogOw
 6MLJ3DLsul/dXV6Cx2v1cOq5lz16qBNgkyACAvDFOEI287aqzAZ0AGfgQxBhCPCTDbSE
 8sZ9WlslsBoJ9ag//bX8uzmBgXmcGxRforDO5JA/flFlCIQBqzF2cYcTRff/a3y8Y3BP
 WDYw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=kCa/p54jEWDgK9V5rpRIaYdtgQsE53yTWCdIDmjZhv8=;
 b=eYwTIv341JGfMER5fw1UZy7X+EIvf+0FbuGvfO8cIM71Rz8jKpJaL7aDU+dJoULcpq
 UCZa4fr8IpK1P6Fa+GindP1rWK/bnJs3DqoP8GG4lcpzvrEr1g8GTzl/tfgH3uXbN0hI
 hGZyTFLlBg8OlpQx0D9Ppf3RkezmcNGAg3o8Mr45W3pr2d/75PHDTV/Ysv6hTw65UNnp
 h6xuifGx1YpeM1lbIDVGx+fqKwtA+93W9OTj6duZxFs9zUngl1g13jnnsADnC3T0D0ko
 Cogg6usWYj2bkM+tMPITmRDTbaZJtAzcMDFE+I1eAwFFQhJAyEoC2L+xnvtR+ejY29n4
 ihAw==
X-Gm-Message-State: APjAAAVhbKOAr62Ch5Fxyt7XrQ52DFs4eSeKEyoLyh+zmLQdoiCN8FMQ
 xKC2yx7513iWxhBseMkkjrbhBw==
X-Google-Smtp-Source: APXvYqyLpXPMAN0pZREyyc1iEAwCYSB/IC9Q9mcMYbSwYDzcHhRtheextR7ilNbwSdzWTMLlGd6VdQ==
X-Received: by 2002:adf:cf0c:: with SMTP id o12mr10289865wrj.30.1569778746244; 
 Sun, 29 Sep 2019 10:39:06 -0700 (PDT)
Received: from e123331-lin.nice.arm.com
 (bar06-5-82-246-156-241.fbx.proxad.net. [82.246.156.241])
 by smtp.gmail.com with ESMTPSA id q192sm17339779wme.23.2019.09.29.10.39.04
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Sun, 29 Sep 2019 10:39:05 -0700 (PDT)
From: Ard Biesheuvel <ard.biesheuvel@linaro.org>
To: linux-crypto@vger.kernel.org
Subject: [RFC PATCH 05/20] crypto: poly1305 - move into lib/crypto and
 refactor into library
Date: Sun, 29 Sep 2019 19:38:35 +0200
Message-Id: <20190929173850.26055-6-ard.biesheuvel@linaro.org>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20190929173850.26055-1-ard.biesheuvel@linaro.org>
References: <20190929173850.26055-1-ard.biesheuvel@linaro.org>
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190929_103908_084115_797AF070 
X-CRM114-Status: GOOD (  22.24  )
X-Spam-Score: -0.2 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-0.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [2a00:1450:4864:20:0:0:0:444 listed in]
 [list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
X-BeenThere: linux-arm-kernel@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-arm-kernel.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-arm-kernel/>
List-Post: <mailto:linux-arm-kernel@lists.infradead.org>
List-Help: <mailto:linux-arm-kernel-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=subscribe>
Cc: "Jason A . Donenfeld" <Jason@zx2c4.com>,
 Catalin Marinas <catalin.marinas@arm.com>,
 Herbert Xu <herbert@gondor.apana.org.au>, Arnd Bergmann <arnd@arndb.de>,
 Ard Biesheuvel <ard.biesheuvel@linaro.org>,
 Martin Willi <martin@strongswan.org>, Greg KH <gregkh@linuxfoundation.org>,
 Eric Biggers <ebiggers@google.com>, Samuel Neves <sneves@dei.uc.pt>,
 Will Deacon <will@kernel.org>, Dan Carpenter <dan.carpenter@oracle.com>,
 Andy Lutomirski <luto@kernel.org>, Marc Zyngier <maz@kernel.org>,
 Linus Torvalds <torvalds@linux-foundation.org>,
 David Miller <davem@davemloft.net>, linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-arm-kernel" <linux-arm-kernel-bounces@lists.infradead.org>
Errors-To: linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org

TW92ZSB0aGUgY29yZSBQb2x5MTMwNSB0cmFuc2Zvcm1hdGlvbiBpbnRvIGEgc2VwYXJhdGUgbGli
cmFyeSBpbgpsaWIvY3J5cHRvIHNvIGl0IGNhbiBiZSB1c2VkIGJ5IG90aGVyIHN1YnN5c3RlbXMg
d2l0aG91dCBnb2luZwp0aHJvdWdoIHRoZSBlbnRpcmUgY3J5cHRvIEFQSS4gQWxzbywgZXhwb3Nl
IHRoZSB1c3VhbCBpbml0LCB1cGRhdGUKYW5kIGZpbmFsIHJvdXRpbmVzIGFzIGxpYnJhcnkgZnVu
Y3Rpb25zIHNvIHRoYXQgdGhlIHRyYW5zZm9ybWF0aW9uCmNhbiBiZSBpbnZva2VkIHdpdGhvdXQg
Z29pbmcgdGhyb3VnaCB0aGUgY3J5cHRvIEFQSS4KCkFsc28sIGFkZCB0aGUgcGx1bWJpbmcgdGhh
dCBwZXJtaXRzIHRoZSBsaWJyYXJ5IHJvdXRpbmUgZW50cnlwb2ludHMgdG8KYmUgc3VwZXJzZWRl
ZCBieSBwZXItYXJjaCBhY2NlbGVyYXRlZCB2ZXJzaW9ucy4gVGhpcyB3aWxsIGJlIHVzZWQgaW4K
c3Vic2VxdWVudCBwYXRjaGVzIHRvIGV4cG9zZSB0aGUgY3J5cHRvIEFQSSBpbXBsZW1lbnRhdGlv
bnMgdmlhIHRoZQpsaWJyYXJ5IGludGVyZmFjZSBhcyB3ZWxsLgoKU2lnbmVkLW9mZi1ieTogQXJk
IEJpZXNoZXV2ZWwgPGFyZC5iaWVzaGV1dmVsQGxpbmFyby5vcmc+Ci0tLQogYXJjaC94ODYvY3J5
cHRvL3BvbHkxMzA1X2dsdWUuYyAgICB8ICA5MCArKystLS0tCiBjcnlwdG8vS2NvbmZpZyAgICAg
ICAgICAgICAgICAgICAgIHwgIDEyICsKIGNyeXB0by9hZGlhbnR1bS5jICAgICAgICAgICAgICAg
ICAgfCAgIDUgKy0KIGNyeXB0by9uaHBvbHkxMzA1LmMgICAgICAgICAgICAgICAgfCAgIDMgKy0K
IGNyeXB0by9wb2x5MTMwNV9nZW5lcmljLmMgICAgICAgICAgfCAxOTYgKystLS0tLS0tLS0tLS0t
LQogaW5jbHVkZS9jcnlwdG8vaW50ZXJuYWwvcG9seTEzMDUuaCB8ICA0NSArKysrCiBpbmNsdWRl
L2NyeXB0by9wb2x5MTMwNS5oICAgICAgICAgIHwgIDQzICsrLS0KIGxpYi9jcnlwdG8vTWFrZWZp
bGUgICAgICAgICAgICAgICAgfCAgIDMgKwogbGliL2NyeXB0by9wb2x5MTMwNS5jICAgICAgICAg
ICAgICB8IDI0NyArKysrKysrKysrKysrKysrKysrKwogOSBmaWxlcyBjaGFuZ2VkLCAzNjggaW5z
ZXJ0aW9ucygrKSwgMjc2IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2FyY2gveDg2L2NyeXB0
by9wb2x5MTMwNV9nbHVlLmMgYi9hcmNoL3g4Ni9jcnlwdG8vcG9seTEzMDVfZ2x1ZS5jCmluZGV4
IDRhMWMwNWRjZTk1MC4uYjQzYjkzYzk1ZTc5IDEwMDY0NAotLS0gYS9hcmNoL3g4Ni9jcnlwdG8v
cG9seTEzMDVfZ2x1ZS5jCisrKyBiL2FyY2gveDg2L2NyeXB0by9wb2x5MTMwNV9nbHVlLmMKQEAg
LTcsNDcgKzcsMjEgQEAKIAogI2luY2x1ZGUgPGNyeXB0by9hbGdhcGkuaD4KICNpbmNsdWRlIDxj
cnlwdG8vaW50ZXJuYWwvaGFzaC5oPgorI2luY2x1ZGUgPGNyeXB0by9pbnRlcm5hbC9wb2x5MTMw
NS5oPgogI2luY2x1ZGUgPGNyeXB0by9pbnRlcm5hbC9zaW1kLmg+Ci0jaW5jbHVkZSA8Y3J5cHRv
L3BvbHkxMzA1Lmg+CiAjaW5jbHVkZSA8bGludXgvY3J5cHRvLmg+CiAjaW5jbHVkZSA8bGludXgv
a2VybmVsLmg+CiAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiAjaW5jbHVkZSA8YXNtL3NpbWQu
aD4KIAotc3RydWN0IHBvbHkxMzA1X3NpbWRfZGVzY19jdHggewotCXN0cnVjdCBwb2x5MTMwNV9k
ZXNjX2N0eCBiYXNlOwotCS8qIGRlcml2ZWQga2V5IHUgc2V0PyAqLwotCWJvb2wgdXNldDsKLSNp
ZmRlZiBDT05GSUdfQVNfQVZYMgotCS8qIGRlcml2ZWQga2V5cyByXjMsIHJeNCBzZXQ/ICovCi0J
Ym9vbCB3c2V0OwotI2VuZGlmCi0JLyogZGVyaXZlZCBQb2x5MTMwNSBrZXkgcl4yICovCi0JdTMy
IHVbNV07Ci0JLyogLi4uIHNpbGVudGx5IGFwcGVuZGVkIHJeMyBhbmQgcl40IHdoZW4gdXNpbmcg
QVZYMiAqLwotfTsKLQogYXNtbGlua2FnZSB2b2lkIHBvbHkxMzA1X2Jsb2NrX3NzZTIodTMyICpo
LCBjb25zdCB1OCAqc3JjLAogCQkJCSAgICBjb25zdCB1MzIgKnIsIHVuc2lnbmVkIGludCBibG9j
a3MpOwogYXNtbGlua2FnZSB2b2lkIHBvbHkxMzA1XzJibG9ja19zc2UyKHUzMiAqaCwgY29uc3Qg
dTggKnNyYywgY29uc3QgdTMyICpyLAogCQkJCSAgICAgdW5zaWduZWQgaW50IGJsb2NrcywgY29u
c3QgdTMyICp1KTsKLSNpZmRlZiBDT05GSUdfQVNfQVZYMgogYXNtbGlua2FnZSB2b2lkIHBvbHkx
MzA1XzRibG9ja19hdngyKHUzMiAqaCwgY29uc3QgdTggKnNyYywgY29uc3QgdTMyICpyLAogCQkJ
CSAgICAgdW5zaWduZWQgaW50IGJsb2NrcywgY29uc3QgdTMyICp1KTsKLXN0YXRpYyBib29sIHBv
bHkxMzA1X3VzZV9hdngyOwotI2VuZGlmCiAKLXN0YXRpYyBpbnQgcG9seTEzMDVfc2ltZF9pbml0
KHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjKQotewotCXN0cnVjdCBwb2x5MTMwNV9zaW1kX2Rlc2Nf
Y3R4ICpzY3R4ID0gc2hhc2hfZGVzY19jdHgoZGVzYyk7Ci0KLQlzY3R4LT51c2V0ID0gZmFsc2U7
Ci0jaWZkZWYgQ09ORklHX0FTX0FWWDIKLQlzY3R4LT53c2V0ID0gZmFsc2U7Ci0jZW5kaWYKLQot
CXJldHVybiBjcnlwdG9fcG9seTEzMDVfaW5pdChkZXNjKTsKLX0KK3N0YXRpYyBib29sIHBvbHkx
MzA1X3VzZV9hdngyIF9fcm9fYWZ0ZXJfaW5pdDsKIAogc3RhdGljIHZvaWQgcG9seTEzMDVfc2lt
ZF9tdWx0KHUzMiAqYSwgY29uc3QgdTMyICpiKQogewpAQCAtNjMsNTMgKzM3LDQ5IEBAIHN0YXRp
YyB2b2lkIHBvbHkxMzA1X3NpbWRfbXVsdCh1MzIgKmEsIGNvbnN0IHUzMiAqYikKIHN0YXRpYyB1
bnNpZ25lZCBpbnQgcG9seTEzMDVfc2ltZF9ibG9ja3Moc3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4
ICpkY3R4LAogCQkJCQkgY29uc3QgdTggKnNyYywgdW5zaWduZWQgaW50IHNyY2xlbikKIHsKLQlz
dHJ1Y3QgcG9seTEzMDVfc2ltZF9kZXNjX2N0eCAqc2N0eDsKIAl1bnNpZ25lZCBpbnQgYmxvY2tz
LCBkYXRhbGVuOwogCi0JQlVJTERfQlVHX09OKG9mZnNldG9mKHN0cnVjdCBwb2x5MTMwNV9zaW1k
X2Rlc2NfY3R4LCBiYXNlKSk7Ci0Jc2N0eCA9IGNvbnRhaW5lcl9vZihkY3R4LCBzdHJ1Y3QgcG9s
eTEzMDVfc2ltZF9kZXNjX2N0eCwgYmFzZSk7Ci0KIAlpZiAodW5saWtlbHkoIWRjdHgtPnNzZXQp
KSB7CiAJCWRhdGFsZW4gPSBjcnlwdG9fcG9seTEzMDVfc2V0ZGVzY2tleShkY3R4LCBzcmMsIHNy
Y2xlbik7CiAJCXNyYyArPSBzcmNsZW4gLSBkYXRhbGVuOwogCQlzcmNsZW4gPSBkYXRhbGVuOwog
CX0KIAotI2lmZGVmIENPTkZJR19BU19BVlgyCi0JaWYgKHBvbHkxMzA1X3VzZV9hdngyICYmIHNy
Y2xlbiA+PSBQT0xZMTMwNV9CTE9DS19TSVpFICogNCkgewotCQlpZiAodW5saWtlbHkoIXNjdHgt
PndzZXQpKSB7Ci0JCQlpZiAoIXNjdHgtPnVzZXQpIHsKLQkJCQltZW1jcHkoc2N0eC0+dSwgZGN0
eC0+ci5yLCBzaXplb2Yoc2N0eC0+dSkpOwotCQkJCXBvbHkxMzA1X3NpbWRfbXVsdChzY3R4LT51
LCBkY3R4LT5yLnIpOwotCQkJCXNjdHgtPnVzZXQgPSB0cnVlOworCWlmIChJU19FTkFCTEVEKENP
TkZJR19BU19BVlgyKSAmJgorCSAgICBwb2x5MTMwNV91c2VfYXZ4MiAmJgorCSAgICBzcmNsZW4g
Pj0gUE9MWTEzMDVfQkxPQ0tfU0laRSAqIDQpIHsKKwkJaWYgKHVubGlrZWx5KGRjdHgtPnJzZXQg
PCA0KSkgeworCQkJaWYgKGRjdHgtPnJzZXQgPCAyKSB7CisJCQkJZGN0eC0+clsxXSA9IGRjdHgt
PnJbMF07CisJCQkJcG9seTEzMDVfc2ltZF9tdWx0KGRjdHgtPnJbMV0uciwgZGN0eC0+clswXS5y
KTsKIAkJCX0KLQkJCW1lbWNweShzY3R4LT51ICsgNSwgc2N0eC0+dSwgc2l6ZW9mKHNjdHgtPnUp
KTsKLQkJCXBvbHkxMzA1X3NpbWRfbXVsdChzY3R4LT51ICsgNSwgZGN0eC0+ci5yKTsKLQkJCW1l
bWNweShzY3R4LT51ICsgMTAsIHNjdHgtPnUgKyA1LCBzaXplb2Yoc2N0eC0+dSkpOwotCQkJcG9s
eTEzMDVfc2ltZF9tdWx0KHNjdHgtPnUgKyAxMCwgZGN0eC0+ci5yKTsKLQkJCXNjdHgtPndzZXQg
PSB0cnVlOworCQkJZGN0eC0+clsyXSA9IGRjdHgtPnJbMV07CisJCQlwb2x5MTMwNV9zaW1kX211
bHQoZGN0eC0+clsyXS5yLCBkY3R4LT5yWzBdLnIpOworCQkJZGN0eC0+clszXSA9IGRjdHgtPnJb
Ml07CisJCQlwb2x5MTMwNV9zaW1kX211bHQoZGN0eC0+clszXS5yLCBkY3R4LT5yWzBdLnIpOwor
CQkJZGN0eC0+cnNldCA9IDQ7CiAJCX0KIAkJYmxvY2tzID0gc3JjbGVuIC8gKFBPTFkxMzA1X0JM
T0NLX1NJWkUgKiA0KTsKLQkJcG9seTEzMDVfNGJsb2NrX2F2eDIoZGN0eC0+aC5oLCBzcmMsIGRj
dHgtPnIuciwgYmxvY2tzLAotCQkJCSAgICAgc2N0eC0+dSk7CisJCXBvbHkxMzA1XzRibG9ja19h
dngyKGRjdHgtPmguaCwgc3JjLCBkY3R4LT5yWzBdLnIsIGJsb2NrcywKKwkJCQkgICAgIGRjdHgt
PnJbMV0ucik7CiAJCXNyYyArPSBQT0xZMTMwNV9CTE9DS19TSVpFICogNCAqIGJsb2NrczsKIAkJ
c3JjbGVuIC09IFBPTFkxMzA1X0JMT0NLX1NJWkUgKiA0ICogYmxvY2tzOwogCX0KLSNlbmRpZgor
CiAJaWYgKGxpa2VseShzcmNsZW4gPj0gUE9MWTEzMDVfQkxPQ0tfU0laRSAqIDIpKSB7Ci0JCWlm
ICh1bmxpa2VseSghc2N0eC0+dXNldCkpIHsKLQkJCW1lbWNweShzY3R4LT51LCBkY3R4LT5yLnIs
IHNpemVvZihzY3R4LT51KSk7Ci0JCQlwb2x5MTMwNV9zaW1kX211bHQoc2N0eC0+dSwgZGN0eC0+
ci5yKTsKLQkJCXNjdHgtPnVzZXQgPSB0cnVlOworCQlpZiAodW5saWtlbHkoZGN0eC0+cnNldCA8
IDIpKSB7CisJCQlkY3R4LT5yWzFdID0gZGN0eC0+clswXTsKKwkJCXBvbHkxMzA1X3NpbWRfbXVs
dChkY3R4LT5yWzFdLnIsIGRjdHgtPnJbMF0ucik7CisJCQlkY3R4LT5yc2V0ID0gMjsKIAkJfQog
CQlibG9ja3MgPSBzcmNsZW4gLyAoUE9MWTEzMDVfQkxPQ0tfU0laRSAqIDIpOwotCQlwb2x5MTMw
NV8yYmxvY2tfc3NlMihkY3R4LT5oLmgsIHNyYywgZGN0eC0+ci5yLCBibG9ja3MsCi0JCQkJICAg
ICBzY3R4LT51KTsKKwkJcG9seTEzMDVfMmJsb2NrX3NzZTIoZGN0eC0+aC5oLCBzcmMsIGRjdHgt
PnJbMF0uciwKKwkJCQkgICAgIGJsb2NrcywgZGN0eC0+clsxXS5yKTsKIAkJc3JjICs9IFBPTFkx
MzA1X0JMT0NLX1NJWkUgKiAyICogYmxvY2tzOwogCQlzcmNsZW4gLT0gUE9MWTEzMDVfQkxPQ0tf
U0laRSAqIDIgKiBibG9ja3M7CiAJfQogCWlmIChzcmNsZW4gPj0gUE9MWTEzMDVfQkxPQ0tfU0la
RSkgewotCQlwb2x5MTMwNV9ibG9ja19zc2UyKGRjdHgtPmguaCwgc3JjLCBkY3R4LT5yLnIsIDEp
OworCQlwb2x5MTMwNV9ibG9ja19zc2UyKGRjdHgtPmguaCwgc3JjLCBkY3R4LT5yWzBdLnIsIDEp
OwogCQlzcmNsZW4gLT0gUE9MWTEzMDVfQkxPQ0tfU0laRTsKIAl9CiAJcmV0dXJuIHNyY2xlbjsK
QEAgLTE1OSwxMCArMTI5LDEwIEBAIHN0YXRpYyBpbnQgcG9seTEzMDVfc2ltZF91cGRhdGUoc3Ry
dWN0IHNoYXNoX2Rlc2MgKmRlc2MsCiAKIHN0YXRpYyBzdHJ1Y3Qgc2hhc2hfYWxnIGFsZyA9IHsK
IAkuZGlnZXN0c2l6ZQk9IFBPTFkxMzA1X0RJR0VTVF9TSVpFLAotCS5pbml0CQk9IHBvbHkxMzA1
X3NpbWRfaW5pdCwKKwkuaW5pdAkJPSBjcnlwdG9fcG9seTEzMDVfaW5pdCwKIAkudXBkYXRlCQk9
IHBvbHkxMzA1X3NpbWRfdXBkYXRlLAogCS5maW5hbAkJPSBjcnlwdG9fcG9seTEzMDVfZmluYWws
Ci0JLmRlc2NzaXplCT0gc2l6ZW9mKHN0cnVjdCBwb2x5MTMwNV9zaW1kX2Rlc2NfY3R4KSwKKwku
ZGVzY3NpemUJPSBzaXplb2Yoc3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4KSwKIAkuYmFzZQkJPSB7
CiAJCS5jcmFfbmFtZQkJPSAicG9seTEzMDUiLAogCQkuY3JhX2RyaXZlcl9uYW1lCT0gInBvbHkx
MzA1LXNpbWQiLApAQCAtMTc3LDE0ICsxNDcsMTQgQEAgc3RhdGljIGludCBfX2luaXQgcG9seTEz
MDVfc2ltZF9tb2RfaW5pdCh2b2lkKQogCWlmICghYm9vdF9jcHVfaGFzKFg4Nl9GRUFUVVJFX1hN
TTIpKQogCQlyZXR1cm4gLUVOT0RFVjsKIAotI2lmZGVmIENPTkZJR19BU19BVlgyCi0JcG9seTEz
MDVfdXNlX2F2eDIgPSBib290X2NwdV9oYXMoWDg2X0ZFQVRVUkVfQVZYKSAmJgorCXBvbHkxMzA1
X3VzZV9hdngyID0gSVNfRU5BQkxFRChDT05GSUdfQVNfQVZYMikgJiYKKwkJCSAgICBib290X2Nw
dV9oYXMoWDg2X0ZFQVRVUkVfQVZYKSAmJgogCQkJICAgIGJvb3RfY3B1X2hhcyhYODZfRkVBVFVS
RV9BVlgyKSAmJgogCQkJICAgIGNwdV9oYXNfeGZlYXR1cmVzKFhGRUFUVVJFX01BU0tfU1NFIHwg
WEZFQVRVUkVfTUFTS19ZTU0sIE5VTEwpOwotCWFsZy5kZXNjc2l6ZSA9IHNpemVvZihzdHJ1Y3Qg
cG9seTEzMDVfc2ltZF9kZXNjX2N0eCk7CisJYWxnLmRlc2NzaXplID0gc2l6ZW9mKHN0cnVjdCBw
b2x5MTMwNV9kZXNjX2N0eCkgKyA1ICogc2l6ZW9mKHUzMik7CiAJaWYgKHBvbHkxMzA1X3VzZV9h
dngyKQogCQlhbGcuZGVzY3NpemUgKz0gMTAgKiBzaXplb2YodTMyKTsKLSNlbmRpZgorCiAJcmV0
dXJuIGNyeXB0b19yZWdpc3Rlcl9zaGFzaCgmYWxnKTsKIH0KIApkaWZmIC0tZ2l0IGEvY3J5cHRv
L0tjb25maWcgYi9jcnlwdG8vS2NvbmZpZwppbmRleCA3ODBkMDgwZmM1ZWMuLmY0MGU4ZGNhNTdk
MSAxMDA2NDQKLS0tIGEvY3J5cHRvL0tjb25maWcKKysrIGIvY3J5cHRvL0tjb25maWcKQEAgLTY1
NCw5ICs2NTQsMjEgQEAgY29uZmlnIENSWVBUT19HSEFTSAogCSAgR0hBU0ggaXMgdGhlIGhhc2gg
ZnVuY3Rpb24gdXNlZCBpbiBHQ00gKEdhbG9pcy9Db3VudGVyIE1vZGUpLgogCSAgSXQgaXMgbm90
IGEgZ2VuZXJhbC1wdXJwb3NlIGNyeXB0b2dyYXBoaWMgaGFzaCBmdW5jdGlvbi4KIAorY29uZmln
IENSWVBUT19BUkNIX0hBVkVfTElCX1BPTFkxMzA1CisJdHJpc3RhdGUKKworY29uZmlnIENSWVBU
T19MSUJfUE9MWTEzMDVfUlNJWkUKKwlpbnQKKwlkZWZhdWx0IDEKKworY29uZmlnIENSWVBUT19M
SUJfUE9MWTEzMDUKKwl0cmlzdGF0ZSAiUG9seTEzMDUgYXV0aGVudGljYXRvciBsaWJyYXJ5Igor
CWRlcGVuZHMgb24gQ1JZUFRPX0FSQ0hfSEFWRV9MSUJfUE9MWTEzMDUgfHwgIUNSWVBUT19BUkNI
X0hBVkVfTElCX1BPTFkxMzA1CisKIGNvbmZpZyBDUllQVE9fUE9MWTEzMDUKIAl0cmlzdGF0ZSAi
UG9seTEzMDUgYXV0aGVudGljYXRvciBhbGdvcml0aG0iCiAJc2VsZWN0IENSWVBUT19IQVNICisJ
c2VsZWN0IENSWVBUT19MSUJfUE9MWTEzMDUKIAloZWxwCiAJICBQb2x5MTMwNSBhdXRoZW50aWNh
dG9yIGFsZ29yaXRobSwgUkZDNzUzOS4KIApkaWZmIC0tZ2l0IGEvY3J5cHRvL2FkaWFudHVtLmMg
Yi9jcnlwdG8vYWRpYW50dW0uYwppbmRleCAzOTVhM2RkZDM3MDcuLmFkZWQyNjA5MjI2OCAxMDA2
NDQKLS0tIGEvY3J5cHRvL2FkaWFudHVtLmMKKysrIGIvY3J5cHRvL2FkaWFudHVtLmMKQEAgLTMz
LDYgKzMzLDcgQEAKICNpbmNsdWRlIDxjcnlwdG8vYjEyOG9wcy5oPgogI2luY2x1ZGUgPGNyeXB0
by9jaGFjaGEuaD4KICNpbmNsdWRlIDxjcnlwdG8vaW50ZXJuYWwvaGFzaC5oPgorI2luY2x1ZGUg
PGNyeXB0by9pbnRlcm5hbC9wb2x5MTMwNS5oPgogI2luY2x1ZGUgPGNyeXB0by9pbnRlcm5hbC9z
a2NpcGhlci5oPgogI2luY2x1ZGUgPGNyeXB0by9uaHBvbHkxMzA1Lmg+CiAjaW5jbHVkZSA8Y3J5
cHRvL3NjYXR0ZXJ3YWxrLmg+CkBAIC0yNDIsMTEgKzI0MywxMSBAQCBzdGF0aWMgdm9pZCBhZGlh
bnR1bV9oYXNoX2hlYWRlcihzdHJ1Y3Qgc2tjaXBoZXJfcmVxdWVzdCAqcmVxKQogCiAJQlVJTERf
QlVHX09OKHNpemVvZihoZWFkZXIpICUgUE9MWTEzMDVfQkxPQ0tfU0laRSAhPSAwKTsKIAlwb2x5
MTMwNV9jb3JlX2Jsb2Nrcygmc3RhdGUsICZ0Y3R4LT5oZWFkZXJfaGFzaF9rZXksCi0JCQkgICAg
ICZoZWFkZXIsIHNpemVvZihoZWFkZXIpIC8gUE9MWTEzMDVfQkxPQ0tfU0laRSk7CisJCQkgICAg
ICZoZWFkZXIsIHNpemVvZihoZWFkZXIpIC8gUE9MWTEzMDVfQkxPQ0tfU0laRSwgMSk7CiAKIAlC
VUlMRF9CVUdfT04oVFdFQUtfU0laRSAlIFBPTFkxMzA1X0JMT0NLX1NJWkUgIT0gMCk7CiAJcG9s
eTEzMDVfY29yZV9ibG9ja3MoJnN0YXRlLCAmdGN0eC0+aGVhZGVyX2hhc2hfa2V5LCByZXEtPml2
LAotCQkJICAgICBUV0VBS19TSVpFIC8gUE9MWTEzMDVfQkxPQ0tfU0laRSk7CisJCQkgICAgIFRX
RUFLX1NJWkUgLyBQT0xZMTMwNV9CTE9DS19TSVpFLCAxKTsKIAogCXBvbHkxMzA1X2NvcmVfZW1p
dCgmc3RhdGUsICZyY3R4LT5oZWFkZXJfaGFzaCk7CiB9CmRpZmYgLS1naXQgYS9jcnlwdG8vbmhw
b2x5MTMwNS5jIGIvY3J5cHRvL25ocG9seTEzMDUuYwppbmRleCA5YWI0ZTA3Y2RlNGQuLmY2YjZh
NTIwOTJiNCAxMDA2NDQKLS0tIGEvY3J5cHRvL25ocG9seTEzMDUuYworKysgYi9jcnlwdG8vbmhw
b2x5MTMwNS5jCkBAIC0zMyw2ICszMyw3IEBACiAjaW5jbHVkZSA8YXNtL3VuYWxpZ25lZC5oPgog
I2luY2x1ZGUgPGNyeXB0by9hbGdhcGkuaD4KICNpbmNsdWRlIDxjcnlwdG8vaW50ZXJuYWwvaGFz
aC5oPgorI2luY2x1ZGUgPGNyeXB0by9pbnRlcm5hbC9wb2x5MTMwNS5oPgogI2luY2x1ZGUgPGNy
eXB0by9uaHBvbHkxMzA1Lmg+CiAjaW5jbHVkZSA8bGludXgvY3J5cHRvLmg+CiAjaW5jbHVkZSA8
bGludXgva2VybmVsLmg+CkBAIC03OCw3ICs3OSw3IEBAIHN0YXRpYyB2b2lkIHByb2Nlc3Nfbmhf
aGFzaF92YWx1ZShzdHJ1Y3Qgbmhwb2x5MTMwNV9zdGF0ZSAqc3RhdGUsCiAJQlVJTERfQlVHX09O
KE5IX0hBU0hfQllURVMgJSBQT0xZMTMwNV9CTE9DS19TSVpFICE9IDApOwogCiAJcG9seTEzMDVf
Y29yZV9ibG9ja3MoJnN0YXRlLT5wb2x5X3N0YXRlLCAma2V5LT5wb2x5X2tleSwgc3RhdGUtPm5o
X2hhc2gsCi0JCQkgICAgIE5IX0hBU0hfQllURVMgLyBQT0xZMTMwNV9CTE9DS19TSVpFKTsKKwkJ
CSAgICAgTkhfSEFTSF9CWVRFUyAvIFBPTFkxMzA1X0JMT0NLX1NJWkUsIDEpOwogfQogCiAvKgpk
aWZmIC0tZ2l0IGEvY3J5cHRvL3BvbHkxMzA1X2dlbmVyaWMuYyBiL2NyeXB0by9wb2x5MTMwNV9n
ZW5lcmljLmMKaW5kZXggYWRjNDAyOThjNzQ5Li4zNWZkYjM1YzExODggMTAwNjQ0Ci0tLSBhL2Ny
eXB0by9wb2x5MTMwNV9nZW5lcmljLmMKKysrIGIvY3J5cHRvL3BvbHkxMzA1X2dlbmVyaWMuYwpA
QCAtMTMsNTEgKzEzLDI1IEBACiAKICNpbmNsdWRlIDxjcnlwdG8vYWxnYXBpLmg+CiAjaW5jbHVk
ZSA8Y3J5cHRvL2ludGVybmFsL2hhc2guaD4KLSNpbmNsdWRlIDxjcnlwdG8vcG9seTEzMDUuaD4K
KyNpbmNsdWRlIDxjcnlwdG8vaW50ZXJuYWwvcG9seTEzMDUuaD4KICNpbmNsdWRlIDxsaW51eC9j
cnlwdG8uaD4KICNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KICNpbmNsdWRlIDxsaW51eC9tb2R1
bGUuaD4KICNpbmNsdWRlIDxhc20vdW5hbGlnbmVkLmg+CiAKLXN0YXRpYyBpbmxpbmUgdTY0IG1s
dCh1NjQgYSwgdTY0IGIpCi17Ci0JcmV0dXJuIGEgKiBiOwotfQotCi1zdGF0aWMgaW5saW5lIHUz
MiBzcih1NjQgdiwgdV9jaGFyIG4pCi17Ci0JcmV0dXJuIHYgPj4gbjsKLX0KLQotc3RhdGljIGlu
bGluZSB1MzIgYW5kKHUzMiB2LCB1MzIgbWFzaykKLXsKLQlyZXR1cm4gdiAmIG1hc2s7Ci19Ci0K
IGludCBjcnlwdG9fcG9seTEzMDVfaW5pdChzdHJ1Y3Qgc2hhc2hfZGVzYyAqZGVzYykKIHsKIAlz
dHJ1Y3QgcG9seTEzMDVfZGVzY19jdHggKmRjdHggPSBzaGFzaF9kZXNjX2N0eChkZXNjKTsKIAog
CXBvbHkxMzA1X2NvcmVfaW5pdCgmZGN0eC0+aCk7CiAJZGN0eC0+YnVmbGVuID0gMDsKLQlkY3R4
LT5yc2V0ID0gZmFsc2U7CisJZGN0eC0+cnNldCA9IDA7CiAJZGN0eC0+c3NldCA9IGZhbHNlOwog
CiAJcmV0dXJuIDA7CiB9CiBFWFBPUlRfU1lNQk9MX0dQTChjcnlwdG9fcG9seTEzMDVfaW5pdCk7
CiAKLXZvaWQgcG9seTEzMDVfY29yZV9zZXRrZXkoc3RydWN0IHBvbHkxMzA1X2tleSAqa2V5LCBj
b25zdCB1OCAqcmF3X2tleSkKLXsKLQkvKiByICY9IDB4ZmZmZmZmYzBmZmZmZmZjMGZmZmZmZmMw
ZmZmZmZmZiAqLwotCWtleS0+clswXSA9IChnZXRfdW5hbGlnbmVkX2xlMzIocmF3X2tleSArICAw
KSA+PiAwKSAmIDB4M2ZmZmZmZjsKLQlrZXktPnJbMV0gPSAoZ2V0X3VuYWxpZ25lZF9sZTMyKHJh
d19rZXkgKyAgMykgPj4gMikgJiAweDNmZmZmMDM7Ci0Ja2V5LT5yWzJdID0gKGdldF91bmFsaWdu
ZWRfbGUzMihyYXdfa2V5ICsgIDYpID4+IDQpICYgMHgzZmZjMGZmOwotCWtleS0+clszXSA9IChn
ZXRfdW5hbGlnbmVkX2xlMzIocmF3X2tleSArICA5KSA+PiA2KSAmIDB4M2YwM2ZmZjsKLQlrZXkt
PnJbNF0gPSAoZ2V0X3VuYWxpZ25lZF9sZTMyKHJhd19rZXkgKyAxMikgPj4gOCkgJiAweDAwZmZm
ZmY7Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChwb2x5MTMwNV9jb3JlX3NldGtleSk7Ci0KIC8qCiAg
KiBQb2x5MTMwNSByZXF1aXJlcyBhIHVuaXF1ZSBrZXkgZm9yIGVhY2ggdGFnLCB3aGljaCBpbXBs
aWVzIHRoYXQgd2UgY2FuJ3Qgc2V0CiAgKiBpdCBvbiB0aGUgdGZtIHRoYXQgZ2V0cyBhY2Nlc3Nl
ZCBieSBtdWx0aXBsZSB1c2VycyBzaW11bHRhbmVvdXNseS4gSW5zdGVhZCB3ZQpAQCAtNjgsMTAg
KzQyLDEwIEBAIHVuc2lnbmVkIGludCBjcnlwdG9fcG9seTEzMDVfc2V0ZGVzY2tleShzdHJ1Y3Qg
cG9seTEzMDVfZGVzY19jdHggKmRjdHgsCiB7CiAJaWYgKCFkY3R4LT5zc2V0KSB7CiAJCWlmICgh
ZGN0eC0+cnNldCAmJiBzcmNsZW4gPj0gUE9MWTEzMDVfQkxPQ0tfU0laRSkgewotCQkJcG9seTEz
MDVfY29yZV9zZXRrZXkoJmRjdHgtPnIsIHNyYyk7CisJCQlwb2x5MTMwNV9jb3JlX3NldGtleShk
Y3R4LT5yLCBzcmMpOwogCQkJc3JjICs9IFBPTFkxMzA1X0JMT0NLX1NJWkU7CiAJCQlzcmNsZW4g
LT0gUE9MWTEzMDVfQkxPQ0tfU0laRTsKLQkJCWRjdHgtPnJzZXQgPSB0cnVlOworCQkJZGN0eC0+
cnNldCA9IDE7CiAJCX0KIAkJaWYgKHNyY2xlbiA+PSBQT0xZMTMwNV9CTE9DS19TSVpFKSB7CiAJ
CQlkY3R4LT5zWzBdID0gZ2V0X3VuYWxpZ25lZF9sZTMyKHNyYyArICAwKTsKQEAgLTg3LDg0ICs2
MSw4IEBAIHVuc2lnbmVkIGludCBjcnlwdG9fcG9seTEzMDVfc2V0ZGVzY2tleShzdHJ1Y3QgcG9s
eTEzMDVfZGVzY19jdHggKmRjdHgsCiB9CiBFWFBPUlRfU1lNQk9MX0dQTChjcnlwdG9fcG9seTEz
MDVfc2V0ZGVzY2tleSk7CiAKLXN0YXRpYyB2b2lkIHBvbHkxMzA1X2Jsb2Nrc19pbnRlcm5hbChz
dHJ1Y3QgcG9seTEzMDVfc3RhdGUgKnN0YXRlLAotCQkJCSAgICAgY29uc3Qgc3RydWN0IHBvbHkx
MzA1X2tleSAqa2V5LAotCQkJCSAgICAgY29uc3Qgdm9pZCAqc3JjLCB1bnNpZ25lZCBpbnQgbmJs
b2NrcywKLQkJCQkgICAgIHUzMiBoaWJpdCkKLXsKLQl1MzIgcjAsIHIxLCByMiwgcjMsIHI0Owot
CXUzMiBzMSwgczIsIHMzLCBzNDsKLQl1MzIgaDAsIGgxLCBoMiwgaDMsIGg0OwotCXU2NCBkMCwg
ZDEsIGQyLCBkMywgZDQ7Ci0KLQlpZiAoIW5ibG9ja3MpCi0JCXJldHVybjsKLQotCXIwID0ga2V5
LT5yWzBdOwotCXIxID0ga2V5LT5yWzFdOwotCXIyID0ga2V5LT5yWzJdOwotCXIzID0ga2V5LT5y
WzNdOwotCXI0ID0ga2V5LT5yWzRdOwotCi0JczEgPSByMSAqIDU7Ci0JczIgPSByMiAqIDU7Ci0J
czMgPSByMyAqIDU7Ci0JczQgPSByNCAqIDU7Ci0KLQloMCA9IHN0YXRlLT5oWzBdOwotCWgxID0g
c3RhdGUtPmhbMV07Ci0JaDIgPSBzdGF0ZS0+aFsyXTsKLQloMyA9IHN0YXRlLT5oWzNdOwotCWg0
ID0gc3RhdGUtPmhbNF07Ci0KLQlkbyB7Ci0JCS8qIGggKz0gbVtpXSAqLwotCQloMCArPSAoZ2V0
X3VuYWxpZ25lZF9sZTMyKHNyYyArICAwKSA+PiAwKSAmIDB4M2ZmZmZmZjsKLQkJaDEgKz0gKGdl
dF91bmFsaWduZWRfbGUzMihzcmMgKyAgMykgPj4gMikgJiAweDNmZmZmZmY7Ci0JCWgyICs9IChn
ZXRfdW5hbGlnbmVkX2xlMzIoc3JjICsgIDYpID4+IDQpICYgMHgzZmZmZmZmOwotCQloMyArPSAo
Z2V0X3VuYWxpZ25lZF9sZTMyKHNyYyArICA5KSA+PiA2KSAmIDB4M2ZmZmZmZjsKLQkJaDQgKz0g
KGdldF91bmFsaWduZWRfbGUzMihzcmMgKyAxMikgPj4gOCkgfCBoaWJpdDsKLQotCQkvKiBoICo9
IHIgKi8KLQkJZDAgPSBtbHQoaDAsIHIwKSArIG1sdChoMSwgczQpICsgbWx0KGgyLCBzMykgKwot
CQkgICAgIG1sdChoMywgczIpICsgbWx0KGg0LCBzMSk7Ci0JCWQxID0gbWx0KGgwLCByMSkgKyBt
bHQoaDEsIHIwKSArIG1sdChoMiwgczQpICsKLQkJICAgICBtbHQoaDMsIHMzKSArIG1sdChoNCwg
czIpOwotCQlkMiA9IG1sdChoMCwgcjIpICsgbWx0KGgxLCByMSkgKyBtbHQoaDIsIHIwKSArCi0J
CSAgICAgbWx0KGgzLCBzNCkgKyBtbHQoaDQsIHMzKTsKLQkJZDMgPSBtbHQoaDAsIHIzKSArIG1s
dChoMSwgcjIpICsgbWx0KGgyLCByMSkgKwotCQkgICAgIG1sdChoMywgcjApICsgbWx0KGg0LCBz
NCk7Ci0JCWQ0ID0gbWx0KGgwLCByNCkgKyBtbHQoaDEsIHIzKSArIG1sdChoMiwgcjIpICsKLQkJ
ICAgICBtbHQoaDMsIHIxKSArIG1sdChoNCwgcjApOwotCi0JCS8qIChwYXJ0aWFsKSBoICU9IHAg
Ki8KLQkJZDEgKz0gc3IoZDAsIDI2KTsgICAgIGgwID0gYW5kKGQwLCAweDNmZmZmZmYpOwotCQlk
MiArPSBzcihkMSwgMjYpOyAgICAgaDEgPSBhbmQoZDEsIDB4M2ZmZmZmZik7Ci0JCWQzICs9IHNy
KGQyLCAyNik7ICAgICBoMiA9IGFuZChkMiwgMHgzZmZmZmZmKTsKLQkJZDQgKz0gc3IoZDMsIDI2
KTsgICAgIGgzID0gYW5kKGQzLCAweDNmZmZmZmYpOwotCQloMCArPSBzcihkNCwgMjYpICogNTsg
aDQgPSBhbmQoZDQsIDB4M2ZmZmZmZik7Ci0JCWgxICs9IGgwID4+IDI2OyAgICAgICBoMCA9IGgw
ICYgMHgzZmZmZmZmOwotCi0JCXNyYyArPSBQT0xZMTMwNV9CTE9DS19TSVpFOwotCX0gd2hpbGUg
KC0tbmJsb2Nrcyk7Ci0KLQlzdGF0ZS0+aFswXSA9IGgwOwotCXN0YXRlLT5oWzFdID0gaDE7Ci0J
c3RhdGUtPmhbMl0gPSBoMjsKLQlzdGF0ZS0+aFszXSA9IGgzOwotCXN0YXRlLT5oWzRdID0gaDQ7
Ci19Ci0KLXZvaWQgcG9seTEzMDVfY29yZV9ibG9ja3Moc3RydWN0IHBvbHkxMzA1X3N0YXRlICpz
dGF0ZSwKLQkJCSAgY29uc3Qgc3RydWN0IHBvbHkxMzA1X2tleSAqa2V5LAotCQkJICBjb25zdCB2
b2lkICpzcmMsIHVuc2lnbmVkIGludCBuYmxvY2tzKQotewotCXBvbHkxMzA1X2Jsb2Nrc19pbnRl
cm5hbChzdGF0ZSwga2V5LCBzcmMsIG5ibG9ja3MsIDEgPDwgMjQpOwotfQotRVhQT1JUX1NZTUJP
TF9HUEwocG9seTEzMDVfY29yZV9ibG9ja3MpOwotCi1zdGF0aWMgdm9pZCBwb2x5MTMwNV9ibG9j
a3Moc3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4ICpkY3R4LAotCQkJICAgIGNvbnN0IHU4ICpzcmMs
IHVuc2lnbmVkIGludCBzcmNsZW4sIHUzMiBoaWJpdCkKK3N0YXRpYyB2b2lkIHBvbHkxMzA1X2Js
b2NrcyhzdHJ1Y3QgcG9seTEzMDVfZGVzY19jdHggKmRjdHgsIGNvbnN0IHU4ICpzcmMsCisJCQkg
ICAgdW5zaWduZWQgaW50IHNyY2xlbikKIHsKIAl1bnNpZ25lZCBpbnQgZGF0YWxlbjsKIApAQCAt
MTc0LDE0ICs3MiwxNCBAQCBzdGF0aWMgdm9pZCBwb2x5MTMwNV9ibG9ja3Moc3RydWN0IHBvbHkx
MzA1X2Rlc2NfY3R4ICpkY3R4LAogCQlzcmNsZW4gPSBkYXRhbGVuOwogCX0KIAotCXBvbHkxMzA1
X2Jsb2Nrc19pbnRlcm5hbCgmZGN0eC0+aCwgJmRjdHgtPnIsCi0JCQkJIHNyYywgc3JjbGVuIC8g
UE9MWTEzMDVfQkxPQ0tfU0laRSwgaGliaXQpOworCXBvbHkxMzA1X2NvcmVfYmxvY2tzKCZkY3R4
LT5oLCBkY3R4LT5yLCBzcmMsCisJCQkgICAgIHNyY2xlbiAvIFBPTFkxMzA1X0JMT0NLX1NJWkUs
IDEpOwogfQogCi1pbnQgY3J5cHRvX3BvbHkxMzA1X3VwZGF0ZShzdHJ1Y3Qgc2hhc2hfZGVzYyAq
ZGVzYywKK2ludCBjcnlwdG9fcG9seTEzMDVfdXBkYXRlKHN0cnVjdCBzaGFzaF9kZXNjICpzaGFz
aF9kZXNjLAogCQkJICAgY29uc3QgdTggKnNyYywgdW5zaWduZWQgaW50IHNyY2xlbikKIHsKLQlz
dHJ1Y3QgcG9seTEzMDVfZGVzY19jdHggKmRjdHggPSBzaGFzaF9kZXNjX2N0eChkZXNjKTsKKwlz
dHJ1Y3QgcG9seTEzMDVfZGVzY19jdHggKmRjdHggPSBzaGFzaF9kZXNjX2N0eChzaGFzaF9kZXNj
KTsKIAl1bnNpZ25lZCBpbnQgYnl0ZXM7CiAKIAlpZiAodW5saWtlbHkoZGN0eC0+YnVmbGVuKSkg
ewpAQCAtMTkzLDEzICs5MSwxMyBAQCBpbnQgY3J5cHRvX3BvbHkxMzA1X3VwZGF0ZShzdHJ1Y3Qg
c2hhc2hfZGVzYyAqZGVzYywKIAogCQlpZiAoZGN0eC0+YnVmbGVuID09IFBPTFkxMzA1X0JMT0NL
X1NJWkUpIHsKIAkJCXBvbHkxMzA1X2Jsb2NrcyhkY3R4LCBkY3R4LT5idWYsCi0JCQkJCVBPTFkx
MzA1X0JMT0NLX1NJWkUsIDEgPDwgMjQpOworCQkJCQlQT0xZMTMwNV9CTE9DS19TSVpFKTsKIAkJ
CWRjdHgtPmJ1ZmxlbiA9IDA7CiAJCX0KIAl9CiAKIAlpZiAobGlrZWx5KHNyY2xlbiA+PSBQT0xZ
MTMwNV9CTE9DS19TSVpFKSkgewotCQlwb2x5MTMwNV9ibG9ja3MoZGN0eCwgc3JjLCBzcmNsZW4s
IDEgPDwgMjQpOworCQlwb2x5MTMwNV9ibG9ja3MoZGN0eCwgc3JjLCBzcmNsZW4pOwogCQlzcmMg
Kz0gc3JjbGVuIC0gKHNyY2xlbiAlIFBPTFkxMzA1X0JMT0NLX1NJWkUpOwogCQlzcmNsZW4gJT0g
UE9MWTEzMDVfQkxPQ0tfU0laRTsKIAl9CkBAIC0yMTMsODIgKzExMSwxNCBAQCBpbnQgY3J5cHRv
X3BvbHkxMzA1X3VwZGF0ZShzdHJ1Y3Qgc2hhc2hfZGVzYyAqZGVzYywKIH0KIEVYUE9SVF9TWU1C
T0xfR1BMKGNyeXB0b19wb2x5MTMwNV91cGRhdGUpOwogCi12b2lkIHBvbHkxMzA1X2NvcmVfZW1p
dChjb25zdCBzdHJ1Y3QgcG9seTEzMDVfc3RhdGUgKnN0YXRlLCB2b2lkICpkc3QpCi17Ci0JdTMy
IGgwLCBoMSwgaDIsIGgzLCBoNDsKLQl1MzIgZzAsIGcxLCBnMiwgZzMsIGc0OwotCXUzMiBtYXNr
OwotCi0JLyogZnVsbHkgY2FycnkgaCAqLwotCWgwID0gc3RhdGUtPmhbMF07Ci0JaDEgPSBzdGF0
ZS0+aFsxXTsKLQloMiA9IHN0YXRlLT5oWzJdOwotCWgzID0gc3RhdGUtPmhbM107Ci0JaDQgPSBz
dGF0ZS0+aFs0XTsKLQotCWgyICs9IChoMSA+PiAyNik7ICAgICBoMSA9IGgxICYgMHgzZmZmZmZm
OwotCWgzICs9IChoMiA+PiAyNik7ICAgICBoMiA9IGgyICYgMHgzZmZmZmZmOwotCWg0ICs9ICho
MyA+PiAyNik7ICAgICBoMyA9IGgzICYgMHgzZmZmZmZmOwotCWgwICs9IChoNCA+PiAyNikgKiA1
OyBoNCA9IGg0ICYgMHgzZmZmZmZmOwotCWgxICs9IChoMCA+PiAyNik7ICAgICBoMCA9IGgwICYg
MHgzZmZmZmZmOwotCi0JLyogY29tcHV0ZSBoICsgLXAgKi8KLQlnMCA9IGgwICsgNTsKLQlnMSA9
IGgxICsgKGcwID4+IDI2KTsgICAgICAgICAgICAgZzAgJj0gMHgzZmZmZmZmOwotCWcyID0gaDIg
KyAoZzEgPj4gMjYpOyAgICAgICAgICAgICBnMSAmPSAweDNmZmZmZmY7Ci0JZzMgPSBoMyArIChn
MiA+PiAyNik7ICAgICAgICAgICAgIGcyICY9IDB4M2ZmZmZmZjsKLQlnNCA9IGg0ICsgKGczID4+
IDI2KSAtICgxIDw8IDI2KTsgZzMgJj0gMHgzZmZmZmZmOwotCi0JLyogc2VsZWN0IGggaWYgaCA8
IHAsIG9yIGggKyAtcCBpZiBoID49IHAgKi8KLQltYXNrID0gKGc0ID4+ICgoc2l6ZW9mKHUzMikg
KiA4KSAtIDEpKSAtIDE7Ci0JZzAgJj0gbWFzazsKLQlnMSAmPSBtYXNrOwotCWcyICY9IG1hc2s7
Ci0JZzMgJj0gbWFzazsKLQlnNCAmPSBtYXNrOwotCW1hc2sgPSB+bWFzazsKLQloMCA9IChoMCAm
IG1hc2spIHwgZzA7Ci0JaDEgPSAoaDEgJiBtYXNrKSB8IGcxOwotCWgyID0gKGgyICYgbWFzaykg
fCBnMjsKLQloMyA9IChoMyAmIG1hc2spIHwgZzM7Ci0JaDQgPSAoaDQgJiBtYXNrKSB8IGc0Owot
Ci0JLyogaCA9IGggJSAoMl4xMjgpICovCi0JcHV0X3VuYWxpZ25lZF9sZTMyKChoMCA+PiAgMCkg
fCAoaDEgPDwgMjYpLCBkc3QgKyAgMCk7Ci0JcHV0X3VuYWxpZ25lZF9sZTMyKChoMSA+PiAgNikg
fCAoaDIgPDwgMjApLCBkc3QgKyAgNCk7Ci0JcHV0X3VuYWxpZ25lZF9sZTMyKChoMiA+PiAxMikg
fCAoaDMgPDwgMTQpLCBkc3QgKyAgOCk7Ci0JcHV0X3VuYWxpZ25lZF9sZTMyKChoMyA+PiAxOCkg
fCAoaDQgPDwgIDgpLCBkc3QgKyAxMik7Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChwb2x5MTMwNV9j
b3JlX2VtaXQpOwotCiBpbnQgY3J5cHRvX3BvbHkxMzA1X2ZpbmFsKHN0cnVjdCBzaGFzaF9kZXNj
ICpkZXNjLCB1OCAqZHN0KQogewogCXN0cnVjdCBwb2x5MTMwNV9kZXNjX2N0eCAqZGN0eCA9IHNo
YXNoX2Rlc2NfY3R4KGRlc2MpOwotCV9fbGUzMiBkaWdlc3RbNF07Ci0JdTY0IGYgPSAwOwogCiAJ
aWYgKHVubGlrZWx5KCFkY3R4LT5zc2V0KSkKIAkJcmV0dXJuIC1FTk9LRVk7CiAKLQlpZiAodW5s
aWtlbHkoZGN0eC0+YnVmbGVuKSkgewotCQlkY3R4LT5idWZbZGN0eC0+YnVmbGVuKytdID0gMTsK
LQkJbWVtc2V0KGRjdHgtPmJ1ZiArIGRjdHgtPmJ1ZmxlbiwgMCwKLQkJICAgICAgIFBPTFkxMzA1
X0JMT0NLX1NJWkUgLSBkY3R4LT5idWZsZW4pOwotCQlwb2x5MTMwNV9ibG9ja3MoZGN0eCwgZGN0
eC0+YnVmLCBQT0xZMTMwNV9CTE9DS19TSVpFLCAwKTsKLQl9Ci0KLQlwb2x5MTMwNV9jb3JlX2Vt
aXQoJmRjdHgtPmgsIGRpZ2VzdCk7Ci0KLQkvKiBtYWMgPSAoaCArIHMpICUgKDJeMTI4KSAqLwot
CWYgPSAoZiA+PiAzMikgKyBsZTMyX3RvX2NwdShkaWdlc3RbMF0pICsgZGN0eC0+c1swXTsKLQlw
dXRfdW5hbGlnbmVkX2xlMzIoZiwgZHN0ICsgMCk7Ci0JZiA9IChmID4+IDMyKSArIGxlMzJfdG9f
Y3B1KGRpZ2VzdFsxXSkgKyBkY3R4LT5zWzFdOwotCXB1dF91bmFsaWduZWRfbGUzMihmLCBkc3Qg
KyA0KTsKLQlmID0gKGYgPj4gMzIpICsgbGUzMl90b19jcHUoZGlnZXN0WzJdKSArIGRjdHgtPnNb
Ml07Ci0JcHV0X3VuYWxpZ25lZF9sZTMyKGYsIGRzdCArIDgpOwotCWYgPSAoZiA+PiAzMikgKyBs
ZTMyX3RvX2NwdShkaWdlc3RbM10pICsgZGN0eC0+c1szXTsKLQlwdXRfdW5hbGlnbmVkX2xlMzIo
ZiwgZHN0ICsgMTIpOwotCisJcG9seTEzMDVfZmluYWxfZ2VuZXJpYyhkY3R4LCBkc3QpOwogCXJl
dHVybiAwOwogfQogRVhQT1JUX1NZTUJPTF9HUEwoY3J5cHRvX3BvbHkxMzA1X2ZpbmFsKTsKZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvY3J5cHRvL2ludGVybmFsL3BvbHkxMzA1LmggYi9pbmNsdWRlL2Ny
eXB0by9pbnRlcm5hbC9wb2x5MTMwNS5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAw
MDAwMDAwMC4uZTgxOWRmMTRiYjc4Ci0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS9jcnlwdG8v
aW50ZXJuYWwvcG9seTEzMDUuaApAQCAtMCwwICsxLDQ1IEBACisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMCAqLworLyoKKyAqIENvbW1vbiB2YWx1ZXMgZm9yIHRoZSBQb2x5MTMw
NSBhbGdvcml0aG0KKyAqLworCisjaWZuZGVmIF9DUllQVE9fSU5URVJOQUxfUE9MWTEzMDVfSAor
I2RlZmluZSBfQ1JZUFRPX0lOVEVSTkFMX1BPTFkxMzA1X0gKKworI2luY2x1ZGUgPGxpbnV4L3R5
cGVzLmg+CisjaW5jbHVkZSA8Y3J5cHRvL3BvbHkxMzA1Lmg+CisKK3N0cnVjdCBzaGFzaF9kZXNj
OworCisvKgorICogUG9seTEzMDUgY29yZSBmdW5jdGlvbnMuICBUaGVzZSBpbXBsZW1lbnQgdGhl
IM61LWFsbW9zdC3iiIYtdW5pdmVyc2FsIGhhc2gKKyAqIGZ1bmN0aW9uIHVuZGVybHlpbmcgdGhl
IFBvbHkxMzA1IE1BQywgaS5lLiB0aGV5IGRvbid0IGFkZCBhbiBlbmNyeXB0ZWQgbm9uY2UKKyAq
ICgicyBrZXkiKSBhdCB0aGUgZW5kLiAgVGhleSBhbHNvIG9ubHkgc3VwcG9ydCBibG9jay1hbGln
bmVkIGlucHV0cy4KKyAqLwordm9pZCBwb2x5MTMwNV9jb3JlX3NldGtleShzdHJ1Y3QgcG9seTEz
MDVfa2V5ICprZXksIGNvbnN0IHU4ICpyYXdfa2V5KTsKK3N0YXRpYyBpbmxpbmUgdm9pZCBwb2x5
MTMwNV9jb3JlX2luaXQoc3RydWN0IHBvbHkxMzA1X3N0YXRlICpzdGF0ZSkKK3sKKwkqc3RhdGUg
PSAoc3RydWN0IHBvbHkxMzA1X3N0YXRlKXt9OworfQorCit2b2lkIHBvbHkxMzA1X2NvcmVfYmxv
Y2tzKHN0cnVjdCBwb2x5MTMwNV9zdGF0ZSAqc3RhdGUsCisJCQkgIGNvbnN0IHN0cnVjdCBwb2x5
MTMwNV9rZXkgKmtleSwgY29uc3Qgdm9pZCAqc3JjLAorCQkJICB1bnNpZ25lZCBpbnQgbmJsb2Nr
cywgdTMyIGhpYml0KTsKK3ZvaWQgcG9seTEzMDVfY29yZV9lbWl0KGNvbnN0IHN0cnVjdCBwb2x5
MTMwNV9zdGF0ZSAqc3RhdGUsIHZvaWQgKmRzdCk7CisKK3ZvaWQgcG9seTEzMDVfaW5pdF9nZW5l
cmljKHN0cnVjdCBwb2x5MTMwNV9kZXNjX2N0eCAqZGVzYywgY29uc3QgdTggKmtleSk7CisKK3Zv
aWQgcG9seTEzMDVfdXBkYXRlX2dlbmVyaWMoc3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4ICpkZXNj
LCBjb25zdCB1OCAqc3JjLAorCQkJICAgICB1bnNpZ25lZCBpbnQgbmJ5dGVzKTsKKwordm9pZCBw
b2x5MTMwNV9maW5hbF9nZW5lcmljKHN0cnVjdCBwb2x5MTMwNV9kZXNjX2N0eCAqZGVzYywgdTgg
KmRpZ2VzdCk7CisKKy8qIENyeXB0byBBUEkgaGVscGVyIGZ1bmN0aW9ucyBmb3IgdGhlIFBvbHkx
MzA1IE1BQyAqLworaW50IGNyeXB0b19wb2x5MTMwNV9pbml0KHN0cnVjdCBzaGFzaF9kZXNjICpk
ZXNjKTsKK3Vuc2lnbmVkIGludCBjcnlwdG9fcG9seTEzMDVfc2V0ZGVzY2tleShzdHJ1Y3QgcG9s
eTEzMDVfZGVzY19jdHggKmRjdHgsCisJCQkJCWNvbnN0IHU4ICpzcmMsIHVuc2lnbmVkIGludCBz
cmNsZW4pOworaW50IGNyeXB0b19wb2x5MTMwNV91cGRhdGUoc3RydWN0IHNoYXNoX2Rlc2MgKmRl
c2MsCisJCQkgICBjb25zdCB1OCAqc3JjLCB1bnNpZ25lZCBpbnQgc3JjbGVuKTsKK2ludCBjcnlw
dG9fcG9seTEzMDVfZmluYWwoc3RydWN0IHNoYXNoX2Rlc2MgKmRlc2MsIHU4ICpkc3QpOworCisj
ZW5kaWYKZGlmZiAtLWdpdCBhL2luY2x1ZGUvY3J5cHRvL3BvbHkxMzA1LmggYi9pbmNsdWRlL2Ny
eXB0by9wb2x5MTMwNS5oCmluZGV4IDM0MzE3ZWQyMDcxZS4uMzlhZmVhMDE2YWMzIDEwMDY0NAot
LS0gYS9pbmNsdWRlL2NyeXB0by9wb2x5MTMwNS5oCisrKyBiL2luY2x1ZGUvY3J5cHRvL3BvbHkx
MzA1LmgKQEAgLTIyLDQzICsyMiwyNiBAQCBzdHJ1Y3QgcG9seTEzMDVfc3RhdGUgewogfTsKIAog
c3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4IHsKLQkvKiBrZXkgKi8KLQlzdHJ1Y3QgcG9seTEzMDVf
a2V5IHI7Ci0JLyogZmluYWxpemUga2V5ICovCi0JdTMyIHNbNF07Ci0JLyogYWNjdW11bGF0b3Ig
Ki8KLQlzdHJ1Y3QgcG9seTEzMDVfc3RhdGUgaDsKIAkvKiBwYXJ0aWFsIGJ1ZmZlciAqLwogCXU4
IGJ1ZltQT0xZMTMwNV9CTE9DS19TSVpFXTsKIAkvKiBieXRlcyB1c2VkIGluIHBhcnRpYWwgYnVm
ZmVyICovCiAJdW5zaWduZWQgaW50IGJ1ZmxlbjsKLQkvKiByIGtleSBoYXMgYmVlbiBzZXQgKi8K
LQlib29sIHJzZXQ7Ci0JLyogcyBrZXkgaGFzIGJlZW4gc2V0ICovCisJLyogaG93IG1hbnkga2V5
cyBoYXZlIGJlZW4gc2V0IGluIHJbXSAqLworCXVuc2lnbmVkIHNob3J0IHJzZXQ7CisJLyogd2hl
dGhlciBzW10gaGFzIGJlZW4gc2V0ICovCiAJYm9vbCBzc2V0OworCS8qIGZpbmFsaXplIGtleSAq
LworCXUzMiBzWzRdOworCS8qIGFjY3VtdWxhdG9yICovCisJc3RydWN0IHBvbHkxMzA1X3N0YXRl
IGg7CisJLyoga2V5ICovCisJc3RydWN0IHBvbHkxMzA1X2tleSByW0NPTkZJR19DUllQVE9fTElC
X1BPTFkxMzA1X1JTSVpFXTsKIH07CiAKLS8qCi0gKiBQb2x5MTMwNSBjb3JlIGZ1bmN0aW9ucy4g
IFRoZXNlIGltcGxlbWVudCB0aGUgzrUtYWxtb3N0LeKIhi11bml2ZXJzYWwgaGFzaAotICogZnVu
Y3Rpb24gdW5kZXJseWluZyB0aGUgUG9seTEzMDUgTUFDLCBpLmUuIHRoZXkgZG9uJ3QgYWRkIGFu
IGVuY3J5cHRlZCBub25jZQotICogKCJzIGtleSIpIGF0IHRoZSBlbmQuICBUaGV5IGFsc28gb25s
eSBzdXBwb3J0IGJsb2NrLWFsaWduZWQgaW5wdXRzLgotICovCi12b2lkIHBvbHkxMzA1X2NvcmVf
c2V0a2V5KHN0cnVjdCBwb2x5MTMwNV9rZXkgKmtleSwgY29uc3QgdTggKnJhd19rZXkpOwotc3Rh
dGljIGlubGluZSB2b2lkIHBvbHkxMzA1X2NvcmVfaW5pdChzdHJ1Y3QgcG9seTEzMDVfc3RhdGUg
KnN0YXRlKQotewotCW1lbXNldChzdGF0ZS0+aCwgMCwgc2l6ZW9mKHN0YXRlLT5oKSk7Ci19Ci12
b2lkIHBvbHkxMzA1X2NvcmVfYmxvY2tzKHN0cnVjdCBwb2x5MTMwNV9zdGF0ZSAqc3RhdGUsCi0J
CQkgIGNvbnN0IHN0cnVjdCBwb2x5MTMwNV9rZXkgKmtleSwKLQkJCSAgY29uc3Qgdm9pZCAqc3Jj
LCB1bnNpZ25lZCBpbnQgbmJsb2Nrcyk7Ci12b2lkIHBvbHkxMzA1X2NvcmVfZW1pdChjb25zdCBz
dHJ1Y3QgcG9seTEzMDVfc3RhdGUgKnN0YXRlLCB2b2lkICpkc3QpOwordm9pZCBwb2x5MTMwNV9p
bml0KHN0cnVjdCBwb2x5MTMwNV9kZXNjX2N0eCAqZGVzYywgY29uc3QgdTggKmtleSk7CiAKLS8q
IENyeXB0byBBUEkgaGVscGVyIGZ1bmN0aW9ucyBmb3IgdGhlIFBvbHkxMzA1IE1BQyAqLwotaW50
IGNyeXB0b19wb2x5MTMwNV9pbml0KHN0cnVjdCBzaGFzaF9kZXNjICpkZXNjKTsKLXVuc2lnbmVk
IGludCBjcnlwdG9fcG9seTEzMDVfc2V0ZGVzY2tleShzdHJ1Y3QgcG9seTEzMDVfZGVzY19jdHgg
KmRjdHgsCi0JCQkJCWNvbnN0IHU4ICpzcmMsIHVuc2lnbmVkIGludCBzcmNsZW4pOwotaW50IGNy
eXB0b19wb2x5MTMwNV91cGRhdGUoc3RydWN0IHNoYXNoX2Rlc2MgKmRlc2MsCi0JCQkgICBjb25z
dCB1OCAqc3JjLCB1bnNpZ25lZCBpbnQgc3JjbGVuKTsKLWludCBjcnlwdG9fcG9seTEzMDVfZmlu
YWwoc3RydWN0IHNoYXNoX2Rlc2MgKmRlc2MsIHU4ICpkc3QpOwordm9pZCBwb2x5MTMwNV91cGRh
dGUoc3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4ICpkZXNjLCBjb25zdCB1OCAqc3JjLAorCQkgICAg
IHVuc2lnbmVkIGludCBuYnl0ZXMpOwordm9pZCBwb2x5MTMwNV9maW5hbChzdHJ1Y3QgcG9seTEz
MDVfZGVzY19jdHggKmRlc2MsIHU4ICpkaWdlc3QpOwogCiAjZW5kaWYKZGlmZiAtLWdpdCBhL2xp
Yi9jcnlwdG8vTWFrZWZpbGUgYi9saWIvY3J5cHRvL01ha2VmaWxlCmluZGV4IDI0ZGFkMDU4ZjJh
ZS4uNmJmOGEwYTRlZTBlIDEwMDY0NAotLS0gYS9saWIvY3J5cHRvL01ha2VmaWxlCisrKyBiL2xp
Yi9jcnlwdG8vTWFrZWZpbGUKQEAgLTEyLDUgKzEyLDggQEAgbGliYXJjNC15CQkJCQk6PSBhcmM0
Lm8KIG9iai0kKENPTkZJR19DUllQVE9fTElCX0RFUykJCQkrPSBsaWJkZXMubwogbGliZGVzLXkJ
CQkJCTo9IGRlcy5vCiAKK29iai0kKENPTkZJR19DUllQVE9fTElCX1BPTFkxMzA1KQkJKz0gbGli
cG9seTEzMDUubworbGlicG9seTEzMDUteQkJCQkJOj0gcG9seTEzMDUubworCiBvYmotJChDT05G
SUdfQ1JZUFRPX0xJQl9TSEEyNTYpCQkJKz0gbGlic2hhMjU2Lm8KIGxpYnNoYTI1Ni15CQkJCQk6
PSBzaGEyNTYubwpkaWZmIC0tZ2l0IGEvbGliL2NyeXB0by9wb2x5MTMwNS5jIGIvbGliL2NyeXB0
by9wb2x5MTMwNS5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMTlk
NjQ0MWNjMzBhCi0tLSAvZGV2L251bGwKKysrIGIvbGliL2NyeXB0by9wb2x5MTMwNS5jCkBAIC0w
LDAgKzEsMjQ3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRl
cgorLyoKKyAqIFBvbHkxMzA1IGF1dGhlbnRpY2F0b3IgYWxnb3JpdGhtLCBSRkM3NTM5CisgKgor
ICogQ29weXJpZ2h0IChDKSAyMDE1IE1hcnRpbiBXaWxsaQorICoKKyAqIEJhc2VkIG9uIHB1Ymxp
YyBkb21haW4gY29kZSBieSBBbmRyZXcgTW9vbiBhbmQgRGFuaWVsIEouIEJlcm5zdGVpbi4KKyAq
LworCisjaW5jbHVkZSA8Y3J5cHRvL2ludGVybmFsL3BvbHkxMzA1Lmg+CisjaW5jbHVkZSA8bGlu
dXgva2VybmVsLmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisjaW5jbHVkZSA8YXNtL3Vu
YWxpZ25lZC5oPgorCitzdGF0aWMgaW5saW5lIHU2NCBtbHQodTY0IGEsIHU2NCBiKQoreworCXJl
dHVybiBhICogYjsKK30KKworc3RhdGljIGlubGluZSB1MzIgc3IodTY0IHYsIHVfY2hhciBuKQor
eworCXJldHVybiB2ID4+IG47Cit9CisKK3N0YXRpYyBpbmxpbmUgdTMyIGFuZCh1MzIgdiwgdTMy
IG1hc2spCit7CisJcmV0dXJuIHYgJiBtYXNrOworfQorCit2b2lkIHBvbHkxMzA1X2NvcmVfc2V0
a2V5KHN0cnVjdCBwb2x5MTMwNV9rZXkgKmtleSwgY29uc3QgdTggKnJhd19rZXkpCit7CisJLyog
ciAmPSAweGZmZmZmZmMwZmZmZmZmYzBmZmZmZmZjMGZmZmZmZmYgKi8KKwlrZXktPnJbMF0gPSAo
Z2V0X3VuYWxpZ25lZF9sZTMyKHJhd19rZXkgKyAgMCkgPj4gMCkgJiAweDNmZmZmZmY7CisJa2V5
LT5yWzFdID0gKGdldF91bmFsaWduZWRfbGUzMihyYXdfa2V5ICsgIDMpID4+IDIpICYgMHgzZmZm
ZjAzOworCWtleS0+clsyXSA9IChnZXRfdW5hbGlnbmVkX2xlMzIocmF3X2tleSArICA2KSA+PiA0
KSAmIDB4M2ZmYzBmZjsKKwlrZXktPnJbM10gPSAoZ2V0X3VuYWxpZ25lZF9sZTMyKHJhd19rZXkg
KyAgOSkgPj4gNikgJiAweDNmMDNmZmY7CisJa2V5LT5yWzRdID0gKGdldF91bmFsaWduZWRfbGUz
MihyYXdfa2V5ICsgMTIpID4+IDgpICYgMHgwMGZmZmZmOworfQorRVhQT1JUX1NZTUJPTF9HUEwo
cG9seTEzMDVfY29yZV9zZXRrZXkpOworCit2b2lkIHBvbHkxMzA1X2NvcmVfYmxvY2tzKHN0cnVj
dCBwb2x5MTMwNV9zdGF0ZSAqc3RhdGUsCisJCQkgIGNvbnN0IHN0cnVjdCBwb2x5MTMwNV9rZXkg
KmtleSwgY29uc3Qgdm9pZCAqc3JjLAorCQkJICB1bnNpZ25lZCBpbnQgbmJsb2NrcywgdTMyIGhp
Yml0KQoreworCXUzMiByMCwgcjEsIHIyLCByMywgcjQ7CisJdTMyIHMxLCBzMiwgczMsIHM0Owor
CXUzMiBoMCwgaDEsIGgyLCBoMywgaDQ7CisJdTY0IGQwLCBkMSwgZDIsIGQzLCBkNDsKKworCWlm
ICghbmJsb2NrcykKKwkJcmV0dXJuOworCisJcjAgPSBrZXktPnJbMF07CisJcjEgPSBrZXktPnJb
MV07CisJcjIgPSBrZXktPnJbMl07CisJcjMgPSBrZXktPnJbM107CisJcjQgPSBrZXktPnJbNF07
CisKKwlzMSA9IHIxICogNTsKKwlzMiA9IHIyICogNTsKKwlzMyA9IHIzICogNTsKKwlzNCA9IHI0
ICogNTsKKworCWgwID0gc3RhdGUtPmhbMF07CisJaDEgPSBzdGF0ZS0+aFsxXTsKKwloMiA9IHN0
YXRlLT5oWzJdOworCWgzID0gc3RhdGUtPmhbM107CisJaDQgPSBzdGF0ZS0+aFs0XTsKKworCWRv
IHsKKwkJLyogaCArPSBtW2ldICovCisJCWgwICs9IChnZXRfdW5hbGlnbmVkX2xlMzIoc3JjICsg
IDApID4+IDApICYgMHgzZmZmZmZmOworCQloMSArPSAoZ2V0X3VuYWxpZ25lZF9sZTMyKHNyYyAr
ICAzKSA+PiAyKSAmIDB4M2ZmZmZmZjsKKwkJaDIgKz0gKGdldF91bmFsaWduZWRfbGUzMihzcmMg
KyAgNikgPj4gNCkgJiAweDNmZmZmZmY7CisJCWgzICs9IChnZXRfdW5hbGlnbmVkX2xlMzIoc3Jj
ICsgIDkpID4+IDYpICYgMHgzZmZmZmZmOworCQloNCArPSAoZ2V0X3VuYWxpZ25lZF9sZTMyKHNy
YyArIDEyKSA+PiA4KSB8IChoaWJpdCA8PCAyNCk7CisKKwkJLyogaCAqPSByICovCisJCWQwID0g
bWx0KGgwLCByMCkgKyBtbHQoaDEsIHM0KSArIG1sdChoMiwgczMpICsKKwkJICAgICBtbHQoaDMs
IHMyKSArIG1sdChoNCwgczEpOworCQlkMSA9IG1sdChoMCwgcjEpICsgbWx0KGgxLCByMCkgKyBt
bHQoaDIsIHM0KSArCisJCSAgICAgbWx0KGgzLCBzMykgKyBtbHQoaDQsIHMyKTsKKwkJZDIgPSBt
bHQoaDAsIHIyKSArIG1sdChoMSwgcjEpICsgbWx0KGgyLCByMCkgKworCQkgICAgIG1sdChoMywg
czQpICsgbWx0KGg0LCBzMyk7CisJCWQzID0gbWx0KGgwLCByMykgKyBtbHQoaDEsIHIyKSArIG1s
dChoMiwgcjEpICsKKwkJICAgICBtbHQoaDMsIHIwKSArIG1sdChoNCwgczQpOworCQlkNCA9IG1s
dChoMCwgcjQpICsgbWx0KGgxLCByMykgKyBtbHQoaDIsIHIyKSArCisJCSAgICAgbWx0KGgzLCBy
MSkgKyBtbHQoaDQsIHIwKTsKKworCQkvKiAocGFydGlhbCkgaCAlPSBwICovCisJCWQxICs9IHNy
KGQwLCAyNik7ICAgICBoMCA9IGFuZChkMCwgMHgzZmZmZmZmKTsKKwkJZDIgKz0gc3IoZDEsIDI2
KTsgICAgIGgxID0gYW5kKGQxLCAweDNmZmZmZmYpOworCQlkMyArPSBzcihkMiwgMjYpOyAgICAg
aDIgPSBhbmQoZDIsIDB4M2ZmZmZmZik7CisJCWQ0ICs9IHNyKGQzLCAyNik7ICAgICBoMyA9IGFu
ZChkMywgMHgzZmZmZmZmKTsKKwkJaDAgKz0gc3IoZDQsIDI2KSAqIDU7IGg0ID0gYW5kKGQ0LCAw
eDNmZmZmZmYpOworCQloMSArPSBoMCA+PiAyNjsgICAgICAgaDAgPSBoMCAmIDB4M2ZmZmZmZjsK
KworCQlzcmMgKz0gUE9MWTEzMDVfQkxPQ0tfU0laRTsKKwl9IHdoaWxlICgtLW5ibG9ja3MpOwor
CisJc3RhdGUtPmhbMF0gPSBoMDsKKwlzdGF0ZS0+aFsxXSA9IGgxOworCXN0YXRlLT5oWzJdID0g
aDI7CisJc3RhdGUtPmhbM10gPSBoMzsKKwlzdGF0ZS0+aFs0XSA9IGg0OworfQorRVhQT1JUX1NZ
TUJPTF9HUEwocG9seTEzMDVfY29yZV9ibG9ja3MpOworCit2b2lkIHBvbHkxMzA1X2NvcmVfZW1p
dChjb25zdCBzdHJ1Y3QgcG9seTEzMDVfc3RhdGUgKnN0YXRlLCB2b2lkICpkc3QpCit7CisJdTMy
IGgwLCBoMSwgaDIsIGgzLCBoNDsKKwl1MzIgZzAsIGcxLCBnMiwgZzMsIGc0OworCXUzMiBtYXNr
OworCisJLyogZnVsbHkgY2FycnkgaCAqLworCWgwID0gc3RhdGUtPmhbMF07CisJaDEgPSBzdGF0
ZS0+aFsxXTsKKwloMiA9IHN0YXRlLT5oWzJdOworCWgzID0gc3RhdGUtPmhbM107CisJaDQgPSBz
dGF0ZS0+aFs0XTsKKworCWgyICs9IChoMSA+PiAyNik7ICAgICBoMSA9IGgxICYgMHgzZmZmZmZm
OworCWgzICs9IChoMiA+PiAyNik7ICAgICBoMiA9IGgyICYgMHgzZmZmZmZmOworCWg0ICs9ICho
MyA+PiAyNik7ICAgICBoMyA9IGgzICYgMHgzZmZmZmZmOworCWgwICs9IChoNCA+PiAyNikgKiA1
OyBoNCA9IGg0ICYgMHgzZmZmZmZmOworCWgxICs9IChoMCA+PiAyNik7ICAgICBoMCA9IGgwICYg
MHgzZmZmZmZmOworCisJLyogY29tcHV0ZSBoICsgLXAgKi8KKwlnMCA9IGgwICsgNTsKKwlnMSA9
IGgxICsgKGcwID4+IDI2KTsgICAgICAgICAgICAgZzAgJj0gMHgzZmZmZmZmOworCWcyID0gaDIg
KyAoZzEgPj4gMjYpOyAgICAgICAgICAgICBnMSAmPSAweDNmZmZmZmY7CisJZzMgPSBoMyArIChn
MiA+PiAyNik7ICAgICAgICAgICAgIGcyICY9IDB4M2ZmZmZmZjsKKwlnNCA9IGg0ICsgKGczID4+
IDI2KSAtICgxIDw8IDI2KTsgZzMgJj0gMHgzZmZmZmZmOworCisJLyogc2VsZWN0IGggaWYgaCA8
IHAsIG9yIGggKyAtcCBpZiBoID49IHAgKi8KKwltYXNrID0gKGc0ID4+ICgoc2l6ZW9mKHUzMikg
KiA4KSAtIDEpKSAtIDE7CisJZzAgJj0gbWFzazsKKwlnMSAmPSBtYXNrOworCWcyICY9IG1hc2s7
CisJZzMgJj0gbWFzazsKKwlnNCAmPSBtYXNrOworCW1hc2sgPSB+bWFzazsKKwloMCA9IChoMCAm
IG1hc2spIHwgZzA7CisJaDEgPSAoaDEgJiBtYXNrKSB8IGcxOworCWgyID0gKGgyICYgbWFzaykg
fCBnMjsKKwloMyA9IChoMyAmIG1hc2spIHwgZzM7CisJaDQgPSAoaDQgJiBtYXNrKSB8IGc0Owor
CisJLyogaCA9IGggJSAoMl4xMjgpICovCisJcHV0X3VuYWxpZ25lZF9sZTMyKChoMCA+PiAgMCkg
fCAoaDEgPDwgMjYpLCBkc3QgKyAgMCk7CisJcHV0X3VuYWxpZ25lZF9sZTMyKChoMSA+PiAgNikg
fCAoaDIgPDwgMjApLCBkc3QgKyAgNCk7CisJcHV0X3VuYWxpZ25lZF9sZTMyKChoMiA+PiAxMikg
fCAoaDMgPDwgMTQpLCBkc3QgKyAgOCk7CisJcHV0X3VuYWxpZ25lZF9sZTMyKChoMyA+PiAxOCkg
fCAoaDQgPDwgIDgpLCBkc3QgKyAxMik7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChwb2x5MTMwNV9j
b3JlX2VtaXQpOworCit2b2lkIHBvbHkxMzA1X2luaXRfZ2VuZXJpYyhzdHJ1Y3QgcG9seTEzMDVf
ZGVzY19jdHggKmRlc2MsIGNvbnN0IHU4ICprZXkpCit7CisJcG9seTEzMDVfY29yZV9zZXRrZXko
ZGVzYy0+ciwga2V5KTsKKwlkZXNjLT5zWzBdID0gZ2V0X3VuYWxpZ25lZF9sZTMyKGtleSArIDE2
KTsKKwlkZXNjLT5zWzFdID0gZ2V0X3VuYWxpZ25lZF9sZTMyKGtleSArIDIwKTsKKwlkZXNjLT5z
WzJdID0gZ2V0X3VuYWxpZ25lZF9sZTMyKGtleSArIDI0KTsKKwlkZXNjLT5zWzNdID0gZ2V0X3Vu
YWxpZ25lZF9sZTMyKGtleSArIDI4KTsKKwlwb2x5MTMwNV9jb3JlX2luaXQoJmRlc2MtPmgpOwor
CWRlc2MtPmJ1ZmxlbiA9IDA7CisJZGVzYy0+c3NldCA9IHRydWU7CisJZGVzYy0+cnNldCA9IDE7
Cit9CitFWFBPUlRfU1lNQk9MX0dQTChwb2x5MTMwNV9pbml0X2dlbmVyaWMpOworCit2b2lkIHBv
bHkxMzA1X3VwZGF0ZV9nZW5lcmljKHN0cnVjdCBwb2x5MTMwNV9kZXNjX2N0eCAqZGVzYywgY29u
c3QgdTggKnNyYywKKwkJCSAgICAgdW5zaWduZWQgaW50IG5ieXRlcykKK3sKKwl1bnNpZ25lZCBp
bnQgYnl0ZXM7CisKKwlpZiAodW5saWtlbHkoZGVzYy0+YnVmbGVuKSkgeworCQlieXRlcyA9IG1p
bihuYnl0ZXMsIFBPTFkxMzA1X0JMT0NLX1NJWkUgLSBkZXNjLT5idWZsZW4pOworCQltZW1jcHko
ZGVzYy0+YnVmICsgZGVzYy0+YnVmbGVuLCBzcmMsIGJ5dGVzKTsKKwkJc3JjICs9IGJ5dGVzOwor
CQluYnl0ZXMgLT0gYnl0ZXM7CisJCWRlc2MtPmJ1ZmxlbiArPSBieXRlczsKKworCQlpZiAoZGVz
Yy0+YnVmbGVuID09IFBPTFkxMzA1X0JMT0NLX1NJWkUpIHsKKwkJCXBvbHkxMzA1X2NvcmVfYmxv
Y2tzKCZkZXNjLT5oLCBkZXNjLT5yLCBkZXNjLT5idWYsIDEsIDEpOworCQkJZGVzYy0+YnVmbGVu
ID0gMDsKKwkJfQorCX0KKworCWlmIChsaWtlbHkobmJ5dGVzID49IFBPTFkxMzA1X0JMT0NLX1NJ
WkUpKSB7CisJCXBvbHkxMzA1X2NvcmVfYmxvY2tzKCZkZXNjLT5oLCBkZXNjLT5yLCBzcmMsCisJ
CQkJICAgICBuYnl0ZXMgLyBQT0xZMTMwNV9CTE9DS19TSVpFLCAxKTsKKwkJc3JjICs9IG5ieXRl
cyAtIChuYnl0ZXMgJSBQT0xZMTMwNV9CTE9DS19TSVpFKTsKKwkJbmJ5dGVzICU9IFBPTFkxMzA1
X0JMT0NLX1NJWkU7CisJfQorCisJaWYgKHVubGlrZWx5KG5ieXRlcykpIHsKKwkJZGVzYy0+YnVm
bGVuID0gbmJ5dGVzOworCQltZW1jcHkoZGVzYy0+YnVmLCBzcmMsIG5ieXRlcyk7CisJfQorfQor
RVhQT1JUX1NZTUJPTF9HUEwocG9seTEzMDVfdXBkYXRlX2dlbmVyaWMpOworCit2b2lkIHBvbHkx
MzA1X2ZpbmFsX2dlbmVyaWMoc3RydWN0IHBvbHkxMzA1X2Rlc2NfY3R4ICpkZXNjLCB1OCAqZHN0
KQoreworCV9fbGUzMiBkaWdlc3RbNF07CisJdTY0IGYgPSAwOworCisJaWYgKHVubGlrZWx5KGRl
c2MtPmJ1ZmxlbikpIHsKKwkJZGVzYy0+YnVmW2Rlc2MtPmJ1ZmxlbisrXSA9IDE7CisJCW1lbXNl
dChkZXNjLT5idWYgKyBkZXNjLT5idWZsZW4sIDAsCisJCSAgICAgICBQT0xZMTMwNV9CTE9DS19T
SVpFIC0gZGVzYy0+YnVmbGVuKTsKKwkJcG9seTEzMDVfY29yZV9ibG9ja3MoJmRlc2MtPmgsIGRl
c2MtPnIsIGRlc2MtPmJ1ZiwgMSwgMCk7CisJfQorCisJcG9seTEzMDVfY29yZV9lbWl0KCZkZXNj
LT5oLCBkaWdlc3QpOworCisJLyogbWFjID0gKGggKyBzKSAlICgyXjEyOCkgKi8KKwlmID0gKGYg
Pj4gMzIpICsgbGUzMl90b19jcHUoZGlnZXN0WzBdKSArIGRlc2MtPnNbMF07CisJcHV0X3VuYWxp
Z25lZF9sZTMyKGYsIGRzdCArIDApOworCWYgPSAoZiA+PiAzMikgKyBsZTMyX3RvX2NwdShkaWdl
c3RbMV0pICsgZGVzYy0+c1sxXTsKKwlwdXRfdW5hbGlnbmVkX2xlMzIoZiwgZHN0ICsgNCk7CisJ
ZiA9IChmID4+IDMyKSArIGxlMzJfdG9fY3B1KGRpZ2VzdFsyXSkgKyBkZXNjLT5zWzJdOworCXB1
dF91bmFsaWduZWRfbGUzMihmLCBkc3QgKyA4KTsKKwlmID0gKGYgPj4gMzIpICsgbGUzMl90b19j
cHUoZGlnZXN0WzNdKSArIGRlc2MtPnNbM107CisJcHV0X3VuYWxpZ25lZF9sZTMyKGYsIGRzdCAr
IDEyKTsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKHBvbHkxMzA1X2ZpbmFsX2dlbmVyaWMpOworCitN
T0RVTEVfTElDRU5TRSgiR1BMIik7CitNT0RVTEVfQVVUSE9SKCJNYXJ0aW4gV2lsbGkgPG1hcnRp
bkBzdHJvbmdzd2FuLm9yZz4iKTsKKworI2lmbmRlZiBDT05GSUdfQ1JZUFRPX0FSQ0hfSEFWRV9M
SUJfUE9MWTEzMDUKKworZXh0ZXJuIHZvaWQgcG9seTEzMDVfaW5pdChzdHJ1Y3QgcG9seTEzMDVf
ZGVzY19jdHggKmRlc2MsIGNvbnN0IHU4ICprZXkpCisJX19hbGlhcyhwb2x5MTMwNV9pbml0X2dl
bmVyaWMpOworRVhQT1JUX1NZTUJPTF9HUEwocG9seTEzMDVfaW5pdCk7CisKK2V4dGVybiB2b2lk
IHBvbHkxMzA1X3VwZGF0ZShzdHJ1Y3QgcG9seTEzMDVfZGVzY19jdHggKmRlc2MsIGNvbnN0IHU4
ICpzcmMsCisJCQkgICAgdW5zaWduZWQgaW50IG5ieXRlcykKKwlfX2FsaWFzKHBvbHkxMzA1X3Vw
ZGF0ZV9nZW5lcmljKTsKK0VYUE9SVF9TWU1CT0xfR1BMKHBvbHkxMzA1X3VwZGF0ZSk7CisKK2V4
dGVybiB2b2lkIHBvbHkxMzA1X2ZpbmFsKHN0cnVjdCBwb2x5MTMwNV9kZXNjX2N0eCAqZGVzYywg
dTggKmRzdCkKKwlfX2FsaWFzKHBvbHkxMzA1X2ZpbmFsX2dlbmVyaWMpOworRVhQT1JUX1NZTUJP
TF9HUEwocG9seTEzMDVfZmluYWwpOworCisjZW5kaWYKLS0gCjIuMTcuMQoKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmxpbnV4LWFybS1rZXJuZWwgbWFp
bGluZyBsaXN0CmxpbnV4LWFybS1rZXJuZWxAbGlzdHMuaW5mcmFkZWFkLm9yZwpodHRwOi8vbGlz
dHMuaW5mcmFkZWFkLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbnV4LWFybS1rZXJuZWwK
