Return-Path: <linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-arm-kernel@lfdr.de
Delivered-To: lists+linux-arm-kernel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 11B8711C452
	for <lists+linux-arm-kernel@lfdr.de>; Thu, 12 Dec 2019 04:46:43 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:References:In-Reply-To:
	Message-Id:Date:Subject:To:From:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=gH3MwkSuih0bnE/8T4oEKdfP0ye5RMQstC0TY38zZ8s=; b=eZpDobkGUseu9k
	ZidhxgyYd/dSj+L7JGV3rg2gPp9gYb/3qkcr2l/1fVOk77V2dwkUy3txjJEf7SKc2GhAiBBTdJ0YS
	BLr8OxZCpf79hHEbQbb4gkbOj4edJmvDD499Ldsu0bwNFw+W65dLPqjengvgWvEe6hoT3wZy/Cv47
	0fo8w+Qx4dVVdXMbY0J9JS37cAnEfKnfLik77q9licUIWJ9YfPmKw1UF7fNOjqqUTyoo1Bp/dglzD
	sZnRcKosxfmVXY8pbXbS4xsFXg5MWyEXgBSjahDWCa5npojIz0DdgmkUTDGF4gNwUyGH+el4AeDUH
	ih5zWYdYDK89RC5PE3ug==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1ifFR0-0000SB-98; Thu, 12 Dec 2019 03:46:38 +0000
Received: from mx2.suse.de ([195.135.220.15] helo=mx1.suse.de)
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1ifFKj-0000r6-Kx; Thu, 12 Dec 2019 03:40:18 +0000
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id E4A2AADA8;
 Thu, 12 Dec 2019 03:40:05 +0000 (UTC)
From: =?UTF-8?q?Andreas=20F=C3=A4rber?= <afaerber@suse.de>
To: linux-realtek-soc@lists.infradead.org,
	linux-leds@vger.kernel.org
Subject: [RFC 19/25] leds: tm1628: Add 7-segment display support
Date: Thu, 12 Dec 2019 04:39:46 +0100
Message-Id: <20191212033952.5967-20-afaerber@suse.de>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20191212033952.5967-1-afaerber@suse.de>
References: <20191212033952.5967-1-afaerber@suse.de>
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20191211_194010_073944_914E57B3 
X-CRM114-Status: GOOD (  14.47  )
X-Spam-Score: -2.3 (--)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-2.3 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -2.3 RCVD_IN_DNSWL_MED      RBL: Sender listed at https://www.dnswl.org/,
 medium trust [195.135.220.15 listed in list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
X-BeenThere: linux-arm-kernel@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-arm-kernel.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-arm-kernel/>
List-Post: <mailto:linux-arm-kernel@lists.infradead.org>
List-Help: <mailto:linux-arm-kernel-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=subscribe>
Cc: linux-kernel@vger.kernel.org, Jacek Anaszewski <jacek.anaszewski@gmail.com>,
 Pavel Machek <pavel@ucw.cz>,
 =?UTF-8?q?Andreas=20F=C3=A4rber?= <afaerber@suse.de>,
 linux-arm-kernel@lists.infradead.org, Dan Murphy <dmurphy@ti.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-arm-kernel" <linux-arm-kernel-bounces@lists.infradead.org>
Errors-To: linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org

RGV0ZWN0IERUIGNoaWxkIG5vZGVzIGNvdmVyaW5nIG1vcmUgdGhhbiBvbmUgTEVEIGNvbXBvbmVu
dCBhbmQgaW1wbGVtZW50CmEgdGV4dCB0byA3LXNlZ21lbnQgZGlzcGxheSBtYXBwaW5nLgoKU2ln
bmVkLW9mZi1ieTogQW5kcmVhcyBGw6RyYmVyIDxhZmFlcmJlckBzdXNlLmRlPgotLS0KIGRyaXZl
cnMvbGVkcy9sZWRzLXRtMTYyOC5jIHwgMjMwICsrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrLQogMSBmaWxlIGNoYW5nZWQsIDIyOSBpbnNlcnRpb25zKCspLCAxIGRl
bGV0aW9uKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9sZWRzL2xlZHMtdG0xNjI4LmMgYi9kcml2
ZXJzL2xlZHMvbGVkcy10bTE2MjguYwppbmRleCA4YThmZDE1NjI4NTMuLmUyYzJhNWQ5MTU5NiAx
MDA2NDQKLS0tIGEvZHJpdmVycy9sZWRzL2xlZHMtdG0xNjI4LmMKKysrIGIvZHJpdmVycy9sZWRz
L2xlZHMtdG0xNjI4LmMKQEAgLTQ3LDYgKzQ3LDE1IEBAIHN0cnVjdCB0bTE2MjhfaW5mbyB7CiAJ
aW50CQkJCWRlZmF1bHRfcHdtOwogfTsKIAorc3RydWN0IHRtMTYyOF9zZWdtZW50IHsKKwl1MzIg
Z3JpZDsKKwl1MzIgc2VnOworfTsKKworc3RydWN0IHRtMTYyOF9kaXNwbGF5IHsKKwlzdHJ1Y3Qg
dG0xNjI4X3NlZ21lbnQgc2VnbWVudHNbOF07Cit9OworCiBzdHJ1Y3QgdG0xNjI4X2xlZCB7CiAJ
c3RydWN0IGxlZF9jbGFzc2RldglsZWRkZXY7CiAJc3RydWN0IHRtMTYyOAkJKmN0cmw7CkBAIC02
Miw2ICs3MSw4IEBAIHN0cnVjdCB0bTE2MjggewogCWludAkJCQltb2RlX2luZGV4OwogCWludAkJ
CQlwd21faW5kZXg7CiAJdTgJCQkJZGF0YVsxNF07CisJdW5zaWduZWQgaW50CQkJbnVtX2Rpc3Bs
YXlzOworCXN0cnVjdCB0bTE2MjhfZGlzcGxheQkJKmRpc3BsYXlzOwogCXVuc2lnbmVkIGludAkJ
CW51bV9sZWRzOwogCXN0cnVjdCB0bTE2MjhfbGVkCQlsZWRzW107CiB9OwpAQCAtMjUzLDYgKzI2
NCwyMTUgQEAgc3RhdGljIGludCB0bTE2MjhfcmVnaXN0ZXJfbGVkKHN0cnVjdCB0bTE2MjggKnMs
CiAJcmV0dXJuIGRldm1fbGVkX2NsYXNzZGV2X3JlZ2lzdGVyX2V4dChkZXYsICZsZWQtPmxlZGRl
diwgJmluaXRfZGF0YSk7CiB9CiAKKyNkZWZpbmUgU1NEX1RPUAkJCUJJVCgwKQorI2RlZmluZSBT
U0RfVE9QX1JJR0hUCQlCSVQoMSkKKyNkZWZpbmUgU1NEX0JPVFRPTV9SSUdIVAlCSVQoMikKKyNk
ZWZpbmUgU1NEX0JPVFRPTQkJQklUKDMpCisjZGVmaW5lIFNTRF9CT1RUT01fTEVGVAkJQklUKDQp
CisjZGVmaW5lIFNTRF9UT1BfTEVGVAkJQklUKDUpCisjZGVmaW5lIFNTRF9NSURETEUJCUJJVCg2
KQorI2RlZmluZSBTU0RfRE9UCQkJQklUKDcpCisKK3N0cnVjdCB0bTE2Mjhfc3NkX2NoYXIgewor
CWNoYXIgY2g7CisJdTggc2VnczsKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdG0xNjI4X3Nz
ZF9jaGFyIHRtMTYyOF9jaGFyX3NzZF9tYXBbXSA9IHsKKwl7ICcwJywgU1NEX1RPUCB8IFNTRF9U
T1BfTEVGVCB8IFNTRF9UT1BfUklHSFQgfAorCSAgICAgICBTU0RfQk9UVE9NX0xFRlQgfCBTU0Rf
Qk9UVE9NX1JJR0hUIHwgU1NEX0JPVFRPTSB9LAorCXsgJzEnLCBTU0RfVE9QX1JJR0hUIHwgU1NE
X0JPVFRPTV9SSUdIVCB9LAorCXsgJzInLCBTU0RfVE9QIHwgU1NEX1RPUF9SSUdIVCB8IFNTRF9N
SURETEUgfCBTU0RfQk9UVE9NX0xFRlQgfCBTU0RfQk9UVE9NIH0sCisJeyAnMycsIFNTRF9UT1Ag
fCBTU0RfVE9QX1JJR0hUIHwgU1NEX01JRERMRSB8IFNTRF9CT1RUT01fUklHSFQgfCBTU0RfQk9U
VE9NIH0sCisJeyAnNCcsIFNTRF9UT1BfTEVGVCB8IFNTRF9UT1BfUklHSFQgfCBTU0RfTUlERExF
IHwgU1NEX0JPVFRPTV9SSUdIVCB9LAorCXsgJzUnLCBTU0RfVE9QIHwgU1NEX1RPUF9MRUZUIHwg
U1NEX01JRERMRSB8IFNTRF9CT1RUT01fUklHSFQgfCBTU0RfQk9UVE9NIH0sCisJeyAnNicsIFNT
RF9UT1AgfCBTU0RfVE9QX0xFRlQgfCBTU0RfTUlERExFIHwgU1NEX0JPVFRPTV9MRUZUIHwgU1NE
X0JPVFRPTV9SSUdIVCB8IFNTRF9CT1RUT00gfSwKKwl7ICc3JywgU1NEX1RPUCB8IFNTRF9UT1Bf
UklHSFQgfCBTU0RfQk9UVE9NX1JJR0hUIH0sCisJeyAnOCcsIFNTRF9UT1AgfCBTU0RfVE9QX0xF
RlQgfCBTU0RfVE9QX1JJR0hUIHwgU1NEX01JRERMRSB8CisJICAgICAgIFNTRF9CT1RUT01fTEVG
VCB8IFNTRF9CT1RUT01fUklHSFQgfCBTU0RfQk9UVE9NIH0sCisJeyAnOScsIFNTRF9UT1AgfCBT
U0RfVE9QX0xFRlQgfCBTU0RfVE9QX1JJR0hUIHwgU1NEX01JRERMRSB8CisJICAgICAgIFNTRF9C
T1RUT01fUklHSFQgfCBTU0RfQk9UVE9NIH0sCisJeyAnQScsIFNTRF9UT1AgfCBTU0RfVE9QX0xF
RlQgfCBTU0RfVE9QX1JJR0hUIHwgU1NEX01JRERMRSB8CisJICAgICAgIFNTRF9CT1RUT01fTEVG
VCB8IFNTRF9CT1RUT01fUklHSFQgfSwKKwl7ICdCJywgU1NEX1RPUCB8IFNTRF9UT1BfTEVGVCB8
IFNTRF9UT1BfUklHSFQgfCBTU0RfTUlERExFIHwKKwkgICAgICAgU1NEX0JPVFRPTV9MRUZUIHwg
U1NEX0JPVFRPTV9SSUdIVCB8IFNTRF9CT1RUT00gfSwKKwl7ICdDJywgU1NEX1RPUCB8IFNTRF9U
T1BfTEVGVCB8IFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT00gfSwKKwl7ICdEJywgU1NEX1RP
UCB8IFNTRF9UT1BfTEVGVCB8IFNTRF9UT1BfUklHSFQgfAorCSAgICAgICBTU0RfQk9UVE9NX0xF
RlQgfCBTU0RfQk9UVE9NX1JJR0hUIHwgU1NEX0JPVFRPTSB9LAorCXsgJ0UnLCBTU0RfVE9QIHwg
U1NEX1RPUF9MRUZUIHwgU1NEX01JRERMRSB8IFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT00g
fSwKKwl7ICdGJywgU1NEX1RPUCB8IFNTRF9UT1BfTEVGVCB8IFNTRF9NSURETEUgfCBTU0RfQk9U
VE9NX0xFRlQgfSwKKwl7ICdHJywgU1NEX1RPUCB8IFNTRF9UT1BfTEVGVCB8IFNTRF9CT1RUT01f
TEVGVCB8IFNTRF9CT1RUT00gfCBTU0RfQk9UVE9NX1JJR0hUIH0sCisJeyAnSCcsIFNTRF9UT1Bf
TEVGVCB8IFNTRF9UT1BfUklHSFQgfCBTU0RfTUlERExFIHwKKwkgICAgICAgU1NEX0JPVFRPTV9M
RUZUIHwgU1NEX0JPVFRPTV9SSUdIVCB9LAorCXsgJ0knLCBTU0RfVE9QX0xFRlQgfCBTU0RfQk9U
VE9NX0xFRlQgfSwKKwl7ICdKJywgU1NEX1RPUCB8IFNTRF9UT1BfUklHSFQgfCBTU0RfQk9UVE9N
X1JJR0hUIHwgU1NEX0JPVFRPTSB9LAorCXsgJ0snLCBTU0RfVE9QX0xFRlQgfCBTU0RfVE9QX1JJ
R0hUIHwgU1NEX01JRERMRSB8CisJICAgICAgIFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT01f
UklHSFQgfSwKKwl7ICdMJywgU1NEX1RPUF9MRUZUIHwgU1NEX0JPVFRPTV9MRUZUIHwgU1NEX0JP
VFRPTSB9LAorCXsgJ08nLCBTU0RfVE9QIHwgU1NEX1RPUF9MRUZUIHwgU1NEX1RPUF9SSUdIVCB8
CisJICAgICAgIFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT01fUklHSFQgfCBTU0RfQk9UVE9N
IH0sCisJeyAnUCcsIFNTRF9UT1AgfCBTU0RfVE9QX0xFRlQgfCBTU0RfVE9QX1JJR0hUIHwgU1NE
X01JRERMRSB8CisJICAgICAgIFNTRF9CT1RUT01fTEVGVCB9LAorCXsgJ1EnLCBTU0RfVE9QIHwg
U1NEX1RPUF9MRUZUIHwgU1NEX1RPUF9SSUdIVCB8CisJICAgICAgIFNTRF9CT1RUT01fTEVGVCB8
IFNTRF9CT1RUT01fUklHSFQgfCBTU0RfQk9UVE9NIH0sCisJeyAnUicsIFNTRF9UT1AgfCBTU0Rf
VE9QX0xFRlQgfCBTU0RfVE9QX1JJR0hUIHwgU1NEX01JRERMRSB8CisJICAgICAgIFNTRF9CT1RU
T01fTEVGVCB8IFNTRF9CT1RUT01fUklHSFQgfSwKKwl7ICdTJywgU1NEX1RPUCB8IFNTRF9UT1Bf
TEVGVCB8IFNTRF9NSURETEUgfCBTU0RfQk9UVE9NX1JJR0hUIHwgU1NEX0JPVFRPTSB9LAorCXsg
J1QnLCBTU0RfVE9QIHwgU1NEX1RPUF9MRUZUIHwgU1NEX0JPVFRPTV9MRUZUIH0sCisJeyAnVScs
IFNTRF9UT1BfTEVGVCB8IFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT00gfCBTU0RfQk9UVE9N
X1JJR0hUIHwgU1NEX1RPUF9SSUdIVCB9LAorCXsgJ1YnLCBTU0RfVE9QX0xFRlQgfCBTU0RfQk9U
VE9NX0xFRlQgfCBTU0RfQk9UVE9NIHwgU1NEX0JPVFRPTV9SSUdIVCB8IFNTRF9UT1BfUklHSFQg
fSwKKwl7ICdXJywgU1NEX1RPUF9MRUZUIHwgU1NEX0JPVFRPTV9MRUZUIHwgU1NEX0JPVFRPTSB8
IFNTRF9CT1RUT01fUklHSFQgfCBTU0RfVE9QX1JJR0hUIH0sCisJeyAnWicsIFNTRF9UT1AgfCBT
U0RfVE9QX1JJR0hUIHwgU1NEX01JRERMRSB8IFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT00g
fSwKKwl7ICdiJywgU1NEX1RPUF9MRUZUIHwgU1NEX01JRERMRSB8IFNTRF9CT1RUT01fTEVGVCB8
IFNTRF9CT1RUT00gfCBTU0RfQk9UVE9NX1JJR0hUIH0sCisJeyAnbCcsIFNTRF9UT1BfTEVGVCB8
IFNTRF9CT1RUT01fTEVGVCB9LAorCXsgJ28nLCBTU0RfTUlERExFIHwgU1NEX0JPVFRPTV9MRUZU
IHwgU1NEX0JPVFRPTSB8IFNTRF9CT1RUT01fUklHSFQgfSwKKwl7ICd0JywgU1NEX1RPUF9MRUZU
IHwgU1NEX01JRERMRSB8IFNTRF9CT1RUT01fTEVGVCB8IFNTRF9CT1RUT00gfSwKKwl7ICd1Jywg
U1NEX0JPVFRPTV9MRUZUIHwgU1NEX0JPVFRPTSB8IFNTRF9CT1RUT01fUklHSFQgfSwKKwl7ICd2
JywgU1NEX0JPVFRPTV9MRUZUIHwgU1NEX0JPVFRPTSB8IFNTRF9CT1RUT01fUklHSFQgfSwKKwl7
ICd3JywgU1NEX0JPVFRPTV9MRUZUIHwgU1NEX0JPVFRPTSB8IFNTRF9CT1RUT01fUklHSFQgfSwK
Kwl7ICctJywgU1NEX01JRERMRSB9LAorCXsgJ18nLCBTU0RfQk9UVE9NIH0sCisJeyAnLicsIFNT
RF9ET1QgfSwKK307CisKK3N0YXRpYyB1OCB0bTE2MjhfZ2V0X2NoYXJfc3NkX21hcChjaGFyIGNo
KQoreworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUodG0xNjI4X2NoYXJf
c3NkX21hcCk7IGkrKykgeworCQlpZiAodG0xNjI4X2NoYXJfc3NkX21hcFtpXS5jaCA9PSBjaCkK
KwkJCXJldHVybiB0bTE2MjhfY2hhcl9zc2RfbWFwW2ldLnNlZ3M7CisJfQorCisJcmV0dXJuIDB4
MDsKK30KKworc3RhdGljIGludCB0bTE2MjhfZGlzcGxheV9hcHBseV9tYXAoc3RydWN0IHRtMTYy
OCAqcywKKwlzdHJ1Y3QgdG0xNjI4X2Rpc3BsYXkgKmRpc3BsYXksIHU4IG1hcCkKK3sKKwlzdHJ1
Y3QgdG0xNjI4X3NlZ21lbnQgKnNlZ21lbnQ7CisJaW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwg
ODsgaSsrKSB7CisJCXNlZ21lbnQgPSAmZGlzcGxheS0+c2VnbWVudHNbaV07CisJCXRtMTYyOF9z
ZXRfbGVkKHMsIHNlZ21lbnQtPmdyaWQsIHNlZ21lbnQtPnNlZywgbWFwICYgQklUKGkpKTsKKwl9
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHNzaXplX3QgdGV4dF9zdG9yZShzdHJ1Y3QgZGV2
aWNlICpkZXYsCisJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNvbnN0IGNoYXIgKmJ1
Ziwgc2l6ZV90IGNvdW50KQoreworCXN0cnVjdCB0bTE2MjggKnMgPSBkZXZfZ2V0X2RydmRhdGEo
ZGV2KTsKKwlzaXplX3Qgb2Zmc2V0LCBsZW4gPSBjb3VudDsKKwl1OCBtYXA7CisJaW50IGksIHJl
dDsKKworCWlmIChsZW4gPiAwICYmIGJ1ZltsZW4gLSAxXSA9PSAnXG4nKQorCQlsZW4tLTsKKwor
CWZvciAoaSA9IDAsIG9mZnNldCA9IDA7IGkgPCBzLT5udW1fZGlzcGxheXM7IGkrKykgeworCQlp
ZiAob2Zmc2V0IDwgbGVuKSB7CisJCQltYXAgPSB0bTE2MjhfZ2V0X2NoYXJfc3NkX21hcChidWZb
b2Zmc2V0XSk7CisJCQlvZmZzZXQrKzsKKwkJfSBlbHNlCisJCQltYXAgPSAweDA7CisKKwkJdG0x
NjI4X2Rpc3BsYXlfYXBwbHlfbWFwKHMsICZzLT5kaXNwbGF5c1tpXSwgbWFwKTsKKwl9CisKKwly
ZXQgPSB0bTE2Mjhfc2V0X2FkZHJlc3Mocy0+c3BpLCAweDApOworCWlmIChyZXQpCisJCXJldHVy
biByZXQ7CisKKwlyZXQgPSB0bTE2Mjhfd3JpdGVfZGF0YShzLT5zcGksIHMtPmRhdGEsIDE0KTsK
KwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJcmV0dXJuIGNvdW50OworfQorCitzdGF0aWMg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgdG0xNjI4X2F0dHIgPQorCV9fQVRUUl9XTyh0ZXh0KTsK
Kworc3RhdGljIGludCB0bTE2MjhfcmVnaXN0ZXJfZGlzcGxheShzdHJ1Y3QgdG0xNjI4ICpzLAor
CXN0cnVjdCBmd25vZGVfaGFuZGxlICpub2RlKQoreworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZz
LT5zcGktPmRldjsKKwlzdHJ1Y3QgdG0xNjI4X2Rpc3BsYXkgKmRpc3BsYXk7CisJdTMyICpyZWc7
CisJdTMyIGdyaWQsIHNlZzsKKwlpbnQgaSwgaiwgcmV0LCByZWdfY291bnQ7CisKKwlyZWdfY291
bnQgPSBmd25vZGVfcHJvcGVydHlfY291bnRfdTMyKG5vZGUsICJyZWciKTsKKwlpZiAocmVnX2Nv
dW50IDwgMCkKKwkJcmV0dXJuIHJlZ19jb3VudDsKKworCWlmIChyZWdfY291bnQgJSAyKSB7CisJ
CWRldl93YXJuKGRldiwgIklnbm9yaW5nIGV4dHJhIGNlbGwgaW4gJXMgcmVnIHByb3BlcnR5XG4i
LAorCQkJIGZ3bm9kZV9nZXRfbmFtZShub2RlKSk7CisJCXJlZ19jb3VudC0tOworCX0KKworCWlm
IChzLT5kaXNwbGF5cykgeworCQlkZXZfd2FybihkZXYsICJPbmx5IG9uZSBkaXNwbGF5IHN1cHBv
cnRlZFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXMtPm51bV9kaXNwbGF5cyA9IHJl
Z19jb3VudCA+PiAxOworCisJcmVnID0gZGV2bV9remFsbG9jKGRldiwgcmVnX2NvdW50ICogc2l6
ZW9mKCpyZWcpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXJlZykKKwkJcmV0dXJuIC1FTk9NRU07CisK
KwlyZXQgPSBmd25vZGVfcHJvcGVydHlfcmVhZF91MzJfYXJyYXkobm9kZSwgInJlZyIsIHJlZywg
cmVnX2NvdW50KTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiUmVhZGluZyAlcyByZWcg
cHJvcGVydHkgZmFpbGVkICglZClcbiIsCisJCQlmd25vZGVfZ2V0X25hbWUobm9kZSksIHJldCk7
CisJCXJldHVybiByZXQ7CisJfQorCisJcy0+ZGlzcGxheXMgPSBkZXZtX2t6YWxsb2MoZGV2LCBz
LT5udW1fZGlzcGxheXMgKiBzaXplb2YoKnMtPmRpc3BsYXlzKSwgR0ZQX0tFUk5FTCk7CisJaWYg
KCFzLT5kaXNwbGF5cykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlmb3IgKGkgPSAwOyBpIDwgcy0+
bnVtX2Rpc3BsYXlzOyBpKyspIHsKKwkJZGlzcGxheSA9ICZzLT5kaXNwbGF5c1tpXTsKKwkJZ3Jp
ZCA9IHJlZ1tpICogMl07CisJCXNlZyAgPSByZWdbaSAqIDIgKyAxXTsKKwkJaWYgKGdyaWQgPT0g
MCAmJiBzZWcgIT0gMCkgeworCQkJaWYgKCF0bTE2MjhfaXNfdmFsaWRfc2VnKHMsIHNlZykpIHsK
KwkJCQlkZXZfd2FybihkZXYsICIlcyByZWcgb3V0IG9mIHJhbmdlXG4iLCBmd25vZGVfZ2V0X25h
bWUobm9kZSkpOworCQkJCXJldHVybiAtRUlOVkFMOworCQkJfQorCQkJZ3JpZCA9IHMtPmluZm8t
Pm1vZGVzW3MtPm1vZGVfaW5kZXhdLmdyaWRfbWFzazsKKwkJCWZvciAoaiA9IDA7IGdyaWQgJiYg
aiA8IDc7IGorKykgeworCQkJCWRpc3BsYXktPnNlZ21lbnRzW2pdLnNlZyA9IHNlZzsKKwkJCQlk
aXNwbGF5LT5zZWdtZW50c1tqXS5ncmlkID0gX19mZnMoZ3JpZCk7CisJCQkJZ3JpZCAmPSB+QklU
KGRpc3BsYXktPnNlZ21lbnRzW2pdLmdyaWQpOworCQkJfQorCQl9IGVsc2UgaWYgKGdyaWQgIT0g
MCAmJiBzZWcgPT0gMCkgeworCQkJaWYgKCF0bTE2MjhfaXNfdmFsaWRfZ3JpZChzLCBncmlkKSkg
eworCQkJCWRldl93YXJuKGRldiwgIiVzIHJlZyBvdXQgb2YgcmFuZ2VcbiIsIGZ3bm9kZV9nZXRf
bmFtZShub2RlKSk7CisJCQkJcmV0dXJuIC1FSU5WQUw7CisJCQl9CisJCQlzZWcgPSBzLT5pbmZv
LT5tb2Rlc1tzLT5tb2RlX2luZGV4XS5zZWdfbWFzazsKKwkJCWZvciAoaiA9IDA7IHNlZyAmJiBq
IDwgODsgaisrKSB7CisJCQkJZGlzcGxheS0+c2VnbWVudHNbal0uZ3JpZCA9IGdyaWQ7CisJCQkJ
ZGlzcGxheS0+c2VnbWVudHNbal0uc2VnID0gX19mZnMoc2VnKTsKKwkJCQlzZWcgJj0gfkJJVChk
aXNwbGF5LT5zZWdtZW50c1tqXS5zZWcpOworCQkJfQorCQl9CisJfQorCisJZGV2bV9rZnJlZShk
ZXYsIHJlZyk7CisKKwlkZXZpY2VfY3JlYXRlX2ZpbGUoZGV2LCAmdG0xNjI4X2F0dHIpOworCisJ
cmV0dXJuIDA7Cit9CisKIC8qIFdvcmsgYXJvdW5kIF9fYnVpbHRpbl9wb3Bjb3VudCgpICovCiBz
dGF0aWMgdTMyIHRtMTYyOF9ncmlkX3BvcGNvdW50KHU4IGdyaWRfbWFzaykKIHsKQEAgLTMyNSw3
ICs1NDUsNyBAQCBzdGF0aWMgaW50IHRtMTYyOF9zcGlfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2Ug
KnNwaSkKIAkJCXJldHVybiByZXQ7CiAJCX0KIAotCQlpZiAoZndub2RlX3Byb3BlcnR5X2NvdW50
X3UzMihjaGlsZCwgInJlZyIpID09IDIpIHsKKwkJaWYgKHJlZ1swXSAhPSAwICYmIHJlZ1sxXSAh
PSAwICYmIGZ3bm9kZV9wcm9wZXJ0eV9jb3VudF91MzIoY2hpbGQsICJyZWciKSA9PSAyKSB7CiAJ
CQlyZXQgPSB0bTE2MjhfcmVnaXN0ZXJfbGVkKHMsIGNoaWxkLCByZWdbMF0sIHJlZ1sxXSwgJnMt
PmxlZHNbaSsrXSk7CiAJCQlpZiAocmV0ICYmIHJldCAhPSAtRUlOVkFMKSB7CiAJCQkJZGV2X2Vy
cigmc3BpLT5kZXYsICJGYWlsZWQgdG8gcmVnaXN0ZXIgTEVEICVzICglZClcbiIsCkBAIC0zMzQs
NiArNTU0LDE0IEBAIHN0YXRpYyBpbnQgdG0xNjI4X3NwaV9wcm9iZShzdHJ1Y3Qgc3BpX2Rldmlj
ZSAqc3BpKQogCQkJCXJldHVybiByZXQ7CiAJCQl9CiAJCQlzLT5udW1fbGVkcysrOworCQl9IGVs
c2UgeworCQkJcmV0ID0gdG0xNjI4X3JlZ2lzdGVyX2Rpc3BsYXkocywgY2hpbGQpOworCQkJaWYg
KHJldCkgeworCQkJCWRldl9lcnIoJnNwaS0+ZGV2LCAiRmFpbGVkIHRvIHJlZ2lzdGVyIGRpc3Bs
YXkgJXMgKCVkKVxuIiwKKwkJCQkJZndub2RlX2dldF9uYW1lKGNoaWxkKSwgcmV0KTsKKwkJCQlm
d25vZGVfaGFuZGxlX3B1dChjaGlsZCk7CisJCQkJcmV0dXJuIHJldDsKKwkJCX0KIAkJfQogCX0K
IAotLSAKMi4xNi40CgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KbGludXgtYXJtLWtlcm5lbCBtYWlsaW5nIGxpc3QKbGludXgtYXJtLWtlcm5lbEBsaXN0
cy5pbmZyYWRlYWQub3JnCmh0dHA6Ly9saXN0cy5pbmZyYWRlYWQub3JnL21haWxtYW4vbGlzdGlu
Zm8vbGludXgtYXJtLWtlcm5lbAo=
