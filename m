Return-Path: <linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-arm-kernel@lfdr.de
Delivered-To: lists+linux-arm-kernel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 4118D1A5D50
	for <lists+linux-arm-kernel@lfdr.de>; Sun, 12 Apr 2020 09:44:02 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:References:MIME-Version:In-Reply-To:
	Message-Id:Date:Subject:To:From:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=wDPDhMcZuVYm2Gl1yJS960WmDIuS4Y53qVJ6SrzSK/I=; b=CbZJp3Wa/BJq1C
	4v0tq717RIfPoh2LHTte5tFvUT5eu9W9OkdX67mU0rsVDeC+oKmkHqAKax8t551QAn5cRjBcEe92h
	Y/iFQCGZAn5R8p62MyV/knK/6rJmtVSw7j0esgFj8mouKAOk8wi1aJSeqw9ZlsMlvjRxlN22uHEB4
	5a6c65kNNV3QRmnUR9tgRKs4kDzWc4aq1dYMB9I/jV6FUY3CDni0TEKbbcoMZ9umLLN4mvaR4H4Uc
	HQlS4eoH0ZfCSzOQlWMsHcMqxcO2hcCjbNevyGFbov7prEMDBpBEt6Q3roBIy8Fy13zItNkEkJjDq
	6x0ThFbWvMU4LYCqrPfw==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1jNXHR-0004LF-8o; Sun, 12 Apr 2020 07:43:49 +0000
Received: from mailout4.samsung.com ([203.254.224.34])
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1jNXG4-0003LV-IT
 for linux-arm-kernel@lists.infradead.org; Sun, 12 Apr 2020 07:42:35 +0000
Received: from epcas5p1.samsung.com (unknown [182.195.41.39])
 by mailout4.samsung.com (KnoxPortal) with ESMTP id
 20200412074220epoutp045b59fc3d3ee727d4a16ec511d9679a66~FAqJmpssN2821328213epoutp041
 for <linux-arm-kernel@lists.infradead.org>;
 Sun, 12 Apr 2020 07:42:20 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout4.samsung.com
 20200412074220epoutp045b59fc3d3ee727d4a16ec511d9679a66~FAqJmpssN2821328213epoutp041
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=samsung.com;
 s=mail20170921; t=1586677340;
 bh=RX+5NsFtK966aqVfRHRrTZr6RtTj2F2fKKUpFMXctEU=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=SYoiukWRvLcHZFlSfAJFUIHj5h4vqimxIjSzJ0Fs8GscpELwuERLok8WLN8wDYJ44
 DtKNFroJtPSeOzxj6HCJH3akfbXHV+ee1HdoSMnX+YQxBP6nVoq6oZgYReeJv30roV
 RA0RN3HGIevhoQa1CfNkXhw8FRlT3jTIUkJnY5jA=
Received: from epsmges5p3new.samsung.com (unknown [182.195.42.75]) by
 epcas5p1.samsung.com (KnoxPortal) with ESMTP id
 20200412074219epcas5p1ba2bcf34ef3ac6fb56b95524fe1b40ac~FAqIgrj3t1951719517epcas5p1w;
 Sun, 12 Apr 2020 07:42:19 +0000 (GMT)
Received: from epcas5p1.samsung.com ( [182.195.41.39]) by
 epsmges5p3new.samsung.com (Symantec Messaging Gateway) with SMTP id
 4C.91.04736.A56C29E5; Sun, 12 Apr 2020 16:42:19 +0900 (KST)
Received: from epsmtrp1.samsung.com (unknown [182.195.40.13]) by
 epcas5p3.samsung.com (KnoxPortal) with ESMTPA id
 20200412074218epcas5p3ef7973c8a47533a15a359b069da8003c~FAqHl_agV1077210772epcas5p3E;
 Sun, 12 Apr 2020 07:42:18 +0000 (GMT)
Received: from epsmgms1p2new.samsung.com (unknown [182.195.42.42]) by
 epsmtrp1.samsung.com (KnoxPortal) with ESMTP id
 20200412074218epsmtrp13b397d391f48ba910ea16826f89d2f93~FAqHlMCpZ1966119661epsmtrp13;
 Sun, 12 Apr 2020 07:42:18 +0000 (GMT)
X-AuditID: b6c32a4b-ae3ff70000001280-b8-5e92c65a4398
Received: from epsmtip1.samsung.com ( [182.195.34.30]) by
 epsmgms1p2new.samsung.com (Symantec Messaging Gateway) with SMTP id
 52.2D.04158.956C29E5; Sun, 12 Apr 2020 16:42:17 +0900 (KST)
Received: from Jaguar.sa.corp.samsungelectronics.net (unknown
 [107.108.73.139]) by epsmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200412074215epsmtip1b56ad607e73ff154ab73af807d803e9d~FAqFPciGr3128231282epsmtip1t;
 Sun, 12 Apr 2020 07:42:15 +0000 (GMT)
From: Alim Akhtar <alim.akhtar@samsung.com>
To: robh@kernel.org, devicetree@vger.kernel.org, linux-scsi@vger.kernel.org
Subject: [PATCH v5 4/5] scsi: ufs-exynos: add UFS host support for Exynos SoCs
Date: Sun, 12 Apr 2020 13:01:58 +0530
Message-Id: <20200412073159.37747-5-alim.akhtar@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200412073159.37747-1-alim.akhtar@samsung.com>
MIME-Version: 1.0
X-Brightmail-Tracker: H4sIAAAAAAAAA02Se0hTYRjG+c5tZ+b0OI0+FRIWEipqodKpLK2kDihUUAgl1tCDjrm5dtRU
 hJR0lVPTYaRzaJQmTVFZKt4dq4xJOcGmaRldDCoqUfHWRZs7Sv73e9/neXh4Pz4SFQ/jPqRM
 mcGqldI0CeGCdT4J2Bt8cUiXuG/oLP2+tpOgv67aCXq+9SFO1z0dwenG0XqEttnaBPRk+zOM
 Nn0ax+mxHgNBV9kGEFo70UXQjc/XEHq9r0tAN3RMgmg3ZqysFGG69dMCxmS8RTCP668xhdZB
 jJn7PIUxZe1GwCyYdjM3zFrkjPCCS2QymybLYtWhRy+7pGqqY1UlOjT7ly03H0zbkGIgJCEV
 Dpt/TGDFwIUUU70ArrRoCX6YB/DOk0coPywBWPDNSmxF3kzP4bzQD2Bltw3wQyECDV8+YBsu
 ggqC03fbnSVeVCycNducCZSyILDudRXYEDypM7D+t9YZwCh/OGP4jm6wiIqEvbU1KF/nB5va
 zE4WUkfgvbfFCO/xgNbqGWcWdXiud2z57wvgasUOnmPgYpF9c+8Jvz1vF/DsA7/e1jiYdLAc
 lvSE8es82FA7hPEcBc2vDNiGBaUCYGtPKN/kBkt/zyB8UgRvasS82x9e/2nfTPrCCq0W55mB
 g18+bj5vOYBLHZV4OfDTbztAv+0A/f+2ewA1Am9WxSlSWC5CFaZkr4ZwUgWXqUwJSUpXmIDz
 hwXGdgHTSJwFUCSQuIrM4xWJYlyaxeUoLACSqMRLNHPVsRIlS3NyWXX6JXVmGstZgC+JSXaJ
 dLg9QUylSDNYOcuqWPWWipBCn3xw6LxOE+Hv/sK+dvjExKAgW38liR5+0N13MmhUU7OikoNf
 BadMK4ZZ11xd/0ulu7ZSzlRHL4e0Bv9l9xibQv/Uwz8HfE+7vRNOeXI9WQnHTrcUywrwhI54
 ZqF60aOqOWh96pz38bydsheTYCj8YNF6v3UtKsKyP2bZIy4+STkgwbhU6f5AVM1J/wGiId+7
 XQMAAA==
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrAIsWRmVeSWpSXmKPExsWy7bCSnG7ksUlxBn/O2lg8mLeNzeLlz6ts
 Fp/WL2O1mH/kHKvF8gtLmCzOn9/AbnFzy1EWi02Pr7FaXN41h81ixvl9TBbd13ewWSw//o/J
 4v+eHewWS7feZHTg87jc18vksXPWXXaPTas62Tw2L6n3aDm5n8Xj49NbLB59W1YxenzeJOfR
 fqCbKYAzissmJTUnsyy1SN8ugSujbaZ3Qc8k5opf56saGO+eZ+pi5OSQEDCRuH33I2sXIxeH
 kMBuRonpc5pZIRLSEtc3TmCHsIUlVv57zg5R1MQksXXjREaQBJuAtsTd6VvAJokI+Ev8+X4M
 rIhZ4ByTRP/NhUCTODiEBfyAuitBalgEVCWezHnDDGLzCthI7J43mxligbzE6g0HwGxOAVuJ
 BXe6wGYKAdX83XGcEaJeUOLkzCcsICOZBdQl1s8TAgkzA7U2b53NPIFRcBaSqlkIVbOQVC1g
 ZF7FKJlaUJybnltsWGCUl1quV5yYW1yal66XnJ+7iREcb1paOxhPnIg/xCjAwajEw3vg2sQ4
 IdbEsuLK3EOMEhzMSiK8T8qBQrwpiZVVqUX58UWlOanFhxilOViUxHnl849FCgmkJ5akZqem
 FqQWwWSZODilGhjDwi2bZp4NfLVYK//Iq75u1b8h34xOVFvYNycpXA+ck/n0yc1rEt8v5UbI
 ty94vV5xPwfTTrWnO9lLbhneOHGa+eqcY2oC1bWWZ+2uqaYeYpM1v/Er/ojLlF11s6o6r2x7
 3f/42u7HThzdXnkLTjOolhYWmq5xNJoU/lzkwrFtYkwvYnPPL+dQYinOSDTUYi4qTgQAOGhm
 s7MCAAA=
X-CMS-MailID: 20200412074218epcas5p3ef7973c8a47533a15a359b069da8003c
X-Msg-Generator: CA
CMS-TYPE: 105P
X-CMS-RootMailID: 20200412074218epcas5p3ef7973c8a47533a15a359b069da8003c
References: <20200412073159.37747-1-alim.akhtar@samsung.com>
 <CGME20200412074218epcas5p3ef7973c8a47533a15a359b069da8003c@epcas5p3.samsung.com>
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20200412_004225_391718_94567B5D 
X-CRM114-Status: GOOD (  21.68  )
X-Spam-Score: -5.2 (-----)
X-Spam-Report: SpamAssassin version 3.4.4 on bombadil.infradead.org summary:
 Content analysis details:   (-5.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 0.0 RCVD_IN_MSPIKE_H3      RBL: Good reputation (+3)
 [203.254.224.34 listed in wl.mailspike.net]
 -5.0 RCVD_IN_DNSWL_HI       RBL: Sender listed at https://www.dnswl.org/,
 high trust [203.254.224.34 listed in list.dnswl.org]
 -0.0 SPF_HELO_PASS          SPF: HELO matches SPF record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 0.0 RCVD_IN_MSPIKE_WL      Mailspike good senders
 -0.0 DKIMWL_WL_HIGH         DKIMwl.org - Whitelisted High sender
X-BeenThere: linux-arm-kernel@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-arm-kernel.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-arm-kernel/>
List-Post: <mailto:linux-arm-kernel@lists.infradead.org>
List-Help: <mailto:linux-arm-kernel-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=subscribe>
Cc: linux-samsung-soc@vger.kernel.org, martin.petersen@oracle.com,
 linux-kernel@vger.kernel.org, krzk@kernel.org, kwmad.kim@samsung.com,
 avri.altman@wdc.com, cang@codeaurora.org, Seungwon Jeon <essuuj@gmail.com>,
 Alim Akhtar <alim.akhtar@samsung.com>, stanley.chu@mediatek.com,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-arm-kernel" <linux-arm-kernel-bounces@lists.infradead.org>
Errors-To: linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org

VGhpcyBwYXRjaCBpbnRyb2R1Y2VzIEV4eW5vcyBVRlMgaG9zdCBjb250cm9sbGVyIGRyaXZlciwK
d2hpY2ggbWFpbmx5IGhhbmRsZXMgdmVuZG9yLXNwZWNpZmljIG9wZXJhdGlvbnMgaW5jbHVkaW5n
Cmxpbmsgc3RhcnR1cCwgcG93ZXIgbW9kZSBjaGFuZ2UgYW5kIGhpYmVybmF0aW9uL3VuaGliZXJu
YXRpb24uCgpSZXBvcnRlZC1ieToga2J1aWxkIHRlc3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+ClJl
cG9ydGVkLWJ5OiBKdWxpYSBMYXdhbGwgPGp1bGlhLmxhd2FsbEBsaXA2LmZyPgpbcm9ib3Q6IGRy
aXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5jOjkzMTo4LTEwOgogV0FSTklORzogcG9zc2libGUg
Y29uZGl0aW9uIHdpdGggbm8gZWZmZWN0IChpZiA9PSBlbHNlKQpdClJldmlld2VkLWJ5OiBLaXdv
b25nIEtpbSA8a3dtYWQua2ltQHNhbXN1bmcuY29tPgpTaWduZWQtb2ZmLWJ5OiBTZXVuZ3dvbiBK
ZW9uIDxlc3N1dWpAZ21haWwuY29tPgpTaWduZWQtb2ZmLWJ5OiBBbGltIEFraHRhciA8YWxpbS5h
a2h0YXJAc2Ftc3VuZy5jb20+ClRlc3RlZC1ieTogUGF3ZcWCIENobWllbCA8cGF3ZWwubWlrb2xh
ai5jaG1pZWxAZ21haWwuY29tPgotLS0KIGRyaXZlcnMvc2NzaS91ZnMvS2NvbmZpZyAgICAgIHwg
ICAxMiArCiBkcml2ZXJzL3Njc2kvdWZzL01ha2VmaWxlICAgICB8ICAgIDEgKwogZHJpdmVycy9z
Y3NpL3Vmcy91ZnMtZXh5bm9zLmMgfCAxMjg4ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKwogZHJpdmVycy9zY3NpL3Vmcy91ZnMtZXh5bm9zLmggfCAgMjg0ICsrKysrKysrCiBkcml2
ZXJzL3Njc2kvdWZzL3VuaXByby5oICAgICB8ICAgMzYgKwogNSBmaWxlcyBjaGFuZ2VkLCAxNjIx
IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL3Njc2kvdWZzL3Vmcy1l
eHlub3MuYwogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5o
CgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zY3NpL3Vmcy9LY29uZmlnIGIvZHJpdmVycy9zY3NpL3Vm
cy9LY29uZmlnCmluZGV4IGQxNGMyMjQzZTAyYS4uZDFiNTIxMTY1Y2IxIDEwMDY0NAotLS0gYS9k
cml2ZXJzL3Njc2kvdWZzL0tjb25maWcKKysrIGIvZHJpdmVycy9zY3NpL3Vmcy9LY29uZmlnCkBA
IC0xNjAsMyArMTYwLDE1IEBAIGNvbmZpZyBTQ1NJX1VGU19CU0cKIAogCSAgU2VsZWN0IHRoaXMg
aWYgeW91IG5lZWQgYSBic2cgZGV2aWNlIG5vZGUgZm9yIHlvdXIgVUZTIGNvbnRyb2xsZXIuCiAJ
ICBJZiB1bnN1cmUsIHNheSBOLgorCitjb25maWcgU0NTSV9VRlNfRVhZTk9TCisJYm9vbCAiRVhZ
Tk9TIHNwZWNpZmljIGhvb2tzIHRvIFVGUyBjb250cm9sbGVyIHBsYXRmb3JtIGRyaXZlciIKKwlk
ZXBlbmRzIG9uIFNDU0lfVUZTSENEX1BMQVRGT1JNICYmIEFSQ0hfRVhZTk9TIHx8IENPTVBJTEVf
VEVTVAorCXNlbGVjdCBQSFlfU0FNU1VOR19VRlMKKwloZWxwCisJICBUaGlzIHNlbGVjdHMgdGhl
IEVYWU5PUyBzcGVjaWZpYyBhZGRpdGlvbnMgdG8gVUZTSENEIHBsYXRmb3JtIGRyaXZlci4KKwkg
IFVGUyBob3N0IG9uIEVYWU5PUyBpbmNsdWRlcyBIQ0kgYW5kIFVOSVBSTyBsYXllciwgYW5kIGFz
c29jaWF0ZXMgd2l0aAorCSAgVUZTLVBIWSBkcml2ZXIuCisKKwkgIFNlbGVjdCB0aGlzIGlmIHlv
dSBoYXZlIFVGUyBob3N0IGNvbnRyb2xsZXIgb24gRVhZTk9TIGNoaXBzZXQuCisJICBJZiB1bnN1
cmUsIHNheSBOLgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zY3NpL3Vmcy9NYWtlZmlsZSBiL2RyaXZl
cnMvc2NzaS91ZnMvTWFrZWZpbGUKaW5kZXggOTRjNmM1ZDczMzRiLi5mMGM1Yjk1ZWM5Y2MgMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvc2NzaS91ZnMvTWFrZWZpbGUKKysrIGIvZHJpdmVycy9zY3NpL3Vm
cy9NYWtlZmlsZQpAQCAtNCw2ICs0LDcgQEAgb2JqLSQoQ09ORklHX1NDU0lfVUZTX0RXQ19UQ19Q
Q0kpICs9IHRjLWR3Yy1nMjEwLXBjaS5vIHVmc2hjZC1kd2MubyB0Yy1kd2MtZzIxMC4KIG9iai0k
KENPTkZJR19TQ1NJX1VGU19EV0NfVENfUExBVEZPUk0pICs9IHRjLWR3Yy1nMjEwLXBsdGZybS5v
IHVmc2hjZC1kd2MubyB0Yy1kd2MtZzIxMC5vCiBvYmotJChDT05GSUdfU0NTSV9VRlNfQ0ROU19Q
TEFURk9STSkgKz0gY2Rucy1wbHRmcm0ubwogb2JqLSQoQ09ORklHX1NDU0lfVUZTX1FDT00pICs9
IHVmcy1xY29tLm8KK29iai0kKENPTkZJR19TQ1NJX1VGU19FWFlOT1MpICs9IHVmcy1leHlub3Mu
bwogb2JqLSQoQ09ORklHX1NDU0lfVUZTSENEKSArPSB1ZnNoY2QtY29yZS5vCiB1ZnNoY2QtY29y
ZS15CQkJCSs9IHVmc2hjZC5vIHVmcy1zeXNmcy5vCiB1ZnNoY2QtY29yZS0kKENPTkZJR19TQ1NJ
X1VGU19CU0cpCSs9IHVmc19ic2cubwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zY3NpL3Vmcy91ZnMt
ZXh5bm9zLmMgYi9kcml2ZXJzL3Njc2kvdWZzL3Vmcy1leHlub3MuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmRlODM5NzJiNTRiMAotLS0gL2Rldi9udWxsCisrKyBi
L2RyaXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5jCkBAIC0wLDAgKzEsMTI4OCBAQAorLy8gU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIFVGUyBIb3N0IENvbnRy
b2xsZXIgZHJpdmVyIGZvciBFeHlub3Mgc3BlY2lmaWMgZXh0ZW5zaW9ucworICoKKyAqIENvcHly
aWdodCAoQykgMjAxNC0yMDE1IFNhbXN1bmcgRWxlY3Ryb25pY3MgQ28uLCBMdGQuCisgKiBBdXRo
b3I6IFNldW5nd29uIEplb24gIDxlc3N1dWpAZ21haWwuY29tPgorICogQXV0aG9yOiBBbGltIEFr
aHRhciA8YWxpbS5ha2h0YXJAc2Ftc3VuZy5jb20+CisgKgorICovCisKKyNpbmNsdWRlIDxsaW51
eC9jbGsuaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9vZi5o
PgorI2luY2x1ZGUgPGxpbnV4L29mX2FkZHJlc3MuaD4KKyNpbmNsdWRlIDxsaW51eC9waHkvcGh5
Lmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CisKKyNpbmNsdWRlICJ1ZnNo
Y2QuaCIKKyNpbmNsdWRlICJ1ZnNoY2QtcGx0ZnJtLmgiCisjaW5jbHVkZSAidWZzaGNpLmgiCisj
aW5jbHVkZSAidW5pcHJvLmgiCisKKyNpbmNsdWRlICJ1ZnMtZXh5bm9zLmgiCisKKy8qCisgKiBF
eHlub3MncyBWZW5kb3Igc3BlY2lmaWMgcmVnaXN0ZXJzIGZvciBVRlNIQ0kKKyAqLworI2RlZmlu
ZSBIQ0lfVFhQUkRUX0VOVFJZX1NJWkUJMHgwMAorI2RlZmluZSBQUkRUX1BSRUZFQ1RfRU4JCUJJ
VCgzMSkKKyNkZWZpbmUgUFJEVF9TRVRfU0laRSh4KQkoKHgpICYgMHgxRikKKyNkZWZpbmUgSENJ
X1JYUFJEVF9FTlRSWV9TSVpFCTB4MDQKKyNkZWZpbmUgSENJXzFVU19UT19DTlRfVkFMCTB4MEMK
KyNkZWZpbmUgQ05UX1ZBTF8xVVNfTUFTSwkweDNGRgorI2RlZmluZSBIQ0lfVVRSTF9ORVhVU19U
WVBFCTB4NDAKKyNkZWZpbmUgSENJX1VUTVJMX05FWFVTX1RZUEUJMHg0NAorI2RlZmluZSBIQ0lf
U1dfUlNUCQkweDUwCisjZGVmaW5lIFVGU19MSU5LX1NXX1JTVAkJQklUKDApCisjZGVmaW5lIFVG
U19VTklQUk9fU1dfUlNUCUJJVCgxKQorI2RlZmluZSBVRlNfU1dfUlNUX01BU0sJCShVRlNfVU5J
UFJPX1NXX1JTVCB8IFVGU19MSU5LX1NXX1JTVCkKKyNkZWZpbmUgSENJX0RBVEFfUkVPUkRFUgkw
eDYwCisjZGVmaW5lIEhDSV9VTklQUk9fQVBCX0NMS19DVFJMCTB4NjgKKyNkZWZpbmUgVU5JUFJP
X0FQQl9DTEsodiwgeCkJKCgodikgJiB+MHhGKSB8ICgoeCkgJiAweEYpKQorI2RlZmluZSBIQ0lf
QVhJRE1BX1JXREFUQV9CVVJTVF9MRU4JMHg2QworI2RlZmluZSBIQ0lfR1BJT19PVVQJCTB4NzAK
KyNkZWZpbmUgSENJX0VSUl9FTl9QQV9MQVlFUgkweDc4CisjZGVmaW5lIEhDSV9FUlJfRU5fRExf
TEFZRVIJMHg3QworI2RlZmluZSBIQ0lfRVJSX0VOX05fTEFZRVIJMHg4MAorI2RlZmluZSBIQ0lf
RVJSX0VOX1RfTEFZRVIJMHg4NAorI2RlZmluZSBIQ0lfRVJSX0VOX0RNRV9MQVlFUgkweDg4Cisj
ZGVmaW5lIEhDSV9DTEtTVE9QX0NUUkwJMHhCMAorI2RlZmluZSBSRUZDTEtfU1RPUAkJQklUKDIp
CisjZGVmaW5lIFVOSVBST19NQ0xLX1NUT1AJQklUKDEpCisjZGVmaW5lIFVOSVBST19QQ0xLX1NU
T1AJQklUKDApCisjZGVmaW5lIENMS19TVE9QX01BU0sJCShSRUZDTEtfU1RPUCB8XAorCQkJCSBV
TklQUk9fTUNMS19TVE9QIHxcCisJCQkJIFVOSVBST19QQ0xLX1NUT1ApCisjZGVmaW5lIEhDSV9N
SVNDCQkweEI0CisjZGVmaW5lIFJFRkNMS19DVFJMX0VOCQlCSVQoNykKKyNkZWZpbmUgVU5JUFJP
X1BDTEtfQ1RSTF9FTglCSVQoNikKKyNkZWZpbmUgVU5JUFJPX01DTEtfQ1RSTF9FTglCSVQoNSkK
KyNkZWZpbmUgSENJX0NPUkVDTEtfQ1RSTF9FTglCSVQoNCkKKyNkZWZpbmUgQ0xLX0NUUkxfRU5f
TUFTSwkoUkVGQ0xLX0NUUkxfRU4gfFwKKwkJCQkgVU5JUFJPX1BDTEtfQ1RSTF9FTiB8XAorCQkJ
CSBVTklQUk9fTUNMS19DVFJMX0VOKQorLyogRGV2aWNlIGZhdGFsIGVycm9yICovCisjZGVmaW5l
IERGRVNfRVJSX0VOCQlCSVQoMzEpCisjZGVmaW5lIERGRVNfREVGX0wyX0VSUlMJKFVJQ19EQVRB
X0xJTktfTEFZRVJfRVJST1JfUlhfQlVGX09GIHxcCisJCQkJIFVJQ19EQVRBX0xJTktfTEFZRVJf
RVJST1JfUEFfSU5JVCkKKyNkZWZpbmUgREZFU19ERUZfTDNfRVJSUwkoVUlDX05FVFdPUktfVU5T
VVBQT1JURURfSEVBREVSX1RZUEUgfFwKKwkJCQkgVUlDX05FVFdPUktfQkFEX0RFVklDRUlEX0VO
QyB8XAorCQkJCSBVSUNfTkVUV09SS19MSERSX1RSQVBfUEFDS0VUX0RST1BQSU5HKQorI2RlZmlu
ZSBERkVTX0RFRl9MNF9FUlJTCShVSUNfVFJBTlNQT1JUX1VOU1VQUE9SVEVEX0hFQURFUl9UWVBF
IHxcCisJCQkJIFVJQ19UUkFOU1BPUlRfVU5LTk9XTl9DUE9SVElEIHxcCisJCQkJIFVJQ19UUkFO
U1BPUlRfTk9fQ09OTkVDVElPTl9SWCB8XAorCQkJCSBVSUNfVFJBTlNQT1JUX0JBRF9UQykKKwor
ZW51bSB7CisJVU5JUFJPX0wxXzUgPSAwLC8qIFBIWSBBZGFwdGVyICovCisJVU5JUFJPX0wyLAkv
KiBEYXRhIExpbmsgKi8KKwlVTklQUk9fTDMsCS8qIE5ldHdvcmsgKi8KKwlVTklQUk9fTDQsCS8q
IFRyYW5zcG9ydCAqLworCVVOSVBST19ETUUsCS8qIERNRSAqLworfTsKKworLyoKKyAqIFVOSVBS
TyByZWdpc3RlcnMKKyAqLworI2RlZmluZSBVTklQUk9fQ09NUF9WRVJTSU9OCQkJMHgwMDAKKyNk
ZWZpbmUgVU5JUFJPX0RNRV9QV1JfUkVRCQkJMHgwOTAKKyNkZWZpbmUgVU5JUFJPX0RNRV9QV1Jf
UkVRX1BPV0VSTU9ERQkJMHgwOTQKKyNkZWZpbmUgVU5JUFJPX0RNRV9QV1JfUkVRX0xPQ0FMTDJU
SU1FUjAJMHgwOTgKKyNkZWZpbmUgVU5JUFJPX0RNRV9QV1JfUkVRX0xPQ0FMTDJUSU1FUjEJMHgw
OUMKKyNkZWZpbmUgVU5JUFJPX0RNRV9QV1JfUkVRX0xPQ0FMTDJUSU1FUjIJMHgwQTAKKyNkZWZp
bmUgVU5JUFJPX0RNRV9QV1JfUkVRX1JFTU9URUwyVElNRVIwCTB4MEE0CisjZGVmaW5lIFVOSVBS
T19ETUVfUFdSX1JFUV9SRU1PVEVMMlRJTUVSMQkweDBBOAorI2RlZmluZSBVTklQUk9fRE1FX1BX
Ul9SRVFfUkVNT1RFTDJUSU1FUjIJMHgwQUMKKworLyoKKyAqIFVGUyBQcm90ZWN0b3IgcmVnaXN0
ZXJzCisgKi8KKyNkZWZpbmUgVUZTUFJTRUNVUklUWQkweDAxMAorI2RlZmluZSBOU1NNVQkJQklU
KDE0KQorI2RlZmluZSBVRlNQU0JFR0lOMAkweDIwMAorI2RlZmluZSBVRlNQU0VORDAJMHgyMDQK
KyNkZWZpbmUgVUZTUFNMVU4wCTB4MjA4CisjZGVmaW5lIFVGU1BTQ1RSTDAJMHgyMEMKKworI2Rl
ZmluZSBDTlRSX0RJVl9WQUwgNDAKKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19hdXRvX2N0cmxf
aGNjKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsIGJvb2wgZW4pOworc3RhdGljIHZvaWQgZXh5bm9z
X3Vmc19jdHJsX2Nsa3N0b3Aoc3RydWN0IGV4eW5vc191ZnMgKnVmcywgYm9vbCBlbik7CisKK3N0
YXRpYyBpbmxpbmUgdm9pZCBleHlub3NfdWZzX2VuYWJsZV9hdXRvX2N0cmxfaGNjKHN0cnVjdCBl
eHlub3NfdWZzICp1ZnMpCit7CisJZXh5bm9zX3Vmc19hdXRvX2N0cmxfaGNjKHVmcywgdHJ1ZSk7
Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleHlub3NfdWZzX2Rpc2FibGVfYXV0b19jdHJsX2hj
YyhzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCWV4eW5vc191ZnNfYXV0b19jdHJsX2hjYyh1
ZnMsIGZhbHNlKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGV4eW5vc191ZnNfZGlzYWJsZV9h
dXRvX2N0cmxfaGNjX3NhdmUoCisJCQkJCXN0cnVjdCBleHlub3NfdWZzICp1ZnMsIHUzMiAqdmFs
KQoreworCSp2YWwgPSBoY2lfcmVhZGwodWZzLCBIQ0lfTUlTQyk7CisJZXh5bm9zX3Vmc19hdXRv
X2N0cmxfaGNjKHVmcywgZmFsc2UpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgZXh5bm9zX3Vm
c19hdXRvX2N0cmxfaGNjX3Jlc3RvcmUoCisJCQkJCXN0cnVjdCBleHlub3NfdWZzICp1ZnMsIHUz
MiAqdmFsKQoreworCWhjaV93cml0ZWwodWZzLCAqdmFsLCBIQ0lfTUlTQyk7Cit9CisKK3N0YXRp
YyBpbmxpbmUgdm9pZCBleHlub3NfdWZzX2dhdGVfY2xrcyhzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZz
KQoreworCWV4eW5vc191ZnNfY3RybF9jbGtzdG9wKHVmcywgdHJ1ZSk7Cit9CisKK3N0YXRpYyBp
bmxpbmUgdm9pZCBleHlub3NfdWZzX3VuZ2F0ZV9jbGtzKHN0cnVjdCBleHlub3NfdWZzICp1ZnMp
Cit7CisJZXh5bm9zX3Vmc19jdHJsX2Nsa3N0b3AodWZzLCBmYWxzZSk7Cit9CisKK3N0YXRpYyBp
bnQgZXh5bm9zN191ZnNfZHJ2X2luaXQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZXh5bm9z
X3VmcyAqdWZzKQoreworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGV4eW5vczdfdWZzX3By
ZV9saW5rKHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVmc19oYmEgKmhiYSA9
IHVmcy0+aGJhOworCXUzMiB2YWwgPSB1ZnMtPmRydl9kYXRhLT51aWNfYXR0ci0+cGFfZGJnX29w
dGlvbl9zdWl0ZTsKKwlpbnQgaTsKKworCWV4eW5vc191ZnNfZW5hYmxlX292X3RtKGhiYSk7CisJ
Zm9yX2VhY2hfdWZzX3R4X2xhbmUodWZzLCBpKQorCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19B
UkdfTUlCX1NFTCgweDI5NywgaSksIDB4MTcpOworCWZvcl9lYWNoX3Vmc19yeF9sYW5lKHVmcywg
aSkgeworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTCgweDM2MiwgaSksIDB4
ZmYpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTCgweDM2MywgaSksIDB4
MDApOworCX0KKwlleHlub3NfdWZzX2Rpc2FibGVfb3ZfdG0oaGJhKTsKKworCWZvcl9lYWNoX3Vm
c190eF9sYW5lKHVmcywgaSkKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLAorCQkJVUlDX0FSR19NSUJf
U0VMKFRYX0hJQkVSTjhfQ09OVFJPTCwgaSksIDB4MCk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBV
SUNfQVJHX01JQihQQV9EQkdfVFhQSFlfQ0ZHVVBEVCksIDB4MSk7CisJdWRlbGF5KDEpOworCXVm
c2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoUEFfREJHX09QVElPTl9TVUlURSksIHZhbCB8
ICgxIDw8IDEyKSk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9EQkdfU0tJ
UF9SRVNFVF9QSFkpLCAweDEpOworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoUEFf
REJHX1NLSVBfTElORV9SRVNFVCksIDB4MSk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJH
X01JQihQQV9EQkdfTElORV9SRVNFVF9SRVEpLCAweDEpOworCXVkZWxheSgxNjAwKTsKKwl1ZnNo
Y2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0RCR19PUFRJT05fU1VJVEUpLCB2YWwpOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZXh5bm9zN191ZnNfcG9zdF9saW5rKHN0cnVj
dCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVmc19oYmEgKmhiYSA9IHVmcy0+aGJhOwor
CWludCBpOworCisJZXh5bm9zX3Vmc19lbmFibGVfb3ZfdG0oaGJhKTsKKwlmb3JfZWFjaF91ZnNf
dHhfbGFuZSh1ZnMsIGkpIHsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwo
MHgyOGIsIGkpLCAweDgzKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwo
MHgyOWEsIGkpLCAweDA3KTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwo
MHgyNzcsIGkpLAorCQkJVFhfTElORVJFU0VUX04oZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1
ZnMsIDIwMDAwMCkpKTsKKwl9CisJZXh5bm9zX3Vmc19kaXNhYmxlX292X3RtKGhiYSk7CisKKwll
eHlub3NfdWZzX2VuYWJsZV9kYmdfbW9kZShoYmEpOworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlD
X0FSR19NSUIoUEFfU0FWRUNPTkZJR1RJTUUpLCAweGJiOCk7CisJZXh5bm9zX3Vmc19kaXNhYmxl
X2RiZ19tb2RlKGhiYSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBleHlub3M3X3Vm
c19wcmVfcHdyX2NoYW5nZShzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzLAorCQkJCQkJc3RydWN0IHVm
c19wYV9sYXllcl9hdHRyICpwd3IpCit7CisJdW5pcHJvX3dyaXRlbCh1ZnMsIDB4MjIsIFVOSVBS
T19EQkdfRk9SQ0VfRE1FX0NUUkxfU1RBVEUpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBp
bnQgZXh5bm9zN191ZnNfcG9zdF9wd3JfY2hhbmdlKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsCisJ
CQkJCQlzdHJ1Y3QgdWZzX3BhX2xheWVyX2F0dHIgKnB3cikKK3sKKwlzdHJ1Y3QgdWZzX2hiYSAq
aGJhID0gdWZzLT5oYmE7CisJaW50IGxhbmVzID0gbWF4X3QodTMyLCBwd3ItPmxhbmVfcngsIHB3
ci0+bGFuZV90eCk7CisKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0RCR19S
WFBIWV9DRkdVUERUKSwgMHgxKTsKKworCWlmIChsYW5lcyA9PSAxKSB7CisJCWV4eW5vc191ZnNf
ZW5hYmxlX2RiZ19tb2RlKGhiYSk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIo
UEFfQ09OTkVDVEVEVFhEQVRBTEFORVMpLCAweDEpOworCQlleHlub3NfdWZzX2Rpc2FibGVfZGJn
X21vZGUoaGJhKTsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiBleHlub3NfdWZzX2F1
dG9fY3RybF9oY2MgLSBIQ0kgY29yZSBjbG9jayBjb250cm9sIGJ5IGgvdworICogQ29udHJvbCBz
aG91bGQgYmUgZGlzYWJsZWQgaW4gdGhlIGJlbG93IGNhc2VzCisgKiAtIEJlZm9yZSBob3N0IGNv
bnRyb2xsZXIgUy9XIHJlc2V0CisgKiAtIEFjY2VzcyB0byBVRlMgcHJvdGVjdG9yJ3MgcmVnaXN0
ZXIKKyAqLworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19hdXRvX2N0cmxfaGNjKHN0cnVjdCBleHlu
b3NfdWZzICp1ZnMsIGJvb2wgZW4pCit7CisJdTMyIG1pc2MgPSBoY2lfcmVhZGwodWZzLCBIQ0lf
TUlTQyk7CisKKwlpZiAoZW4pCisJCWhjaV93cml0ZWwodWZzLCBtaXNjIHwgSENJX0NPUkVDTEtf
Q1RSTF9FTiwgSENJX01JU0MpOworCWVsc2UKKwkJaGNpX3dyaXRlbCh1ZnMsIG1pc2MgJiB+SENJ
X0NPUkVDTEtfQ1RSTF9FTiwgSENJX01JU0MpOworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZz
X2N0cmxfY2xrc3RvcChzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzLCBib29sIGVuKQoreworCXUzMiBj
dHJsID0gaGNpX3JlYWRsKHVmcywgSENJX0NMS1NUT1BfQ1RSTCk7CisJdTMyIG1pc2MgPSBoY2lf
cmVhZGwodWZzLCBIQ0lfTUlTQyk7CisKKwlpZiAoZW4pIHsKKwkJaGNpX3dyaXRlbCh1ZnMsIG1p
c2MgfCBDTEtfQ1RSTF9FTl9NQVNLLCBIQ0lfTUlTQyk7CisJCWhjaV93cml0ZWwodWZzLCBjdHJs
IHwgQ0xLX1NUT1BfTUFTSywgSENJX0NMS1NUT1BfQ1RSTCk7CisJfSBlbHNlIHsKKwkJaGNpX3dy
aXRlbCh1ZnMsIGN0cmwgJiB+Q0xLX1NUT1BfTUFTSywgSENJX0NMS1NUT1BfQ1RSTCk7CisJCWhj
aV93cml0ZWwodWZzLCBtaXNjICYgfkNMS19DVFJMX0VOX01BU0ssIEhDSV9NSVNDKTsKKwl9Cit9
CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19nZXRfY2xrX2luZm8oc3RydWN0IGV4eW5vc191ZnMg
KnVmcykKK3sKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJhID0gdWZzLT5oYmE7CisJc3RydWN0IGxpc3Rf
aGVhZCAqaGVhZCA9ICZoYmEtPmNsa19saXN0X2hlYWQ7CisJc3RydWN0IHVmc19jbGtfaW5mbyAq
Y2xraTsKKwl1MzIgcGNsa19yYXRlOworCXUzMiBmX21pbiwgZl9tYXg7CisJdTggZGl2ID0gMDsK
KwlpbnQgcmV0ID0gMDsKKworCWlmICghaGVhZCB8fCBsaXN0X2VtcHR5KGhlYWQpKQorCQlnb3Rv
IG91dDsKKworCWxpc3RfZm9yX2VhY2hfZW50cnkoY2xraSwgaGVhZCwgbGlzdCkgeworCQlpZiAo
IUlTX0VSUihjbGtpLT5jbGspKSB7CisJCQlpZiAoIXN0cmNtcChjbGtpLT5uYW1lLCAiY29yZV9j
bGsiKSkKKwkJCQl1ZnMtPmNsa19oY2lfY29yZSA9IGNsa2ktPmNsazsKKwkJCWVsc2UgaWYgKCFz
dHJjbXAoY2xraS0+bmFtZSwgInNjbGtfdW5pcHJvX21haW4iKSkKKwkJCQl1ZnMtPmNsa191bmlw
cm9fbWFpbiA9IGNsa2ktPmNsazsKKwkJfQorCX0KKworCWlmICghdWZzLT5jbGtfaGNpX2NvcmUg
fHwgIXVmcy0+Y2xrX3VuaXByb19tYWluKSB7CisJCWRldl9lcnIoaGJhLT5kZXYsICJmYWlsZWQg
dG8gZ2V0IGNsayBpbmZvXG4iKTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJZ290byBvdXQ7CisJfQor
CisJdWZzLT5tY2xrX3JhdGUgPSBjbGtfZ2V0X3JhdGUodWZzLT5jbGtfdW5pcHJvX21haW4pOwor
CXBjbGtfcmF0ZSA9IGNsa19nZXRfcmF0ZSh1ZnMtPmNsa19oY2lfY29yZSk7CisJZl9taW4gPSB1
ZnMtPnBjbGtfYXZhaWxfbWluOworCWZfbWF4ID0gdWZzLT5wY2xrX2F2YWlsX21heDsKKworCWlm
ICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09QVF9IQVNfQVBCX0NMS19DVFJMKSB7CisJCWRvIHsK
KwkJCXBjbGtfcmF0ZSAvPSAoZGl2ICsgMSk7CisKKwkJCWlmIChwY2xrX3JhdGUgPD0gZl9tYXgp
CisJCQkJYnJlYWs7CisJCQlkaXYrKzsKKwkJfSB3aGlsZSAocGNsa19yYXRlID49IGZfbWluKTsK
Kwl9CisKKwlpZiAodW5saWtlbHkocGNsa19yYXRlIDwgZl9taW4gfHwgcGNsa19yYXRlID4gZl9t
YXgpKSB7CisJCWRldl9lcnIoaGJhLT5kZXYsICJub3QgYXZhaWxhYmxlIHBjbGsgcmFuZ2UgJWRc
biIsIHBjbGtfcmF0ZSk7CisJCXJldCA9IC1FSU5WQUw7CisJCWdvdG8gb3V0OworCX0KKworCXVm
cy0+cGNsa19yYXRlID0gcGNsa19yYXRlOworCXVmcy0+cGNsa19kaXYgPSBkaXY7CisKK291dDoK
KwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX3NldF91bmlwcm9fcGNs
a19kaXYoc3RydWN0IGV4eW5vc191ZnMgKnVmcykKK3sKKwlpZiAodWZzLT5vcHRzICYgRVhZTk9T
X1VGU19PUFRfSEFTX0FQQl9DTEtfQ1RSTCkgeworCQl1MzIgdmFsOworCisJCXZhbCA9IGhjaV9y
ZWFkbCh1ZnMsIEhDSV9VTklQUk9fQVBCX0NMS19DVFJMKTsKKwkJaGNpX3dyaXRlbCh1ZnMsIFVO
SVBST19BUEJfQ0xLKHZhbCwgdWZzLT5wY2xrX2RpdiksCisJCQkgICBIQ0lfVU5JUFJPX0FQQl9D
TEtfQ1RSTCk7CisJfQorfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX3NldF9wd21fY2xrX2Rp
dihzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCXN0cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMt
PmhiYTsKKwlzdHJ1Y3QgZXh5bm9zX3Vmc191aWNfYXR0ciAqYXR0ciA9IHVmcy0+ZHJ2X2RhdGEt
PnVpY19hdHRyOworCisJdWZzaGNkX2RtZV9zZXQoaGJhLAorCQlVSUNfQVJHX01JQihDTU5fUFdN
X0NMS19DVFJMKSwgYXR0ci0+Y21uX3B3bV9jbGtfY3RybCk7Cit9CisKK3N0YXRpYyB2b2lkIGV4
eW5vc191ZnNfY2FsY19wd21fY2xrX2RpdihzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCXN0
cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMtPmhiYTsKKwlzdHJ1Y3QgZXh5bm9zX3Vmc191aWNfYXR0
ciAqYXR0ciA9IHVmcy0+ZHJ2X2RhdGEtPnVpY19hdHRyOworCWNvbnN0IHVuc2lnbmVkIGludCBk
aXYgPSAzMCwgbXVsdCA9IDIwOworCWNvbnN0IHVuc2lnbmVkIGxvbmcgcHdtX21pbiA9IDMgKiAx
MDAwICogMTAwMDsKKwljb25zdCB1bnNpZ25lZCBsb25nIHB3bV9tYXggPSA5ICogMTAwMCAqIDEw
MDA7CisJY29uc3QgaW50IGRpdnNbXSA9IHszMiwgMTYsIDgsIDR9OworCXVuc2lnbmVkIGxvbmcg
Y2xrID0gMCwgX2NsaywgY2xrX3BlcmlvZDsKKwlpbnQgaSA9IDAsIGNsa19pZHggPSAtMTsKKwor
CWNsa19wZXJpb2QgPSBVTklQUk9fUENMS19QRVJJT0QodWZzKTsKKwlmb3IgKGkgPSAwOyBpIDwg
QVJSQVlfU0laRShkaXZzKTsgaSsrKSB7CisJCV9jbGsgPSBOU0VDX1BFUl9TRUMgKiBtdWx0IC8g
KGNsa19wZXJpb2QgKiBkaXZzW2ldICogZGl2KTsKKwkJaWYgKF9jbGsgPj0gcHdtX21pbiAmJiBf
Y2xrIDw9IHB3bV9tYXgpIHsKKwkJCWlmIChfY2xrID4gY2xrKSB7CisJCQkJY2xrX2lkeCA9IGk7
CisJCQkJY2xrID0gX2NsazsKKwkJCX0KKwkJfQorCX0KKworCWlmIChjbGtfaWR4ID09IC0xKSB7
CisJCXVmc2hjZF9kbWVfZ2V0KGhiYSwgVUlDX0FSR19NSUIoQ01OX1BXTV9DTEtfQ1RSTCksICZj
bGtfaWR4KTsKKwkJZGV2X2VycihoYmEtPmRldiwKKwkJCSJmYWlsZWQgdG8gZGVjaWRlIHB3bSBj
bG9jayBkaXZpZGVyLCB3aWxsIG5vdCBjaGFuZ2VcbiIpOworCX0KKworCWF0dHItPmNtbl9wd21f
Y2xrX2N0cmwgPSBjbGtfaWR4ICYgUFdNX0NMS19DVFJMX01BU0s7Cit9CisKK2xvbmcgZXh5bm9z
X3Vmc19jYWxjX3RpbWVfY250cihzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzLCBsb25nIHBlcmlvZCkK
K3sKKwljb25zdCBpbnQgcHJlY2lzZSA9IDEwOworCWxvbmcgcGNsa19yYXRlID0gdWZzLT5wY2xr
X3JhdGU7CisJbG9uZyBjbGtfcGVyaW9kLCBmcmFjdGlvbjsKKworCWNsa19wZXJpb2QgPSBVTklQ
Uk9fUENMS19QRVJJT0QodWZzKTsKKwlmcmFjdGlvbiA9ICgoTlNFQ19QRVJfU0VDICUgcGNsa19y
YXRlKSAqIHByZWNpc2UpIC8gcGNsa19yYXRlOworCisJcmV0dXJuIChwZXJpb2QgKiBwcmVjaXNl
KSAvICgoY2xrX3BlcmlvZCAqIHByZWNpc2UpICsgZnJhY3Rpb24pOworfQorCitzdGF0aWMgdm9p
ZCBleHlub3NfdWZzX3NwZWNpZnlfcGh5X3RpbWVfYXR0cihzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZz
KQoreworCXN0cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICphdHRyID0gdWZzLT5kcnZfZGF0YS0+
dWljX2F0dHI7CisJc3RydWN0IHVmc19waHlfdGltZV9jZmcgKnRfY2ZnID0gJnVmcy0+dF9jZmc7
CisKKwl0X2NmZy0+dHhfbGluZXJlc2V0X3AgPQorCQlleHlub3NfdWZzX2NhbGNfdGltZV9jbnRy
KHVmcywgYXR0ci0+dHhfZGlmX3BfbnNlYyk7CisJdF9jZmctPnR4X2xpbmVyZXNldF9uID0KKwkJ
ZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0dHItPnR4X2RpZl9uX25zZWMpOworCXRf
Y2ZnLT50eF9oaWdoX3pfY250ID0KKwkJZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0
dHItPnR4X2hpZ2hfel9jbnRfbnNlYyk7CisJdF9jZmctPnR4X2Jhc2Vfbl92YWwgPQorCQlleHlu
b3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgYXR0ci0+dHhfYmFzZV91bml0X25zZWMpOworCXRf
Y2ZnLT50eF9ncmFuX25fdmFsID0KKwkJZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0
dHItPnR4X2dyYW5fdW5pdF9uc2VjKTsKKwl0X2NmZy0+dHhfc2xlZXBfY250ID0KKwkJZXh5bm9z
X3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0dHItPnR4X3NsZWVwX2NudCk7CisKKwl0X2NmZy0+
cnhfbGluZXJlc2V0ID0KKwkJZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0dHItPnJ4
X2RpZl9wX25zZWMpOworCXRfY2ZnLT5yeF9oaWJlcm44X3dhaXQgPQorCQlleHlub3NfdWZzX2Nh
bGNfdGltZV9jbnRyKHVmcywgYXR0ci0+cnhfaGliZXJuOF93YWl0X25zZWMpOworCXRfY2ZnLT5y
eF9iYXNlX25fdmFsID0KKwkJZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0dHItPnJ4
X2Jhc2VfdW5pdF9uc2VjKTsKKwl0X2NmZy0+cnhfZ3Jhbl9uX3ZhbCA9CisJCWV4eW5vc191ZnNf
Y2FsY190aW1lX2NudHIodWZzLCBhdHRyLT5yeF9ncmFuX3VuaXRfbnNlYyk7CisJdF9jZmctPnJ4
X3NsZWVwX2NudCA9CisJCWV4eW5vc191ZnNfY2FsY190aW1lX2NudHIodWZzLCBhdHRyLT5yeF9z
bGVlcF9jbnQpOworCXRfY2ZnLT5yeF9zdGFsbF9jbnQgPQorCQlleHlub3NfdWZzX2NhbGNfdGlt
ZV9jbnRyKHVmcywgYXR0ci0+cnhfc3RhbGxfY250KTsKK30KKworc3RhdGljIHZvaWQgZXh5bm9z
X3Vmc19jb25maWdfcGh5X3RpbWVfYXR0cihzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCXN0
cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMtPmhiYTsKKwlzdHJ1Y3QgdWZzX3BoeV90aW1lX2NmZyAq
dF9jZmcgPSAmdWZzLT50X2NmZzsKKwlpbnQgaTsKKworCWV4eW5vc191ZnNfc2V0X3B3bV9jbGtf
ZGl2KHVmcyk7CisKKwlleHlub3NfdWZzX2VuYWJsZV9vdl90bShoYmEpOworCisJZm9yX2VhY2hf
dWZzX3J4X2xhbmUodWZzLCBpKSB7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJf
U0VMKFJYX0ZJTExFUl9FTkFCTEUsIGkpLAorCQkJCXVmcy0+ZHJ2X2RhdGEtPnVpY19hdHRyLT5y
eF9maWxsZXJfZW5hYmxlKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwo
UlhfTElORVJFU0VUX1ZBTCwgaSksCisJCQkJUlhfTElORVJFU0VUKHRfY2ZnLT5yeF9saW5lcmVz
ZXQpKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoUlhfQkFTRV9OVkFM
XzA3XzAwLCBpKSwKKwkJCQlSWF9CQVNFX05WQUxfTCh0X2NmZy0+cnhfYmFzZV9uX3ZhbCkpOwor
CQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTChSWF9CQVNFX05WQUxfMTVfMDgs
IGkpLAorCQkJCVJYX0JBU0VfTlZBTF9IKHRfY2ZnLT5yeF9iYXNlX25fdmFsKSk7CisJCXVmc2hj
ZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKFJYX0dSQU5fTlZBTF8wN18wMCwgaSksCisJ
CQkJUlhfR1JBTl9OVkFMX0wodF9jZmctPnJ4X2dyYW5fbl92YWwpKTsKKwkJdWZzaGNkX2RtZV9z
ZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoUlhfR1JBTl9OVkFMXzEwXzA4LCBpKSwKKwkJCQlSWF9H
UkFOX05WQUxfSCh0X2NmZy0+cnhfZ3Jhbl9uX3ZhbCkpOworCQl1ZnNoY2RfZG1lX3NldChoYmEs
IFVJQ19BUkdfTUlCX1NFTChSWF9PVl9TTEVFUF9DTlRfVElNRVIsIGkpLAorCQkJCVJYX09WX1NM
RUVQX0NOVCh0X2NmZy0+cnhfc2xlZXBfY250KSk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlD
X0FSR19NSUJfU0VMKFJYX09WX1NUQUxMX0NOVF9USU1FUiwgaSksCisJCQkJUlhfT1ZfU1RBTExf
Q05UKHRfY2ZnLT5yeF9zdGFsbF9jbnQpKTsKKwl9CisKKwlmb3JfZWFjaF91ZnNfdHhfbGFuZSh1
ZnMsIGkpIHsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoVFhfTElORVJF
U0VUX1BfVkFMLCBpKSwKKwkJCQlUWF9MSU5FUkVTRVRfUCh0X2NmZy0+dHhfbGluZXJlc2V0X3Ap
KTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoVFhfSElHSF9aX0NOVF8w
N18wMCwgaSksCisJCQkJVFhfSElHSF9aX0NOVF9MKHRfY2ZnLT50eF9oaWdoX3pfY250KSk7CisJ
CXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKFRYX0hJR0hfWl9DTlRfMTFfMDgs
IGkpLAorCQkJCVRYX0hJR0hfWl9DTlRfSCh0X2NmZy0+dHhfaGlnaF96X2NudCkpOworCQl1ZnNo
Y2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTChUWF9CQVNFX05WQUxfMDdfMDAsIGkpLAor
CQkJCVRYX0JBU0VfTlZBTF9MKHRfY2ZnLT50eF9iYXNlX25fdmFsKSk7CisJCXVmc2hjZF9kbWVf
c2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKFRYX0JBU0VfTlZBTF8xNV8wOCwgaSksCisJCQkJVFhf
QkFTRV9OVkFMX0godF9jZmctPnR4X2Jhc2Vfbl92YWwpKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJh
LCBVSUNfQVJHX01JQl9TRUwoVFhfR1JBTl9OVkFMXzA3XzAwLCBpKSwKKwkJCQlUWF9HUkFOX05W
QUxfTCh0X2NmZy0+dHhfZ3Jhbl9uX3ZhbCkpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19B
UkdfTUlCX1NFTChUWF9HUkFOX05WQUxfMTBfMDgsIGkpLAorCQkJCVRYX0dSQU5fTlZBTF9IKHRf
Y2ZnLT50eF9ncmFuX25fdmFsKSk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJf
U0VMKFRYX09WX1NMRUVQX0NOVF9USU1FUiwgaSksCisJCQkJVFhfT1ZfSDhfRU5URVJfRU4gfAor
CQkJCVRYX09WX1NMRUVQX0NOVCh0X2NmZy0+dHhfc2xlZXBfY250KSk7CisJCXVmc2hjZF9kbWVf
c2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKFRYX01JTl9BQ1RJVkFURVRJTUUsIGkpLAorCQkJCXVm
cy0+ZHJ2X2RhdGEtPnVpY19hdHRyLT50eF9taW5fYWN0aXZhdGV0aW1lKTsKKwl9CisKKwlleHlu
b3NfdWZzX2Rpc2FibGVfb3ZfdG0oaGJhKTsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19j
b25maWdfcGh5X2NhcF9hdHRyKHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVm
c19oYmEgKmhiYSA9IHVmcy0+aGJhOworCXN0cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICphdHRy
ID0gdWZzLT5kcnZfZGF0YS0+dWljX2F0dHI7CisJaW50IGk7CisKKwlleHlub3NfdWZzX2VuYWJs
ZV9vdl90bShoYmEpOworCisJZm9yX2VhY2hfdWZzX3J4X2xhbmUodWZzLCBpKSB7CisJCXVmc2hj
ZF9kbWVfc2V0KGhiYSwKKwkJCQlVSUNfQVJHX01JQl9TRUwoUlhfSFNfRzFfU1lOQ19MRU5HVEhf
Q0FQLCBpKSwKKwkJCQlhdHRyLT5yeF9oc19nMV9zeW5jX2xlbl9jYXApOworCQl1ZnNoY2RfZG1l
X3NldChoYmEsCisJCQkJVUlDX0FSR19NSUJfU0VMKFJYX0hTX0cyX1NZTkNfTEVOR1RIX0NBUCwg
aSksCisJCQkJYXR0ci0+cnhfaHNfZzJfc3luY19sZW5fY2FwKTsKKwkJdWZzaGNkX2RtZV9zZXQo
aGJhLAorCQkJCVVJQ19BUkdfTUlCX1NFTChSWF9IU19HM19TWU5DX0xFTkdUSF9DQVAsIGkpLAor
CQkJCWF0dHItPnJ4X2hzX2czX3N5bmNfbGVuX2NhcCk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwK
KwkJCQlVSUNfQVJHX01JQl9TRUwoUlhfSFNfRzFfUFJFUF9MRU5HVEhfQ0FQLCBpKSwKKwkJCQlh
dHRyLT5yeF9oc19nMV9wcmVwX3N5bmNfbGVuX2NhcCk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwK
KwkJCQlVSUNfQVJHX01JQl9TRUwoUlhfSFNfRzJfUFJFUF9MRU5HVEhfQ0FQLCBpKSwKKwkJCQlh
dHRyLT5yeF9oc19nMl9wcmVwX3N5bmNfbGVuX2NhcCk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwK
KwkJCQlVSUNfQVJHX01JQl9TRUwoUlhfSFNfRzNfUFJFUF9MRU5HVEhfQ0FQLCBpKSwKKwkJCQlh
dHRyLT5yeF9oc19nM19wcmVwX3N5bmNfbGVuX2NhcCk7CisJfQorCisJaWYgKGF0dHItPnJ4X2Fk
dl9maW5lX2dyYW5fc3VwX2VuID09IDApIHsKKwkJZm9yX2VhY2hfdWZzX3J4X2xhbmUodWZzLCBp
KSB7CisJCQl1ZnNoY2RfZG1lX3NldChoYmEsCisJCQkJVUlDX0FSR19NSUJfU0VMKFJYX0FEVl9H
UkFOVUxBUklUWV9DQVAsIGkpLCAwKTsKKworCQkJaWYgKGF0dHItPnJ4X21pbl9hY3R2X3RpbWVf
Y2FwKQorCQkJCXVmc2hjZF9kbWVfc2V0KGhiYSwKKwkJCQkJVUlDX0FSR19NSUJfU0VMKFJYX01J
Tl9BQ1RJVkFURVRJTUVfQ0FQLAorCQkJCQkJaSksIGF0dHItPnJ4X21pbl9hY3R2X3RpbWVfY2Fw
KTsKKworCQkJaWYgKGF0dHItPnJ4X2hpYmVybjhfdGltZV9jYXApCisJCQkJdWZzaGNkX2RtZV9z
ZXQoaGJhLAorCQkJCQlVSUNfQVJHX01JQl9TRUwoUlhfSElCRVJOOFRJTUVfQ0FQLCBpKSwKKwkJ
CQkJCWF0dHItPnJ4X2hpYmVybjhfdGltZV9jYXApOworCQl9CisJfSBlbHNlIGlmIChhdHRyLT5y
eF9hZHZfZmluZV9ncmFuX3N1cF9lbiA9PSAxKSB7CisJCWZvcl9lYWNoX3Vmc19yeF9sYW5lKHVm
cywgaSkgeworCQkJaWYgKGF0dHItPnJ4X2Fkdl9maW5lX2dyYW5fc3RlcCkKKwkJCQl1ZnNoY2Rf
ZG1lX3NldChoYmEsCisJCQkJCVVJQ19BUkdfTUlCX1NFTChSWF9BRFZfR1JBTlVMQVJJVFlfQ0FQ
LAorCQkJCQkJaSksIFJYX0FEVl9GSU5FX0dSQU5fU1RFUCgKKwkJCQkJCWF0dHItPnJ4X2Fkdl9m
aW5lX2dyYW5fc3RlcCkpOworCisJCQlpZiAoYXR0ci0+cnhfYWR2X21pbl9hY3R2X3RpbWVfY2Fw
KQorCQkJCXVmc2hjZF9kbWVfc2V0KGhiYSwKKwkJCQkJVUlDX0FSR19NSUJfU0VMKAorCQkJCQkJ
UlhfQURWX01JTl9BQ1RJVkFURVRJTUVfQ0FQLCBpKSwKKwkJCQkJCWF0dHItPnJ4X2Fkdl9taW5f
YWN0dl90aW1lX2NhcCk7CisKKwkJCWlmIChhdHRyLT5yeF9hZHZfaGliZXJuOF90aW1lX2NhcCkK
KwkJCQl1ZnNoY2RfZG1lX3NldChoYmEsCisJCQkJCVVJQ19BUkdfTUlCX1NFTChSWF9BRFZfSElC
RVJOOFRJTUVfQ0FQLAorCQkJCQkJaSksCisJCQkJCQlhdHRyLT5yeF9hZHZfaGliZXJuOF90aW1l
X2NhcCk7CisJCX0KKwl9CisKKwlleHlub3NfdWZzX2Rpc2FibGVfb3ZfdG0oaGJhKTsKK30KKwor
c3RhdGljIHZvaWQgZXh5bm9zX3Vmc19lc3RhYmxpc2hfY29ubnQoc3RydWN0IGV4eW5vc191ZnMg
KnVmcykKK3sKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJhID0gdWZzLT5oYmE7CisJZW51bSB7CisJCURF
Vl9JRAkJPSAweDAwLAorCQlQRUVSX0RFVl9JRAk9IDB4MDEsCisJCVBFRVJfQ1BPUlRfSUQJPSAw
eDAwLAorCQlUUkFGRklDX0NMQVNTCT0gMHgwMCwKKwl9OworCisJLyogYWxsb3cgY3BvcnQgYXR0
cmlidXRlcyB0byBiZSBzZXQgKi8KKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFRf
Q09OTkVDVElPTlNUQVRFKSwgQ1BPUlRfSURMRSk7CisKKwkvKiBsb2NhbCB1bmlwcm8gYXR0cmli
dXRlcyAqLworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoTl9ERVZJQ0VJRCksIERF
Vl9JRCk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihOX0RFVklDRUlEX1ZBTElE
KSwgVFJVRSk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihUX1BFRVJERVZJQ0VJ
RCksIFBFRVJfREVWX0lEKTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFRfUEVF
UkNQT1JUSUQpLCBQRUVSX0NQT1JUX0lEKTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdf
TUlCKFRfQ1BPUlRGTEFHUyksIENQT1JUX0RFRl9GTEFHUyk7CisJdWZzaGNkX2RtZV9zZXQoaGJh
LCBVSUNfQVJHX01JQihUX1RSQUZGSUNDTEFTUyksIFRSQUZGSUNfQ0xBU1MpOworCXVmc2hjZF9k
bWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoVF9DT05ORUNUSU9OU1RBVEUpLCBDUE9SVF9DT05ORUNU
RUQpOworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX2NvbmZpZ19zbXUoc3RydWN0IGV4eW5v
c191ZnMgKnVmcykKK3sKKwl1MzIgcmVnLCB2YWw7CisKKwlleHlub3NfdWZzX2Rpc2FibGVfYXV0
b19jdHJsX2hjY19zYXZlKHVmcywgJnZhbCk7CisKKwkvKiBtYWtlIGVuY3J5cHRpb24gZGlzYWJs
ZWQgYnkgZGVmYXVsdCAqLworCXJlZyA9IHVmc3BfcmVhZGwodWZzLCBVRlNQUlNFQ1VSSVRZKTsK
Kwl1ZnNwX3dyaXRlbCh1ZnMsIHJlZyB8IE5TU01VLCBVRlNQUlNFQ1VSSVRZKTsKKwl1ZnNwX3dy
aXRlbCh1ZnMsIDB4MCwgVUZTUFNCRUdJTjApOworCXVmc3Bfd3JpdGVsKHVmcywgMHhmZmZmZmZm
ZiwgVUZTUFNFTkQwKTsKKwl1ZnNwX3dyaXRlbCh1ZnMsIDB4ZmYsIFVGU1BTTFVOMCk7CisJdWZz
cF93cml0ZWwodWZzLCAweGYxLCBVRlNQU0NUUkwwKTsKKworCWV4eW5vc191ZnNfYXV0b19jdHJs
X2hjY19yZXN0b3JlKHVmcywgJnZhbCk7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfY29u
ZmlnX3N5bmNfcGF0dGVybl9tYXNrKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsCisJCQkJCXN0cnVj
dCB1ZnNfcGFfbGF5ZXJfYXR0ciAqcHdyKQoreworCXN0cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMt
PmhiYTsKKwl1OCBnID0gbWF4X3QodTMyLCBwd3ItPmdlYXJfcngsIHB3ci0+Z2Vhcl90eCk7CisJ
dTMyIG1hc2ssIHN5bmNfbGVuOworCWVudW0geworCQlTWU5DX0xFTl9HMSA9IDgwICogMTAwMCwg
LyogODB1cyAqLworCQlTWU5DX0xFTl9HMiA9IDQwICogMTAwMCwgLyogNDR1cyAqLworCQlTWU5D
X0xFTl9HMyA9IDIwICogMTAwMCwgLyogMjB1cyAqLworCX07CisJaW50IGk7CisKKwlpZiAoZyA9
PSAxKQorCQlzeW5jX2xlbiA9IFNZTkNfTEVOX0cxOworCWVsc2UgaWYgKGcgPT0gMikKKwkJc3lu
Y19sZW4gPSBTWU5DX0xFTl9HMjsKKwllbHNlIGlmIChnID09IDMpCisJCXN5bmNfbGVuID0gU1lO
Q19MRU5fRzM7CisJZWxzZQorCQlyZXR1cm47CisKKwltYXNrID0gZXh5bm9zX3Vmc19jYWxjX3Rp
bWVfY250cih1ZnMsIHN5bmNfbGVuKTsKKwltYXNrID0gKG1hc2sgPj4gOCkgJiAweGZmOworCisJ
ZXh5bm9zX3Vmc19lbmFibGVfb3ZfdG0oaGJhKTsKKworCWZvcl9lYWNoX3Vmc19yeF9sYW5lKHVm
cywgaSkKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLAorCQkJVUlDX0FSR19NSUJfU0VMKFJYX1NZTkNf
TUFTS19MRU5HVEgsIGkpLCBtYXNrKTsKKworCWV4eW5vc191ZnNfZGlzYWJsZV9vdl90bShoYmEp
OworfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfcHJlX3B3cl9tb2RlKHN0cnVjdCB1ZnNfaGJh
ICpoYmEsCisJCQkJc3RydWN0IHVmc19wYV9sYXllcl9hdHRyICpkZXZfbWF4X3BhcmFtcywKKwkJ
CQlzdHJ1Y3QgdWZzX3BhX2xheWVyX2F0dHIgKmRldl9yZXFfcGFyYW1zKQoreworCXN0cnVjdCBl
eHlub3NfdWZzICp1ZnMgPSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKwlzdHJ1Y3QgcGh5ICpn
ZW5lcmljX3BoeSA9IHVmcy0+cGh5OworCXN0cnVjdCB1ZnNfZGV2X3BhcmFtcyB1ZnNfZXh5bm9z
X2NhcDsKKwlpbnQgcmV0OworCisJaWYgKCFkZXZfcmVxX3BhcmFtcykgeworCQlwcl9lcnIoIiVz
OiBpbmNvbWluZyBkZXZfcmVxX3BhcmFtcyBpcyBOVUxMXG4iLCBfX2Z1bmNfXyk7CisJCXJldCA9
IC1FSU5WQUw7CisJCWdvdG8gb3V0OworCX0KKworCisJdWZzX2V4eW5vc19jYXAudHhfbGFuZXMg
PSBVRlNfRVhZTk9TX0xJTUlUX05VTV9MQU5FU19UWDsKKwl1ZnNfZXh5bm9zX2NhcC5yeF9sYW5l
cyA9IFVGU19FWFlOT1NfTElNSVRfTlVNX0xBTkVTX1JYOworCXVmc19leHlub3NfY2FwLmhzX3J4
X2dlYXIgPSBVRlNfRVhZTk9TX0xJTUlUX0hTR0VBUl9SWDsKKwl1ZnNfZXh5bm9zX2NhcC5oc190
eF9nZWFyID0gVUZTX0VYWU5PU19MSU1JVF9IU0dFQVJfVFg7CisJdWZzX2V4eW5vc19jYXAucHdt
X3J4X2dlYXIgPSBVRlNfRVhZTk9TX0xJTUlUX1BXTUdFQVJfUlg7CisJdWZzX2V4eW5vc19jYXAu
cHdtX3R4X2dlYXIgPSBVRlNfRVhZTk9TX0xJTUlUX1BXTUdFQVJfVFg7CisJdWZzX2V4eW5vc19j
YXAucnhfcHdyX3B3bSA9IFVGU19FWFlOT1NfTElNSVRfUlhfUFdSX1BXTTsKKwl1ZnNfZXh5bm9z
X2NhcC50eF9wd3JfcHdtID0gVUZTX0VYWU5PU19MSU1JVF9UWF9QV1JfUFdNOworCXVmc19leHlu
b3NfY2FwLnJ4X3B3cl9ocyA9IFVGU19FWFlOT1NfTElNSVRfUlhfUFdSX0hTOworCXVmc19leHlu
b3NfY2FwLnR4X3B3cl9ocyA9IFVGU19FWFlOT1NfTElNSVRfVFhfUFdSX0hTOworCXVmc19leHlu
b3NfY2FwLmhzX3JhdGUgPSBVRlNfRVhZTk9TX0xJTUlUX0hTX1JBVEU7CisJdWZzX2V4eW5vc19j
YXAuZGVzaXJlZF93b3JraW5nX21vZGUgPQorCQkJCVVGU19FWFlOT1NfTElNSVRfREVTSVJFRF9N
T0RFOworCisJcmV0ID0gdWZzaGNkX2dldF9wd3JfZGV2X3BhcmFtKCZ1ZnNfZXh5bm9zX2NhcCwK
KwkJCQkgICAgICAgZGV2X21heF9wYXJhbXMsIGRldl9yZXFfcGFyYW1zKTsKKwlpZiAocmV0KSB7
CisJCXByX2VycigiJXM6IGZhaWxlZCB0byBkZXRlcm1pbmUgY2FwYWJpbGl0aWVzXG4iLCBfX2Z1
bmNfXyk7CisJCWdvdG8gb3V0OworCX0KKworCWlmICh1ZnMtPmRydl9kYXRhLT5wcmVfcHdyX2No
YW5nZSkKKwkJdWZzLT5kcnZfZGF0YS0+cHJlX3B3cl9jaGFuZ2UodWZzLCBkZXZfcmVxX3BhcmFt
cyk7CisKKwlpZiAodWZzaGNkX2lzX2hzX21vZGUoZGV2X3JlcV9wYXJhbXMpKSB7CisJCWV4eW5v
c191ZnNfY29uZmlnX3N5bmNfcGF0dGVybl9tYXNrKHVmcywgZGV2X3JlcV9wYXJhbXMpOworCisJ
CXN3aXRjaCAoZGV2X3JlcV9wYXJhbXMtPmhzX3JhdGUpIHsKKwkJY2FzZSBQQV9IU19NT0RFX0E6
CisJCWNhc2UgUEFfSFNfTU9ERV9COgorCQkJcGh5X2NhbGlicmF0ZShnZW5lcmljX3BoeSk7CisJ
CQlicmVhazsKKwkJfQorCX0KKworCXJldHVybiAwOworb3V0OgorCXJldHVybiByZXQ7Cit9CisK
KyNkZWZpbmUgUFdSX01PREVfU1RSX0xFTgk2NAorc3RhdGljIGludCBleHlub3NfdWZzX3Bvc3Rf
cHdyX21vZGUoc3RydWN0IHVmc19oYmEgKmhiYSwKKwkJCQlzdHJ1Y3QgdWZzX3BhX2xheWVyX2F0
dHIgKnB3cl9tYXgsCisJCQkJc3RydWN0IHVmc19wYV9sYXllcl9hdHRyICpwd3JfcmVxKQorewor
CXN0cnVjdCBleHlub3NfdWZzICp1ZnMgPSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKwlzdHJ1
Y3QgcGh5ICpnZW5lcmljX3BoeSA9IHVmcy0+cGh5OworCWludCBnZWFyID0gbWF4X3QodTMyLCBw
d3JfcmVxLT5nZWFyX3J4LCBwd3JfcmVxLT5nZWFyX3R4KTsKKwlpbnQgbGFuZXMgPSBtYXhfdCh1
MzIsIHB3cl9yZXEtPmxhbmVfcngsIHB3cl9yZXEtPmxhbmVfdHgpOworCWNoYXIgcHdyX3N0cltQ
V1JfTU9ERV9TVFJfTEVOXSA9ICIiOworCisJLyogbGV0IGRlZmF1bHQgYmUgUFdNIEdlYXIgMSwg
TGFuZSAxICovCisJaWYgKCFnZWFyKQorCQlnZWFyID0gMTsKKworCWlmICghbGFuZXMpCisJCWxh
bmVzID0gMTsKKworCWlmICh1ZnMtPmRydl9kYXRhLT5wb3N0X3B3cl9jaGFuZ2UpCisJCXVmcy0+
ZHJ2X2RhdGEtPnBvc3RfcHdyX2NoYW5nZSh1ZnMsIHB3cl9yZXEpOworCisJaWYgKCh1ZnNoY2Rf
aXNfaHNfbW9kZShwd3JfcmVxKSkpIHsKKwkJc3dpdGNoIChwd3JfcmVxLT5oc19yYXRlKSB7CisJ
CWNhc2UgUEFfSFNfTU9ERV9BOgorCQljYXNlIFBBX0hTX01PREVfQjoKKwkJCXBoeV9jYWxpYnJh
dGUoZ2VuZXJpY19waHkpOworCQkJYnJlYWs7CisJCX0KKworCQlzbnByaW50Zihwd3Jfc3RyLCBQ
V1JfTU9ERV9TVFJfTEVOLCAiJXMgc2VyaWVzXyVzIEdfJWQgTF8lZCIsCisJCQkiRkFTVCIsCXB3
cl9yZXEtPmhzX3JhdGUgPT0gUEFfSFNfTU9ERV9BID8gIkEiIDogIkIiLAorCQkJZ2VhciwgbGFu
ZXMpOworCX0gZWxzZSB7CisJCXNucHJpbnRmKHB3cl9zdHIsIFBXUl9NT0RFX1NUUl9MRU4sICIl
cyBHXyVkIExfJWQiLAorCQkJIlNMT1ciLCBnZWFyLCBsYW5lcyk7CisJfQorCisJZGV2X2luZm8o
aGJhLT5kZXYsICJQb3dlciBtb2RlIGNoYW5nZWQgdG8gOiAlc1xuIiwgcHdyX3N0cik7CisKKwly
ZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19zcGVjaWZ5X25leHVzX3RfeGZl
cl9yZXEoc3RydWN0IHVmc19oYmEgKmhiYSwKKwkJCQkJCWludCB0YWcsIGJvb2wgb3ApCit7CisJ
c3RydWN0IGV4eW5vc191ZnMgKnVmcyA9IHVmc2hjZF9nZXRfdmFyaWFudChoYmEpOworCXUzMiB0
eXBlOworCisJdHlwZSA9ICBoY2lfcmVhZGwodWZzLCBIQ0lfVVRSTF9ORVhVU19UWVBFKTsKKwor
CWlmIChvcCkKKwkJaGNpX3dyaXRlbCh1ZnMsIHR5cGUgfCAoMSA8PCB0YWcpLCBIQ0lfVVRSTF9O
RVhVU19UWVBFKTsKKwllbHNlCisJCWhjaV93cml0ZWwodWZzLCB0eXBlICYgfigxIDw8IHRhZyks
IEhDSV9VVFJMX05FWFVTX1RZUEUpOworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX3NwZWNp
ZnlfbmV4dXNfdF90bV9yZXEoc3RydWN0IHVmc19oYmEgKmhiYSwKKwkJCQkJCWludCB0YWcsIHU4
IGZ1bmMpCit7CisJc3RydWN0IGV4eW5vc191ZnMgKnVmcyA9IHVmc2hjZF9nZXRfdmFyaWFudCho
YmEpOworCXUzMiB0eXBlOworCisJdHlwZSA9ICBoY2lfcmVhZGwodWZzLCBIQ0lfVVRNUkxfTkVY
VVNfVFlQRSk7CisKKwlzd2l0Y2ggKGZ1bmMpIHsKKwljYXNlIFVGU19BQk9SVF9UQVNLOgorCWNh
c2UgVUZTX1FVRVJZX1RBU0s6CisJCWhjaV93cml0ZWwodWZzLCB0eXBlIHwgKDEgPDwgdGFnKSwg
SENJX1VUTVJMX05FWFVTX1RZUEUpOworCQlicmVhazsKKwljYXNlIFVGU19BQk9SVF9UQVNLX1NF
VDoKKwljYXNlIFVGU19DTEVBUl9UQVNLX1NFVDoKKwljYXNlIFVGU19MT0dJQ0FMX1JFU0VUOgor
CWNhc2UgVUZTX1FVRVJZX1RBU0tfU0VUOgorCQloY2lfd3JpdGVsKHVmcywgdHlwZSAmIH4oMSA8
PCB0YWcpLCBIQ0lfVVRNUkxfTkVYVVNfVFlQRSk7CisJCWJyZWFrOworCX0KK30KKworc3RhdGlj
IHZvaWQgZXh5bm9zX3Vmc19waHlfaW5pdChzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCXN0
cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMtPmhiYTsKKwlzdHJ1Y3QgcGh5ICpnZW5lcmljX3BoeSA9
IHVmcy0+cGh5OworCisJaWYgKHVmcy0+YXZhaWxfbG5fcnggPT0gMCB8fCB1ZnMtPmF2YWlsX2xu
X3R4ID09IDApIHsKKwkJdWZzaGNkX2RtZV9nZXQoaGJhLCBVSUNfQVJHX01JQihQQV9BVkFJTFJY
REFUQUxBTkVTKSwKKwkJCSZ1ZnMtPmF2YWlsX2xuX3J4KTsKKwkJdWZzaGNkX2RtZV9nZXQoaGJh
LCBVSUNfQVJHX01JQihQQV9BVkFJTFRYREFUQUxBTkVTKSwKKwkJCSZ1ZnMtPmF2YWlsX2xuX3R4
KTsKKwkJV0FSTih1ZnMtPmF2YWlsX2xuX3J4ICE9IHVmcy0+YXZhaWxfbG5fdHgsCisJCQkiYXZh
aWxhYmxlIGRhdGEgbGFuZSBpcyBub3QgZXF1YWwocng6JWQsIHR4OiVkKVxuIiwKKwkJCXVmcy0+
YXZhaWxfbG5fcngsIHVmcy0+YXZhaWxfbG5fdHgpOworCX0KKworCXBoeV9zZXRfYnVzX3dpZHRo
KGdlbmVyaWNfcGh5LCB1ZnMtPmF2YWlsX2xuX3J4KTsKKwlwaHlfaW5pdChnZW5lcmljX3BoeSk7
Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfY29uZmlnX3VuaXBybyhzdHJ1Y3QgZXh5bm9z
X3VmcyAqdWZzKQoreworCXN0cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMtPmhiYTsKKworCXVmc2hj
ZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoUEFfREJHX0NMS19QRVJJT0QpLAorCQlESVZfUk9V
TkRfVVAoTlNFQ19QRVJfU0VDLCB1ZnMtPm1jbGtfcmF0ZSkpOworCXVmc2hjZF9kbWVfc2V0KGhi
YSwgVUlDX0FSR19NSUIoUEFfVFhUUkFJTElOR0NMT0NLUyksCisJCQl1ZnMtPmRydl9kYXRhLT51
aWNfYXR0ci0+dHhfdHJhaWxpbmdjbGtzKTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdf
TUlCKFBBX0RCR19PUFRJT05fU1VJVEUpLAorCQkJdWZzLT5kcnZfZGF0YS0+dWljX2F0dHItPnBh
X2RiZ19vcHRpb25fc3VpdGUpOworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX2NvbmZpZ19p
bnRyKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsIHUzMiBlcnJzLCB1OCBpbmRleCkKK3sKKwlzd2l0
Y2ggKGluZGV4KSB7CisJY2FzZSBVTklQUk9fTDFfNToKKwkJaGNpX3dyaXRlbCh1ZnMsIERGRVNf
RVJSX0VOIHwgZXJycywgSENJX0VSUl9FTl9QQV9MQVlFUik7CisJCWJyZWFrOworCWNhc2UgVU5J
UFJPX0wyOgorCQloY2lfd3JpdGVsKHVmcywgREZFU19FUlJfRU4gfCBlcnJzLCBIQ0lfRVJSX0VO
X0RMX0xBWUVSKTsKKwkJYnJlYWs7CisJY2FzZSBVTklQUk9fTDM6CisJCWhjaV93cml0ZWwodWZz
LCBERkVTX0VSUl9FTiB8IGVycnMsIEhDSV9FUlJfRU5fTl9MQVlFUik7CisJCWJyZWFrOworCWNh
c2UgVU5JUFJPX0w0OgorCQloY2lfd3JpdGVsKHVmcywgREZFU19FUlJfRU4gfCBlcnJzLCBIQ0lf
RVJSX0VOX1RfTEFZRVIpOworCQlicmVhazsKKwljYXNlIFVOSVBST19ETUU6CisJCWhjaV93cml0
ZWwodWZzLCBERkVTX0VSUl9FTiB8IGVycnMsIEhDSV9FUlJfRU5fRE1FX0xBWUVSKTsKKwkJYnJl
YWs7CisJfQorfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfcHJlX2xpbmsoc3RydWN0IHVmc19o
YmEgKmhiYSkKK3sKKwlzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzID0gdWZzaGNkX2dldF92YXJpYW50
KGhiYSk7CisKKwkvKiBoY2kgKi8KKwlleHlub3NfdWZzX2NvbmZpZ19pbnRyKHVmcywgREZFU19E
RUZfTDJfRVJSUywgVU5JUFJPX0wyKTsKKwlleHlub3NfdWZzX2NvbmZpZ19pbnRyKHVmcywgREZF
U19ERUZfTDNfRVJSUywgVU5JUFJPX0wzKTsKKwlleHlub3NfdWZzX2NvbmZpZ19pbnRyKHVmcywg
REZFU19ERUZfTDRfRVJSUywgVU5JUFJPX0w0KTsKKwlleHlub3NfdWZzX3NldF91bmlwcm9fcGNs
a19kaXYodWZzKTsKKworCS8qIHVuaXBybyAqLworCWV4eW5vc191ZnNfY29uZmlnX3VuaXBybyh1
ZnMpOworCisJLyogbS1waHkgKi8KKwlleHlub3NfdWZzX3BoeV9pbml0KHVmcyk7CisJZXh5bm9z
X3Vmc19jb25maWdfcGh5X3RpbWVfYXR0cih1ZnMpOworCWV4eW5vc191ZnNfY29uZmlnX3BoeV9j
YXBfYXR0cih1ZnMpOworCisJaWYgKHVmcy0+ZHJ2X2RhdGEtPnByZV9saW5rKQorCQl1ZnMtPmRy
dl9kYXRhLT5wcmVfbGluayh1ZnMpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGV4
eW5vc191ZnNfZml0X2FnZ3JfdGltZW91dChzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCXUz
MiB2YWw7CisKKwl2YWwgPSBleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgSUFUT1ZBTF9O
U0VDIC8gQ05UUl9ESVZfVkFMKTsKKwloY2lfd3JpdGVsKHVmcywgdmFsICYgQ05UX1ZBTF8xVVNf
TUFTSywgSENJXzFVU19UT19DTlRfVkFMKTsKK30KKworc3RhdGljIGludCBleHlub3NfdWZzX3Bv
c3RfbGluayhzdHJ1Y3QgdWZzX2hiYSAqaGJhKQoreworCXN0cnVjdCBleHlub3NfdWZzICp1ZnMg
PSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKwlzdHJ1Y3QgcGh5ICpnZW5lcmljX3BoeSA9IHVm
cy0+cGh5OworCXN0cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICphdHRyID0gdWZzLT5kcnZfZGF0
YS0+dWljX2F0dHI7CisKKwlleHlub3NfdWZzX2VzdGFibGlzaF9jb25udCh1ZnMpOworCWV4eW5v
c191ZnNfZml0X2FnZ3JfdGltZW91dCh1ZnMpOworCisJaGNpX3dyaXRlbCh1ZnMsIDB4YSwgSENJ
X0RBVEFfUkVPUkRFUik7CisJaGNpX3dyaXRlbCh1ZnMsIFBSRFRfU0VUX1NJWkUoMTIpLCBIQ0lf
VFhQUkRUX0VOVFJZX1NJWkUpOworCWhjaV93cml0ZWwodWZzLCBQUkRUX1NFVF9TSVpFKDEyKSwg
SENJX1JYUFJEVF9FTlRSWV9TSVpFKTsKKwloY2lfd3JpdGVsKHVmcywgKDEgPDwgaGJhLT5udXRy
cykgLSAxLCBIQ0lfVVRSTF9ORVhVU19UWVBFKTsKKwloY2lfd3JpdGVsKHVmcywgKDEgPDwgaGJh
LT5udXRtcnMpIC0gMSwgSENJX1VUTVJMX05FWFVTX1RZUEUpOworCWhjaV93cml0ZWwodWZzLCAw
eGYsIEhDSV9BWElETUFfUldEQVRBX0JVUlNUX0xFTik7CisKKwlpZiAodWZzLT5vcHRzICYgRVhZ
Tk9TX1VGU19PUFRfU0tJUF9DT05ORUNUSU9OX0VTVEFCKQorCQl1ZnNoY2RfZG1lX3NldChoYmEs
CisJCQlVSUNfQVJHX01JQihUX0RCR19TS0lQX0lOSVRfSElCRVJOOF9FWElUKSwgVFJVRSk7CisK
KwlpZiAoYXR0ci0+cGFfZ3JhbnVsYXJpdHkpIHsKKwkJZXh5bm9zX3Vmc19lbmFibGVfZGJnX21v
ZGUoaGJhKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9HUkFOVUxBUklU
WSksCisJCQkJYXR0ci0+cGFfZ3JhbnVsYXJpdHkpOworCQlleHlub3NfdWZzX2Rpc2FibGVfZGJn
X21vZGUoaGJhKTsKKworCQlpZiAoYXR0ci0+cGFfdGFjdGl2YXRlKQorCQkJdWZzaGNkX2RtZV9z
ZXQoaGJhLCBVSUNfQVJHX01JQihQQV9UQUNUSVZBVEUpLAorCQkJCQlhdHRyLT5wYV90YWN0aXZh
dGUpOworCQlpZiAoYXR0ci0+cGFfaGliZXJuOHRpbWUgJiYKKwkJICAgICEodWZzLT5vcHRzICYg
RVhZTk9TX1VGU19PUFRfVVNFX1NXX0hJQkVSTjhfVElNRVIpKQorCQkJdWZzaGNkX2RtZV9zZXQo
aGJhLCBVSUNfQVJHX01JQihQQV9ISUJFUk44VElNRSksCisJCQkJCWF0dHItPnBhX2hpYmVybjh0
aW1lKTsKKwl9CisKKwlpZiAodWZzLT5vcHRzICYgRVhZTk9TX1VGU19PUFRfVVNFX1NXX0hJQkVS
TjhfVElNRVIpIHsKKwkJaWYgKCFhdHRyLT5wYV9ncmFudWxhcml0eSkKKwkJCXVmc2hjZF9kbWVf
Z2V0KGhiYSwgVUlDX0FSR19NSUIoUEFfR1JBTlVMQVJJVFkpLAorCQkJCQkmYXR0ci0+cGFfZ3Jh
bnVsYXJpdHkpOworCQlpZiAoIWF0dHItPnBhX2hpYmVybjh0aW1lKQorCQkJdWZzaGNkX2RtZV9n
ZXQoaGJhLCBVSUNfQVJHX01JQihQQV9ISUJFUk44VElNRSksCisJCQkJCSZhdHRyLT5wYV9oaWJl
cm44dGltZSk7CisJCS8qCisJCSAqIG5vdCB3YWl0IGZvciBISUJFUk44IHRpbWUgdG8gZXhpdCBo
aWJlcm5hdGlvbgorCQkgKi8KKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9I
SUJFUk44VElNRSksIDApOworCisJCWlmIChhdHRyLT5wYV9ncmFudWxhcml0eSA8IDEgfHwgYXR0
ci0+cGFfZ3JhbnVsYXJpdHkgPiA2KSB7CisJCQkvKiBWYWxpZCByYW5nZSBmb3IgZ3JhbnVsYXJp
dHk6IDEgfiA2ICovCisJCQlkZXZfd2FybihoYmEtPmRldiwKKwkJCQkiJXM6IHBhX2dyYW51bGFy
dHkgJWQgaXMgaW52YWxpZCwgYXNzdW1pbmcgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcbiIsCisJ
CQkJX19mdW5jX18sCisJCQkJYXR0ci0+cGFfZ3JhbnVsYXJpdHkpOworCQkJYXR0ci0+cGFfZ3Jh
bnVsYXJpdHkgPSA2OworCQl9CisJfQorCisJcGh5X2NhbGlicmF0ZShnZW5lcmljX3BoeSk7CisK
KwlpZiAodWZzLT5kcnZfZGF0YS0+cG9zdF9saW5rKQorCQl1ZnMtPmRydl9kYXRhLT5wb3N0X2xp
bmsodWZzKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfcGFyc2Vf
ZHQoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAgPSBkZXYtPm9mX25vZGU7CisJc3RydWN0IGV4eW5vc191ZnNfZHJ2
X2RhdGEgKmRydl9kYXRhID0gJmV4eW5vc191ZnNfZHJ2czsKKwlzdHJ1Y3QgZXh5bm9zX3Vmc191
aWNfYXR0ciAqYXR0cjsKKwl1MzIgZnJlcVsyXTsKKwlpbnQgcmV0OworCisJd2hpbGUgKGRydl9k
YXRhLT5jb21wYXRpYmxlKSB7CisJCWlmIChvZl9kZXZpY2VfaXNfY29tcGF0aWJsZShucCwgZHJ2
X2RhdGEtPmNvbXBhdGlibGUpKSB7CisJCQl1ZnMtPmRydl9kYXRhID0gZHJ2X2RhdGE7CisJCQli
cmVhazsKKwkJfQorCQlkcnZfZGF0YSsrOworCX0KKworCWlmICh1ZnMtPmRydl9kYXRhICYmIHVm
cy0+ZHJ2X2RhdGEtPnVpY19hdHRyKSB7CisJCWF0dHIgPSB1ZnMtPmRydl9kYXRhLT51aWNfYXR0
cjsKKwl9IGVsc2UgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBnZXQgdWljIGF0dHJpYnV0
ZXNcbiIpOworCQlyZXQgPSAtRUlOVkFMOworCQlnb3RvIG91dDsKKwl9CisKKwlyZXQgPSBvZl9w
cm9wZXJ0eV9yZWFkX3UzMl9hcnJheShucCwKKwkJCSJwY2xrLWZyZXEtYXZhaWwtcmFuZ2UiLCBm
cmVxLCBBUlJBWV9TSVpFKGZyZXEpKTsKKwlpZiAoIXJldCkgeworCQl1ZnMtPnBjbGtfYXZhaWxf
bWluID0gZnJlcVswXTsKKwkJdWZzLT5wY2xrX2F2YWlsX21heCA9IGZyZXFbMV07CisJfSBlbHNl
IHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gZ2V0IGF2YWlsYWJsZSBwY2xrIHJhbmdlXG4i
KTsKKwkJZ290byBvdXQ7CisJfQorCisJYXR0ci0+cnhfYWR2X2ZpbmVfZ3Jhbl9zdXBfZW4gPSBS
WF9BRFZfRklORV9HUkFOX1NVUF9FTjsKKwlhdHRyLT5yeF9hZHZfZmluZV9ncmFuX3N0ZXAgPSBS
WF9BRFZfRklORV9HUkFOX1NURVBfVkFMOworCWF0dHItPnJ4X2Fkdl9taW5fYWN0dl90aW1lX2Nh
cCA9IFJYX0FEVl9NSU5fQUNUVl9USU1FX0NBUDsKKwlhdHRyLT5wYV9ncmFudWxhcml0eSA9IFBB
X0dSQU5VTEFSSVRZX1ZBTDsKKwlhdHRyLT5wYV90YWN0aXZhdGUgPSBQQV9UQUNUSVZBVEVfVkFM
OworCWF0dHItPnBhX2hpYmVybjh0aW1lID0gUEFfSElCRVJOOFRJTUVfVkFMOworCitvdXQ6CisJ
cmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBleHlub3NfdWZzX2luaXQoc3RydWN0IHVmc19o
YmEgKmhiYSkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBoYmEtPmRldjsKKwlzdHJ1Y3QgcGxh
dGZvcm1fZGV2aWNlICpwZGV2ID0gdG9fcGxhdGZvcm1fZGV2aWNlKGRldik7CisJc3RydWN0IGV4
eW5vc191ZnMgKnVmczsKKwlzdHJ1Y3QgcmVzb3VyY2UgKnJlczsKKwlpbnQgcmV0OworCisJdWZz
ID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCp1ZnMpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXVm
cykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwkvKiBleHlub3Mtc3BlY2lmaWMgaGNpICovCisJcmVz
ID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNlX2J5bmFtZShwZGV2LCBJT1JFU09VUkNFX01FTSwgInZz
X2hjaSIpOworCXVmcy0+cmVnX2hjaSA9IGRldm1faW9yZW1hcF9yZXNvdXJjZShkZXYsIHJlcyk7
CisJaWYgKCF1ZnMtPnJlZ19oY2kpIHsKKwkJZGV2X2VycihkZXYsICJjYW5ub3QgaW9yZW1hcCBm
b3IgaGNpIHZlbmRvciByZWdpc3RlclxuIik7CisJCXJldHVybiAtRU5PTUVNOworCX0KKworCS8q
IHVuaXBybyAqLworCXJlcyA9IHBsYXRmb3JtX2dldF9yZXNvdXJjZV9ieW5hbWUocGRldiwgSU9S
RVNPVVJDRV9NRU0sICJ1bmlwcm8iKTsKKwl1ZnMtPnJlZ191bmlwcm8gPSBkZXZtX2lvcmVtYXBf
cmVzb3VyY2UoZGV2LCByZXMpOworCWlmICghdWZzLT5yZWdfdW5pcHJvKSB7CisJCWRldl9lcnIo
ZGV2LCAiY2Fubm90IGlvcmVtYXAgZm9yIHVuaXBybyByZWdpc3RlclxuIik7CisJCXJldHVybiAt
RU5PTUVNOworCX0KKworCS8qIHVmcyBwcm90ZWN0b3IgKi8KKwlyZXMgPSBwbGF0Zm9ybV9nZXRf
cmVzb3VyY2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAidWZzcCIpOworCXVmcy0+cmVn
X3Vmc3AgPSBkZXZtX2lvcmVtYXBfcmVzb3VyY2UoZGV2LCByZXMpOworCWlmICghdWZzLT5yZWdf
dWZzcCkgeworCQlkZXZfZXJyKGRldiwgImNhbm5vdCBpb3JlbWFwIGZvciB1ZnMgcHJvdGVjdG9y
IHJlZ2lzdGVyXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJcmV0ID0gZXh5bm9zX3Vm
c19wYXJzZV9kdChkZXYsIHVmcyk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRldiwgImZhaWxl
ZCB0byBnZXQgZHQgaW5mby5cbiIpOworCQlnb3RvIG91dDsKKwl9CisKKwl1ZnMtPnBoeSA9IGRl
dm1fcGh5X2dldChkZXYsICJ1ZnMtcGh5Iik7CisJaWYgKElTX0VSUih1ZnMtPnBoeSkpIHsKKwkJ
cmV0ID0gUFRSX0VSUih1ZnMtPnBoeSk7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGdldCB1
ZnMtcGh5XG4iKTsKKwkJZ290byBvdXQ7CisJfQorCisJcmV0ID0gcGh5X3Bvd2VyX29uKHVmcy0+
cGh5KTsKKwlpZiAocmV0KQorCQlnb3RvIHBoeV9leGl0OworCisJdWZzLT5oYmEgPSBoYmE7CisJ
dWZzLT5vcHRzID0gdWZzLT5kcnZfZGF0YS0+b3B0cyB8CisJCUVYWU5PU19VRlNfT1BUX1NLSVBf
Q09OTkVDVElPTl9FU1RBQiB8CisJCUVYWU5PU19VRlNfT1BUX1VTRV9TV19ISUJFUk44X1RJTUVS
OworCXVmcy0+cnhfc2VsX2lkeCA9IFBBX01BWERBVEFMQU5FUzsKKwlpZiAodWZzLT5vcHRzICYg
RVhZTk9TX1VGU19PUFRfQlJPS0VOX1JYX1NFTF9JRFgpCisJCXVmcy0+cnhfc2VsX2lkeCA9IDA7
CisJaGJhLT5wcml2ID0gKHZvaWQgKil1ZnM7CisJaGJhLT5xdWlya3MgPSB1ZnMtPmRydl9kYXRh
LT5xdWlya3M7CisJaWYgKHVmcy0+ZHJ2X2RhdGEtPmRydl9pbml0KSB7CisJCXJldCA9IHVmcy0+
ZHJ2X2RhdGEtPmRydl9pbml0KGRldiwgdWZzKTsKKwkJaWYgKHJldCkgeworCQkJZGV2X2Vycihk
ZXYsICJmYWlsZWQgdG8gaW5pdCBkcnYtZGF0YVxuIik7CisJCQlnb3RvIHBoeV9vZmY7CisJCX0K
Kwl9CisKKwlyZXQgPSBleHlub3NfdWZzX2dldF9jbGtfaW5mbyh1ZnMpOworCWlmIChyZXQpCisJ
CWdvdG8gcGh5X29mZjsKKwlleHlub3NfdWZzX3NwZWNpZnlfcGh5X3RpbWVfYXR0cih1ZnMpOwor
CWV4eW5vc191ZnNfY29uZmlnX3NtdSh1ZnMpOworCXJldHVybiAwOworCitwaHlfb2ZmOgorCXBo
eV9wb3dlcl9vZmYodWZzLT5waHkpOworcGh5X2V4aXQ6CisJcGh5X2V4aXQodWZzLT5waHkpOwor
CWhiYS0+cHJpdiA9IE5VTEw7CitvdXQ6CisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBl
eHlub3NfdWZzX2hvc3RfcmVzZXQoc3RydWN0IHVmc19oYmEgKmhiYSkKK3sKKwlzdHJ1Y3QgZXh5
bm9zX3VmcyAqdWZzID0gdWZzaGNkX2dldF92YXJpYW50KGhiYSk7CisJdW5zaWduZWQgbG9uZyB0
aW1lb3V0ID0gamlmZmllcyArIG1zZWNzX3RvX2ppZmZpZXMoMSk7CisJdTMyIHZhbDsKKwlpbnQg
cmV0ID0gMDsKKworCWV4eW5vc191ZnNfZGlzYWJsZV9hdXRvX2N0cmxfaGNjX3NhdmUodWZzLCAm
dmFsKTsKKworCWhjaV93cml0ZWwodWZzLCBVRlNfU1dfUlNUX01BU0ssIEhDSV9TV19SU1QpOwor
CisJZG8geworCQlpZiAoIShoY2lfcmVhZGwodWZzLCBIQ0lfU1dfUlNUKSAmIFVGU19TV19SU1Rf
TUFTSykpCisJCQlnb3RvIG91dDsKKwl9IHdoaWxlICh0aW1lX2JlZm9yZShqaWZmaWVzLCB0aW1l
b3V0KSk7CisKKwlkZXZfZXJyKGhiYS0+ZGV2LCAidGltZW91dCBob3N0IHN3LXJlc2V0XG4iKTsK
KwlyZXQgPSAtRVRJTUVET1VUOworCitvdXQ6CisJZXh5bm9zX3Vmc19hdXRvX2N0cmxfaGNjX3Jl
c3RvcmUodWZzLCAmdmFsKTsKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgdm9pZCBleHlub3Nf
dWZzX2Rldl9od19yZXNldChzdHJ1Y3QgdWZzX2hiYSAqaGJhKQoreworCXN0cnVjdCBleHlub3Nf
dWZzICp1ZnMgPSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKworCWhjaV93cml0ZWwodWZzLCAw
IDw8IDAsIEhDSV9HUElPX09VVCk7CisJdWRlbGF5KDUpOworCWhjaV93cml0ZWwodWZzLCAxIDw8
IDAsIEhDSV9HUElPX09VVCk7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfcHJlX2hpYmVy
bjgoc3RydWN0IHVmc19oYmEgKmhiYSwgdTggZW50ZXIpCit7CisJc3RydWN0IGV4eW5vc191ZnMg
KnVmcyA9IHVmc2hjZF9nZXRfdmFyaWFudChoYmEpOworCXN0cnVjdCBleHlub3NfdWZzX3VpY19h
dHRyICphdHRyID0gdWZzLT5kcnZfZGF0YS0+dWljX2F0dHI7CisKKwlpZiAoIWVudGVyKSB7CisJ
CWlmICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09QVF9CUk9LRU5fQVVUT19DTEtfQ1RSTCkKKwkJ
CWV4eW5vc191ZnNfZGlzYWJsZV9hdXRvX2N0cmxfaGNjKHVmcyk7CisJCWV4eW5vc191ZnNfdW5n
YXRlX2Nsa3ModWZzKTsKKworCQlpZiAodWZzLT5vcHRzICYgRVhZTk9TX1VGU19PUFRfVVNFX1NX
X0hJQkVSTjhfVElNRVIpIHsKKwkJCWNvbnN0IHVuc2lnbmVkIGludCBncmFudWxhcml0eV90Ymxb
XSA9IHsKKwkJCQkxLCA0LCA4LCAxNiwgMzIsIDEwMAorCQkJfTsKKwkJCWludCBoOF90aW1lID0g
YXR0ci0+cGFfaGliZXJuOHRpbWUgKgorCQkJCWdyYW51bGFyaXR5X3RibFthdHRyLT5wYV9ncmFu
dWxhcml0eSAtIDFdOworCQkJdW5zaWduZWQgbG9uZyB1czsKKwkJCXM2NCBkZWx0YTsKKworCQkJ
ZG8geworCQkJCWRlbHRhID0gaDhfdGltZSAtIGt0aW1lX3VzX2RlbHRhKGt0aW1lX2dldCgpLAor
CQkJCQkJCXVmcy0+ZW50cnlfaGliZXJuOF90KTsKKwkJCQlpZiAoZGVsdGEgPD0gMCkKKwkJCQkJ
YnJlYWs7CisKKwkJCQl1cyA9IG1pbl90KHM2NCwgZGVsdGEsIFVTRUNfUEVSX01TRUMpOworCQkJ
CWlmICh1cyA+PSAxMCkKKwkJCQkJdXNsZWVwX3JhbmdlKHVzLCB1cyArIDEwKTsKKwkJCX0gd2hp
bGUgKDEpOworCQl9CisJfQorfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX3Bvc3RfaGliZXJu
OChzdHJ1Y3QgdWZzX2hiYSAqaGJhLCB1OCBlbnRlcikKK3sKKwlzdHJ1Y3QgZXh5bm9zX3VmcyAq
dWZzID0gdWZzaGNkX2dldF92YXJpYW50KGhiYSk7CisKKwlpZiAoIWVudGVyKSB7CisJCXUzMiBj
dXJfbW9kZSA9IDA7CisJCXUzMiBwd3Jtb2RlOworCisJCWlmICh1ZnNoY2RfaXNfaHNfbW9kZSgm
dWZzLT5kZXZfcmVxX3BhcmFtcykpCisJCQlwd3Jtb2RlID0gRkFTVF9NT0RFOworCQllbHNlCisJ
CQlwd3Jtb2RlID0gU0xPV19NT0RFOworCisJCXVmc2hjZF9kbWVfZ2V0KGhiYSwgVUlDX0FSR19N
SUIoUEFfUFdSTU9ERSksICZjdXJfbW9kZSk7CisJCWlmIChjdXJfbW9kZSAhPSAocHdybW9kZSA8
PCA0IHwgcHdybW9kZSkpIHsKKwkJCWRldl93YXJuKGhiYS0+ZGV2LCAiJXM6IHBvd2VyIG1vZGUg
Y2hhbmdlXG4iLCBfX2Z1bmNfXyk7CisJCQloYmEtPnB3cl9pbmZvLnB3cl9yeCA9IChjdXJfbW9k
ZSA+PiA0KSAmIDB4ZjsKKwkJCWhiYS0+cHdyX2luZm8ucHdyX3R4ID0gY3VyX21vZGUgJiAweGY7
CisJCQl1ZnNoY2RfY29uZmlnX3B3cl9tb2RlKGhiYSwgJmhiYS0+bWF4X3B3cl9pbmZvLmluZm8p
OworCQl9CisKKwkJaWYgKCEodWZzLT5vcHRzICYgRVhZTk9TX1VGU19PUFRfU0tJUF9DT05ORUNU
SU9OX0VTVEFCKSkKKwkJCWV4eW5vc191ZnNfZXN0YWJsaXNoX2Nvbm50KHVmcyk7CisJfSBlbHNl
IHsKKwkJdWZzLT5lbnRyeV9oaWJlcm44X3QgPSBrdGltZV9nZXQoKTsKKwkJZXh5bm9zX3Vmc19n
YXRlX2Nsa3ModWZzKTsKKwkJaWYgKHVmcy0+b3B0cyAmIEVYWU5PU19VRlNfT1BUX0JST0tFTl9B
VVRPX0NMS19DVFJMKQorCQkJZXh5bm9zX3Vmc19lbmFibGVfYXV0b19jdHJsX2hjYyh1ZnMpOwor
CX0KK30KKworc3RhdGljIGludCBleHlub3NfdWZzX2hjZV9lbmFibGVfbm90aWZ5KHN0cnVjdCB1
ZnNfaGJhICpoYmEsCisJCQkJCWVudW0gdWZzX25vdGlmeV9jaGFuZ2Vfc3RhdHVzIHN0YXR1cykK
K3sKKwlzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzID0gdWZzaGNkX2dldF92YXJpYW50KGhiYSk7CisJ
aW50IHJldCA9IDA7CisKKwlzd2l0Y2ggKHN0YXR1cykgeworCWNhc2UgUFJFX0NIQU5HRToKKwkJ
cmV0ID0gZXh5bm9zX3Vmc19ob3N0X3Jlc2V0KGhiYSk7CisJCWlmIChyZXQpCisJCQlyZXR1cm4g
cmV0OworCQlleHlub3NfdWZzX2Rldl9od19yZXNldChoYmEpOworCQlicmVhazsKKwljYXNlIFBP
U1RfQ0hBTkdFOgorCQlleHlub3NfdWZzX2NhbGNfcHdtX2Nsa19kaXYodWZzKTsKKwkJaWYgKCEo
dWZzLT5vcHRzICYgRVhZTk9TX1VGU19PUFRfQlJPS0VOX0FVVE9fQ0xLX0NUUkwpKQorCQkJZXh5
bm9zX3Vmc19lbmFibGVfYXV0b19jdHJsX2hjYyh1ZnMpOworCQlicmVhazsKKwl9CisKKwlyZXR1
cm4gcmV0OworfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfbGlua19zdGFydHVwX25vdGlmeShz
dHJ1Y3QgdWZzX2hiYSAqaGJhLAorCQkJCQkgIGVudW0gdWZzX25vdGlmeV9jaGFuZ2Vfc3RhdHVz
IHN0YXR1cykKK3sKKwlpbnQgcmV0ID0gMDsKKworCXN3aXRjaCAoc3RhdHVzKSB7CisJY2FzZSBQ
UkVfQ0hBTkdFOgorCQlyZXQgPSBleHlub3NfdWZzX3ByZV9saW5rKGhiYSk7CisJCWJyZWFrOwor
CWNhc2UgUE9TVF9DSEFOR0U6CisJCXJldCA9IGV4eW5vc191ZnNfcG9zdF9saW5rKGhiYSk7CisJ
CWJyZWFrOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19w
d3JfY2hhbmdlX25vdGlmeShzdHJ1Y3QgdWZzX2hiYSAqaGJhLAorCQkJCWVudW0gdWZzX25vdGlm
eV9jaGFuZ2Vfc3RhdHVzIHN0YXR1cywKKwkJCQlzdHJ1Y3QgdWZzX3BhX2xheWVyX2F0dHIgKmRl
dl9tYXhfcGFyYW1zLAorCQkJCXN0cnVjdCB1ZnNfcGFfbGF5ZXJfYXR0ciAqZGV2X3JlcV9wYXJh
bXMpCit7CisJaW50IHJldCA9IDA7CisKKwlzd2l0Y2ggKHN0YXR1cykgeworCWNhc2UgUFJFX0NI
QU5HRToKKwkJcmV0ID0gZXh5bm9zX3Vmc19wcmVfcHdyX21vZGUoaGJhLCBkZXZfbWF4X3BhcmFt
cywKKwkJCQkJICAgICAgZGV2X3JlcV9wYXJhbXMpOworCQlicmVhazsKKwljYXNlIFBPU1RfQ0hB
TkdFOgorCQlyZXQgPSBleHlub3NfdWZzX3Bvc3RfcHdyX21vZGUoaGJhLCBOVUxMLCBkZXZfcmVx
X3BhcmFtcyk7CisJCWJyZWFrOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lk
IGV4eW5vc191ZnNfaGliZXJuOF9ub3RpZnkoc3RydWN0IHVmc19oYmEgKmhiYSwKKwkJCQkgICAg
IGVudW0gdWljX2NtZF9kbWUgZW50ZXIsCisJCQkJICAgICBlbnVtIHVmc19ub3RpZnlfY2hhbmdl
X3N0YXR1cyBub3RpZnkpCit7CisJc3dpdGNoICgodTgpbm90aWZ5KSB7CisJY2FzZSBQUkVfQ0hB
TkdFOgorCQlleHlub3NfdWZzX3ByZV9oaWJlcm44KGhiYSwgZW50ZXIpOworCQlicmVhazsKKwlj
YXNlIFBPU1RfQ0hBTkdFOgorCQlleHlub3NfdWZzX3Bvc3RfaGliZXJuOChoYmEsIGVudGVyKTsK
KwkJYnJlYWs7CisJfQorfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfc3VzcGVuZChzdHJ1Y3Qg
dWZzX2hiYSAqaGJhLCBlbnVtIHVmc19wbV9vcCBwbV9vcCkKK3sKKwlzdHJ1Y3QgZXh5bm9zX3Vm
cyAqdWZzID0gdWZzaGNkX2dldF92YXJpYW50KGhiYSk7CisKKwlpZiAoIXVmc2hjZF9pc19saW5r
X2FjdGl2ZShoYmEpKQorCQlwaHlfcG93ZXJfb2ZmKHVmcy0+cGh5KTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfcmVzdW1lKHN0cnVjdCB1ZnNfaGJhICpoYmEsIGVu
dW0gdWZzX3BtX29wIHBtX29wKQoreworCXN0cnVjdCBleHlub3NfdWZzICp1ZnMgPSB1ZnNoY2Rf
Z2V0X3ZhcmlhbnQoaGJhKTsKKworCWlmICghdWZzaGNkX2lzX2xpbmtfYWN0aXZlKGhiYSkpCisJ
CXBoeV9wb3dlcl9vbih1ZnMtPnBoeSk7CisKKwlleHlub3NfdWZzX2NvbmZpZ19zbXUodWZzKTsK
KworCXJldHVybiAwOworfQorCitzdGF0aWMgc3RydWN0IHVmc19oYmFfdmFyaWFudF9vcHMgdWZz
X2hiYV9leHlub3Nfb3BzID0geworCS5uYW1lCQkJCT0gImV4eW5vc191ZnMiLAorCS5pbml0CQkJ
CT0gZXh5bm9zX3Vmc19pbml0LAorCS5oY2VfZW5hYmxlX25vdGlmeQkJPSBleHlub3NfdWZzX2hj
ZV9lbmFibGVfbm90aWZ5LAorCS5saW5rX3N0YXJ0dXBfbm90aWZ5CQk9IGV4eW5vc191ZnNfbGlu
a19zdGFydHVwX25vdGlmeSwKKwkucHdyX2NoYW5nZV9ub3RpZnkJCT0gZXh5bm9zX3Vmc19wd3Jf
Y2hhbmdlX25vdGlmeSwKKwkuc2V0dXBfeGZlcl9yZXEJCQk9IGV4eW5vc191ZnNfc3BlY2lmeV9u
ZXh1c190X3hmZXJfcmVxLAorCS5zZXR1cF90YXNrX21nbXQJCT0gZXh5bm9zX3Vmc19zcGVjaWZ5
X25leHVzX3RfdG1fcmVxLAorCS5oaWJlcm44X25vdGlmeQkJCT0gZXh5bm9zX3Vmc19oaWJlcm44
X25vdGlmeSwKKwkuc3VzcGVuZAkJCT0gZXh5bm9zX3Vmc19zdXNwZW5kLAorCS5yZXN1bWUJCQkJ
PSBleHlub3NfdWZzX3Jlc3VtZSwKK307CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19wcm9iZShz
dHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCWludCBlcnI7CisJc3RydWN0IGRldmlj
ZSAqZGV2ID0gJnBkZXYtPmRldjsKKworCWVyciA9IHVmc2hjZF9wbHRmcm1faW5pdChwZGV2LCAm
dWZzX2hiYV9leHlub3Nfb3BzKTsKKwlpZiAoZXJyKQorCQlkZXZfZXJyKGRldiwgInVmc2hjZF9w
bHRmcm1faW5pdCgpIGZhaWxlZCAlZFxuIiwgZXJyKTsKKworCXJldHVybiBlcnI7Cit9CisKK3N0
YXRpYyBpbnQgZXh5bm9zX3Vmc19yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikK
K3sKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJhID0gIHBsYXRmb3JtX2dldF9kcnZkYXRhKHBkZXYpOwor
CisJcG1fcnVudGltZV9nZXRfc3luYygmKHBkZXYpLT5kZXYpOworCXVmc2hjZF9yZW1vdmUoaGJh
KTsKKwlyZXR1cm4gMDsKK30KKworc3RydWN0IGV4eW5vc191ZnNfZHJ2X2RhdGEgZXh5bm9zX3Vm
c19kcnZzID0geworCisJLmNvbXBhdGlibGUJCT0gInNhbXN1bmcsZXh5bm9zNy11ZnMiLAorCS51
aWNfYXR0cgkJPSAmZXh5bm9zN191aWNfYXR0ciwKKwkucXVpcmtzCQkJPSBVRlNIQ0RfUVVJUktf
UFJEVF9CWVRFX0dSQU4gfAorCQkJCSAgVUZTSENJX1FVSVJLX0JST0tFTl9SRVFfTElTVF9DTFIg
fAorCQkJCSAgVUZTSENJX1FVSVJLX0JST0tFTl9IQ0UgfAorCQkJCSAgVUZTSENJX1FVSVJLX1NL
SVBfUkVTRVRfSU5UUl9BR0dSLAorCS5vcHRzCQkJPSBFWFlOT1NfVUZTX09QVF9IQVNfQVBCX0NM
S19DVFJMIHwKKwkJCQkgIEVYWU5PU19VRlNfT1BUX0JST0tFTl9BVVRPX0NMS19DVFJMIHwKKwkJ
CQkgIEVYWU5PU19VRlNfT1BUX0JST0tFTl9SWF9TRUxfSURYLAorCS5kcnZfaW5pdAkJPSBleHlu
b3M3X3Vmc19kcnZfaW5pdCwKKwkucHJlX2xpbmsJCT0gZXh5bm9zN191ZnNfcHJlX2xpbmssCisJ
LnBvc3RfbGluawkJPSBleHlub3M3X3Vmc19wb3N0X2xpbmssCisJLnByZV9wd3JfY2hhbmdlCQk9
IGV4eW5vczdfdWZzX3ByZV9wd3JfY2hhbmdlLAorCS5wb3N0X3B3cl9jaGFuZ2UJPSBleHlub3M3
X3Vmc19wb3N0X3B3cl9jaGFuZ2UsCit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2Rldmlj
ZV9pZCBleHlub3NfdWZzX29mX21hdGNoW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJzYW1zdW5n
LGV4eW5vczctdWZzIiwKKwkgIC5kYXRhCSAgICAgID0gJmV4eW5vc191ZnNfZHJ2cyB9LAorCXt9
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3BzIGV4eW5vc191ZnNfcG1fb3Bz
ID0geworCS5zdXNwZW5kCT0gdWZzaGNkX3BsdGZybV9zdXNwZW5kLAorCS5yZXN1bWUJCT0gdWZz
aGNkX3BsdGZybV9yZXN1bWUsCisJLnJ1bnRpbWVfc3VzcGVuZCA9IHVmc2hjZF9wbHRmcm1fcnVu
dGltZV9zdXNwZW5kLAorCS5ydW50aW1lX3Jlc3VtZSAgPSB1ZnNoY2RfcGx0ZnJtX3J1bnRpbWVf
cmVzdW1lLAorCS5ydW50aW1lX2lkbGUgICAgPSB1ZnNoY2RfcGx0ZnJtX3J1bnRpbWVfaWRsZSwK
K307CisKK3N0YXRpYyBzdHJ1Y3QgcGxhdGZvcm1fZHJpdmVyIGV4eW5vc191ZnNfcGx0Zm9ybSA9
IHsKKwkucHJvYmUJPSBleHlub3NfdWZzX3Byb2JlLAorCS5yZW1vdmUJPSBleHlub3NfdWZzX3Jl
bW92ZSwKKwkuc2h1dGRvd24gPSB1ZnNoY2RfcGx0ZnJtX3NodXRkb3duLAorCS5kcml2ZXIJPSB7
CisJCS5uYW1lCT0gImV4eW5vcy11ZnNoYyIsCisJCS5wbQk9ICZleHlub3NfdWZzX3BtX29wcywK
KwkJLm9mX21hdGNoX3RhYmxlID0gb2ZfbWF0Y2hfcHRyKGV4eW5vc191ZnNfb2ZfbWF0Y2gpLAor
CX0sCit9OworbW9kdWxlX3BsYXRmb3JtX2RyaXZlcihleHlub3NfdWZzX3BsdGZvcm0pOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9zY3NpL3Vmcy91ZnMtZXh5bm9zLmggYi9kcml2ZXJzL3Njc2kvdWZz
L3Vmcy1leHlub3MuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjgx
M2IyODZhZmQ5ZAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5v
cy5oCkBAIC0wLDAgKzEsMjg0IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MC1vbmx5ICovCisvKgorICogVUZTIEhvc3QgQ29udHJvbGxlciBkcml2ZXIgZm9yIEV4eW5vcyBz
cGVjaWZpYyBleHRlbnNpb25zCisgKgorICogQ29weXJpZ2h0IChDKSAyMDE0LTIwMTUgU2Ftc3Vu
ZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4KKyAqCisgKi8KKworI2lmbmRlZiBfVUZTX0VYWU5PU19I
XworI2RlZmluZSBfVUZTX0VYWU5PU19IXworCisvKgorICogVU5JUFJPIHJlZ2lzdGVycworICov
CisjZGVmaW5lIFVOSVBST19EQkdfRk9SQ0VfRE1FX0NUUkxfU1RBVEUJCTB4MTUwCisKKy8qCisg
KiBNSUJzIGZvciBQQSBkZWJ1ZyByZWdpc3RlcnMKKyAqLworI2RlZmluZSBQQV9EQkdfQ0xLX1BF
UklPRAkweDk1MTQKKyNkZWZpbmUgUEFfREJHX1RYUEhZX0NGR1VQRFQJMHg5NTE4CisjZGVmaW5l
IFBBX0RCR19SWFBIWV9DRkdVUERUCTB4OTUxOQorI2RlZmluZSBQQV9EQkdfTU9ERQkJMHg5NTI5
CisjZGVmaW5lIFBBX0RCR19TS0lQX1JFU0VUX1BIWQkweDk1MzkKKyNkZWZpbmUgUEFfREJHX09W
X1RNCQkweDk1NDAKKyNkZWZpbmUgUEFfREJHX1NLSVBfTElORV9SRVNFVAkweDk1NDEKKyNkZWZp
bmUgUEFfREJHX0xJTkVfUkVTRVRfUkVRCTB4OTU0MworI2RlZmluZSBQQV9EQkdfT1BUSU9OX1NV
SVRFCTB4OTU2NAorI2RlZmluZSBQQV9EQkdfT1BUSU9OX1NVSVRFX0RZTgkweDk1NjUKKworLyoK
KyAqIE1JQnMgZm9yIFRyYW5zcG9ydCBMYXllciBkZWJ1ZyByZWdpc3RlcnMKKyAqLworI2RlZmlu
ZSBUX0RCR19TS0lQX0lOSVRfSElCRVJOOF9FWElUCTB4YzAwMQorCisvKgorICogRXh5bm9zIE1Q
SFkgYXR0cmlidXRlcworICovCisjZGVmaW5lIFRYX0xJTkVSRVNFVF9OX1ZBTAkweDAyNzcKKyNk
ZWZpbmUgVFhfTElORVJFU0VUX04odikJKCgodikgPj4gMTApICYgMHhGRikKKyNkZWZpbmUgVFhf
TElORVJFU0VUX1BfVkFMCTB4MDI3RAorI2RlZmluZSBUWF9MSU5FUkVTRVRfUCh2KQkoKCh2KSA+
PiAxMikgJiAweEZGKQorI2RlZmluZSBUWF9PVl9TTEVFUF9DTlRfVElNRVIJMHgwMjhFCisjZGVm
aW5lIFRYX09WX0g4X0VOVEVSX0VOCSgxIDw8IDcpCisjZGVmaW5lIFRYX09WX1NMRUVQX0NOVCh2
KQkoKCh2KSA+PiA1KSAmIDB4N0YpCisjZGVmaW5lIFRYX0hJR0hfWl9DTlRfMTFfMDgJMHgwMjhD
CisjZGVmaW5lIFRYX0hJR0hfWl9DTlRfSCh2KQkoKCh2KSA+PiA4KSAmIDB4RikKKyNkZWZpbmUg
VFhfSElHSF9aX0NOVF8wN18wMAkweDAyOEQKKyNkZWZpbmUgVFhfSElHSF9aX0NOVF9MKHYpCSgo
dikgJiAweEZGKQorI2RlZmluZSBUWF9CQVNFX05WQUxfMDdfMDAJMHgwMjkzCisjZGVmaW5lIFRY
X0JBU0VfTlZBTF9MKHYpCSgodikgJiAweEZGKQorI2RlZmluZSBUWF9CQVNFX05WQUxfMTVfMDgJ
MHgwMjk0CisjZGVmaW5lIFRYX0JBU0VfTlZBTF9IKHYpCSgoKHYpID4+IDgpICYgMHhGRikKKyNk
ZWZpbmUgVFhfR1JBTl9OVkFMXzA3XzAwCTB4MDI5NQorI2RlZmluZSBUWF9HUkFOX05WQUxfTCh2
KQkoKHYpICYgMHhGRikKKyNkZWZpbmUgVFhfR1JBTl9OVkFMXzEwXzA4CTB4MDI5NgorI2RlZmlu
ZSBUWF9HUkFOX05WQUxfSCh2KQkoKCh2KSA+PiA4KSAmIDB4MykKKworI2RlZmluZSBSWF9GSUxM
RVJfRU5BQkxFCTB4MDMxNgorI2RlZmluZSBSWF9GSUxMRVJfRU4JCSgxIDw8IDEpCisjZGVmaW5l
IFJYX0xJTkVSRVNFVF9WQUwJMHgwMzE3CisjZGVmaW5lIFJYX0xJTkVSRVNFVCh2KQkoKCh2KSA+
PiAxMikgJiAweEZGKQorI2RlZmluZSBSWF9MQ0NfSUdOT1JFCQkweDAzMTgKKyNkZWZpbmUgUlhf
U1lOQ19NQVNLX0xFTkdUSAkweDAzMjEKKyNkZWZpbmUgUlhfSElCRVJOOF9XQUlUX1ZBTF9CSVRf
MjBfMTYJMHgwMzMxCisjZGVmaW5lIFJYX0hJQkVSTjhfV0FJVF9WQUxfQklUXzE1XzA4CTB4MDMz
MgorI2RlZmluZSBSWF9ISUJFUk44X1dBSVRfVkFMX0JJVF8wN18wMAkweDAzMzMKKyNkZWZpbmUg
UlhfT1ZfU0xFRVBfQ05UX1RJTUVSCTB4MDM0MAorI2RlZmluZSBSWF9PVl9TTEVFUF9DTlQodikJ
KCgodikgPj4gNikgJiAweDFGKQorI2RlZmluZSBSWF9PVl9TVEFMTF9DTlRfVElNRVIJMHgwMzQx
CisjZGVmaW5lIFJYX09WX1NUQUxMX0NOVCh2KQkoKCh2KSA+PiA0KSAmIDB4RkYpCisjZGVmaW5l
IFJYX0JBU0VfTlZBTF8wN18wMAkweDAzNTUKKyNkZWZpbmUgUlhfQkFTRV9OVkFMX0wodikJKCh2
KSAmIDB4RkYpCisjZGVmaW5lIFJYX0JBU0VfTlZBTF8xNV8wOAkweDAzNTQKKyNkZWZpbmUgUlhf
QkFTRV9OVkFMX0godikJKCgodikgPj4gOCkgJiAweEZGKQorI2RlZmluZSBSWF9HUkFOX05WQUxf
MDdfMDAJMHgwMzUzCisjZGVmaW5lIFJYX0dSQU5fTlZBTF9MKHYpCSgodikgJiAweEZGKQorI2Rl
ZmluZSBSWF9HUkFOX05WQUxfMTBfMDgJMHgwMzUyCisjZGVmaW5lIFJYX0dSQU5fTlZBTF9IKHYp
CSgoKHYpID4+IDgpICYgMHgzKQorCisjZGVmaW5lIENNTl9QV01fQ0xLX0NUUkwJMHgwNDAyCisj
ZGVmaW5lIFBXTV9DTEtfQ1RSTF9NQVNLCTB4MworCisjZGVmaW5lIElBVE9WQUxfTlNFQwkJMjAw
MDAJLyogdW5pdDogbnMgKi8KKyNkZWZpbmUgVU5JUFJPX1BDTEtfUEVSSU9EKHVmcykgKE5TRUNf
UEVSX1NFQyAvIHVmcy0+cGNsa19yYXRlKQorCitzdHJ1Y3QgZXh5bm9zX3VmczsKKworLyogdmVu
ZG9yIHNwZWNpZmljIHByZS1kZWZpbmVkIHBhcmFtZXRlcnMgKi8KKyNkZWZpbmUgU0xPVyAxCisj
ZGVmaW5lIEZBU1QgMgorCisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfTlVNX0xBTkVTX1JYCTIK
KyNkZWZpbmUgVUZTX0VYWU5PU19MSU1JVF9OVU1fTEFORVNfVFgJMgorI2RlZmluZSBVRlNfRVhZ
Tk9TX0xJTUlUX0hTR0VBUl9SWAlVRlNfSFNfRzMKKyNkZWZpbmUgVUZTX0VYWU5PU19MSU1JVF9I
U0dFQVJfVFgJVUZTX0hTX0czCisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfUFdNR0VBUl9SWAlV
RlNfUFdNX0c0CisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfUFdNR0VBUl9UWAlVRlNfUFdNX0c0
CisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfUlhfUFdSX1BXTQlTTE9XX01PREUKKyNkZWZpbmUg
VUZTX0VYWU5PU19MSU1JVF9UWF9QV1JfUFdNCVNMT1dfTU9ERQorI2RlZmluZSBVRlNfRVhZTk9T
X0xJTUlUX1JYX1BXUl9IUwlGQVNUX01PREUKKyNkZWZpbmUgVUZTX0VYWU5PU19MSU1JVF9UWF9Q
V1JfSFMJRkFTVF9NT0RFCisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfSFNfUkFURQkJUEFfSFNf
TU9ERV9CCisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfREVTSVJFRF9NT0RFCUZBU1QKKworI2Rl
ZmluZSBSWF9BRFZfRklORV9HUkFOX1NVUF9FTgkweDEKKyNkZWZpbmUgUlhfQURWX0ZJTkVfR1JB
Tl9TVEVQX1ZBTAkweDMKKyNkZWZpbmUgUlhfQURWX01JTl9BQ1RWX1RJTUVfQ0FQCTB4OQorCisj
ZGVmaW5lIFBBX0dSQU5VTEFSSVRZX1ZBTAkweDYKKyNkZWZpbmUgUEFfVEFDVElWQVRFX1ZBTAkw
eDMKKyNkZWZpbmUgUEFfSElCRVJOOFRJTUVfVkFMCTB4MjAKKworc3RydWN0IGV4eW5vc191ZnNf
dWljX2F0dHIgeworCS8qIFRYIEF0dHJpYnV0ZXMgKi8KKwl1bnNpZ25lZCBpbnQgdHhfdHJhaWxp
bmdjbGtzOworCXVuc2lnbmVkIGludCB0eF9kaWZfcF9uc2VjOworCXVuc2lnbmVkIGludCB0eF9k
aWZfbl9uc2VjOworCXVuc2lnbmVkIGludCB0eF9oaWdoX3pfY250X25zZWM7CisJdW5zaWduZWQg
aW50IHR4X2Jhc2VfdW5pdF9uc2VjOworCXVuc2lnbmVkIGludCB0eF9ncmFuX3VuaXRfbnNlYzsK
Kwl1bnNpZ25lZCBpbnQgdHhfc2xlZXBfY250OworCXVuc2lnbmVkIGludCB0eF9taW5fYWN0aXZh
dGV0aW1lOworCS8qIFJYIEF0dHJpYnV0ZXMgKi8KKwl1bnNpZ25lZCBpbnQgcnhfZmlsbGVyX2Vu
YWJsZTsKKwl1bnNpZ25lZCBpbnQgcnhfZGlmX3BfbnNlYzsKKwl1bnNpZ25lZCBpbnQgcnhfaGli
ZXJuOF93YWl0X25zZWM7CisJdW5zaWduZWQgaW50IHJ4X2Jhc2VfdW5pdF9uc2VjOworCXVuc2ln
bmVkIGludCByeF9ncmFuX3VuaXRfbnNlYzsKKwl1bnNpZ25lZCBpbnQgcnhfc2xlZXBfY250Owor
CXVuc2lnbmVkIGludCByeF9zdGFsbF9jbnQ7CisJdW5zaWduZWQgaW50IHJ4X2hzX2cxX3N5bmNf
bGVuX2NhcDsKKwl1bnNpZ25lZCBpbnQgcnhfaHNfZzJfc3luY19sZW5fY2FwOworCXVuc2lnbmVk
IGludCByeF9oc19nM19zeW5jX2xlbl9jYXA7CisJdW5zaWduZWQgaW50IHJ4X2hzX2cxX3ByZXBf
c3luY19sZW5fY2FwOworCXVuc2lnbmVkIGludCByeF9oc19nMl9wcmVwX3N5bmNfbGVuX2NhcDsK
Kwl1bnNpZ25lZCBpbnQgcnhfaHNfZzNfcHJlcF9zeW5jX2xlbl9jYXA7CisJLyogQ29tbW9uIEF0
dHJpYnV0ZXMgKi8KKwl1bnNpZ25lZCBpbnQgY21uX3B3bV9jbGtfY3RybDsKKwkvKiBJbnRlcm5h
bCBBdHRyaWJ1dGVzICovCisJdW5zaWduZWQgaW50IHBhX2RiZ19vcHRpb25fc3VpdGU7CisJLyog
Q2hhbmdlYWJsZSBBdHRyaWJ1dGVzICovCisJdW5zaWduZWQgaW50IHJ4X2Fkdl9maW5lX2dyYW5f
c3VwX2VuOworCXVuc2lnbmVkIGludCByeF9hZHZfZmluZV9ncmFuX3N0ZXA7CisJdW5zaWduZWQg
aW50IHJ4X21pbl9hY3R2X3RpbWVfY2FwOworCXVuc2lnbmVkIGludCByeF9oaWJlcm44X3RpbWVf
Y2FwOworCXVuc2lnbmVkIGludCByeF9hZHZfbWluX2FjdHZfdGltZV9jYXA7CisJdW5zaWduZWQg
aW50IHJ4X2Fkdl9oaWJlcm44X3RpbWVfY2FwOworCXVuc2lnbmVkIGludCBwYV9ncmFudWxhcml0
eTsKKwl1bnNpZ25lZCBpbnQgcGFfdGFjdGl2YXRlOworCXVuc2lnbmVkIGludCBwYV9oaWJlcm44
dGltZTsKK307CisKK3N0cnVjdCBleHlub3NfdWZzX2Rydl9kYXRhIHsKKwljaGFyICpjb21wYXRp
YmxlOworCXN0cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICp1aWNfYXR0cjsKKwl1bnNpZ25lZCBp
bnQgcXVpcmtzOworCXVuc2lnbmVkIGludCBvcHRzOworCS8qIFNvQydzIHNwZWNpZmljIG9wZXJh
dGlvbnMgKi8KKwlpbnQgKCpkcnZfaW5pdCkoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZXh5
bm9zX3VmcyAqdWZzKTsKKwlpbnQgKCpwcmVfbGluaykoc3RydWN0IGV4eW5vc191ZnMgKnVmcyk7
CisJaW50ICgqcG9zdF9saW5rKShzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKTsKKwlpbnQgKCpwcmVf
cHdyX2NoYW5nZSkoc3RydWN0IGV4eW5vc191ZnMgKnVmcywKKwkJCQlzdHJ1Y3QgdWZzX3BhX2xh
eWVyX2F0dHIgKnB3cik7CisJaW50ICgqcG9zdF9wd3JfY2hhbmdlKShzdHJ1Y3QgZXh5bm9zX3Vm
cyAqdWZzLAorCQkJCXN0cnVjdCB1ZnNfcGFfbGF5ZXJfYXR0ciAqcHdyKTsKK307CisKK3N0cnVj
dCB1ZnNfcGh5X3RpbWVfY2ZnIHsKKwl1MzIgdHhfbGluZXJlc2V0X3A7CisJdTMyIHR4X2xpbmVy
ZXNldF9uOworCXUzMiB0eF9oaWdoX3pfY250OworCXUzMiB0eF9iYXNlX25fdmFsOworCXUzMiB0
eF9ncmFuX25fdmFsOworCXUzMiB0eF9zbGVlcF9jbnQ7CisJdTMyIHJ4X2xpbmVyZXNldDsKKwl1
MzIgcnhfaGliZXJuOF93YWl0OworCXUzMiByeF9iYXNlX25fdmFsOworCXUzMiByeF9ncmFuX25f
dmFsOworCXUzMiByeF9zbGVlcF9jbnQ7CisJdTMyIHJ4X3N0YWxsX2NudDsKK307CisKK3N0cnVj
dCBleHlub3NfdWZzIHsKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJhOworCXN0cnVjdCBwaHkgKnBoeTsK
Kwl2b2lkIF9faW9tZW0gKnJlZ19oY2k7CisJdm9pZCBfX2lvbWVtICpyZWdfdW5pcHJvOworCXZv
aWQgX19pb21lbSAqcmVnX3Vmc3A7CisJc3RydWN0IGNsayAqY2xrX2hjaV9jb3JlOworCXN0cnVj
dCBjbGsgKmNsa191bmlwcm9fbWFpbjsKKwlzdHJ1Y3QgY2xrICpjbGtfYXBiOworCXUzMiBwY2xr
X3JhdGU7CisJdTMyIHBjbGtfZGl2OworCXUzMiBwY2xrX2F2YWlsX21pbjsKKwl1MzIgcGNsa19h
dmFpbF9tYXg7CisJdTMyIG1jbGtfcmF0ZTsKKwlpbnQgYXZhaWxfbG5fcng7CisJaW50IGF2YWls
X2xuX3R4OworCWludCByeF9zZWxfaWR4OworCXN0cnVjdCB1ZnNfcGFfbGF5ZXJfYXR0ciBkZXZf
cmVxX3BhcmFtczsKKwlzdHJ1Y3QgdWZzX3BoeV90aW1lX2NmZyB0X2NmZzsKKwlrdGltZV90IGVu
dHJ5X2hpYmVybjhfdDsKKwlzdHJ1Y3QgZXh5bm9zX3Vmc19kcnZfZGF0YSAqZHJ2X2RhdGE7CisK
Kwl1MzIgb3B0czsKKyNkZWZpbmUgRVhZTk9TX1VGU19PUFRfSEFTX0FQQl9DTEtfQ1RSTAkJQklU
KDApCisjZGVmaW5lIEVYWU5PU19VRlNfT1BUX1NLSVBfQ09OTkVDVElPTl9FU1RBQglCSVQoMSkK
KyNkZWZpbmUgRVhZTk9TX1VGU19PUFRfQlJPS0VOX0FVVE9fQ0xLX0NUUkwJQklUKDIpCisjZGVm
aW5lIEVYWU5PU19VRlNfT1BUX0JST0tFTl9SWF9TRUxfSURYCUJJVCgzKQorI2RlZmluZSBFWFlO
T1NfVUZTX09QVF9VU0VfU1dfSElCRVJOOF9USU1FUglCSVQoNCkKK307CisKKyNkZWZpbmUgZm9y
X2VhY2hfdWZzX3J4X2xhbmUodWZzLCBpKSBcCisJZm9yIChpID0gKHVmcyktPnJ4X3NlbF9pZHg7
IFwKKwkJaSA8ICh1ZnMpLT5yeF9zZWxfaWR4ICsgKHVmcyktPmF2YWlsX2xuX3J4OyBpKyspCisj
ZGVmaW5lIGZvcl9lYWNoX3Vmc190eF9sYW5lKHVmcywgaSkgXAorCWZvciAoaSA9IDA7IGkgPCAo
dWZzKS0+YXZhaWxfbG5fdHg7IGkrKykKKworI2RlZmluZSBFWFlOT1NfVUZTX01NSU9fRlVOQyhu
YW1lKQkJCQkJICBcCitzdGF0aWMgaW5saW5lIHZvaWQgbmFtZSMjX3dyaXRlbChzdHJ1Y3QgZXh5
bm9zX3VmcyAqdWZzLCB1MzIgdmFsLCB1MzIgcmVnKVwKK3sJCQkJCQkJCQkgIFwKKwl3cml0ZWwo
dmFsLCB1ZnMtPnJlZ18jI25hbWUgKyByZWcpOwkJCQkgIFwKK30JCQkJCQkJCQkgIFwKKwkJCQkJ
CQkJCSAgXAorc3RhdGljIGlubGluZSB1MzIgbmFtZSMjX3JlYWRsKHN0cnVjdCBleHlub3NfdWZz
ICp1ZnMsIHUzMiByZWcpCQkgIFwKK3sJCQkJCQkJCQkgIFwKKwlyZXR1cm4gcmVhZGwodWZzLT5y
ZWdfIyNuYW1lICsgcmVnKTsJCQkJICBcCit9CisKK0VYWU5PU19VRlNfTU1JT19GVU5DKGhjaSk7
CitFWFlOT1NfVUZTX01NSU9fRlVOQyh1bmlwcm8pOworRVhZTk9TX1VGU19NTUlPX0ZVTkModWZz
cCk7CisjdW5kZWYgRVhZTk9TX1VGU19NTUlPX0ZVTkMKKworbG9uZyBleHlub3NfdWZzX2NhbGNf
dGltZV9jbnRyKHN0cnVjdCBleHlub3NfdWZzICosIGxvbmcpOworCitzdGF0aWMgaW5saW5lIHZv
aWQgZXh5bm9zX3Vmc19lbmFibGVfb3ZfdG0oc3RydWN0IHVmc19oYmEgKmhiYSkKK3sKKwl1ZnNo
Y2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0RCR19PVl9UTSksIFRSVUUpOworfQorCitz
dGF0aWMgaW5saW5lIHZvaWQgZXh5bm9zX3Vmc19kaXNhYmxlX292X3RtKHN0cnVjdCB1ZnNfaGJh
ICpoYmEpCit7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9EQkdfT1ZfVE0p
LCBGQUxTRSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleHlub3NfdWZzX2VuYWJsZV9kYmdf
bW9kZShzdHJ1Y3QgdWZzX2hiYSAqaGJhKQoreworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FS
R19NSUIoUEFfREJHX01PREUpLCBUUlVFKTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGV4eW5v
c191ZnNfZGlzYWJsZV9kYmdfbW9kZShzdHJ1Y3QgdWZzX2hiYSAqaGJhKQoreworCXVmc2hjZF9k
bWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoUEFfREJHX01PREUpLCBGQUxTRSk7Cit9CisKK3N0cnVj
dCBleHlub3NfdWZzX2Rydl9kYXRhIGV4eW5vc191ZnNfZHJ2czsKKworc3RydWN0IGV4eW5vc191
ZnNfdWljX2F0dHIgZXh5bm9zN191aWNfYXR0ciA9IHsKKwkudHhfdHJhaWxpbmdjbGtzCQk9IDB4
MTAsCisJLnR4X2RpZl9wX25zZWMJCQk9IDMwMDAwMDAsCS8qIHVuaXQ6IG5zICovCisJLnR4X2Rp
Zl9uX25zZWMJCQk9IDEwMDAwMDAsCS8qIHVuaXQ6IG5zICovCisJLnR4X2hpZ2hfel9jbnRfbnNl
YwkJPSAyMDAwMCwJLyogdW5pdDogbnMgKi8KKwkudHhfYmFzZV91bml0X25zZWMJCT0gMTAwMDAw
LAkvKiB1bml0OiBucyAqLworCS50eF9ncmFuX3VuaXRfbnNlYwkJPSA0MDAwLAkJLyogdW5pdDog
bnMgKi8KKwkudHhfc2xlZXBfY250CQkJPSAxMDAwLAkJLyogdW5pdDogbnMgKi8KKwkudHhfbWlu
X2FjdGl2YXRldGltZQkJPSAweGEsCisJLnJ4X2ZpbGxlcl9lbmFibGUJCT0gMHgyLAorCS5yeF9k
aWZfcF9uc2VjCQkJPSAxMDAwMDAwLAkvKiB1bml0OiBucyAqLworCS5yeF9oaWJlcm44X3dhaXRf
bnNlYwkJPSA0MDAwMDAwLAkvKiB1bml0OiBucyAqLworCS5yeF9iYXNlX3VuaXRfbnNlYwkJPSAx
MDAwMDAsCS8qIHVuaXQ6IG5zICovCisJLnJ4X2dyYW5fdW5pdF9uc2VjCQk9IDQwMDAsCQkvKiB1
bml0OiBucyAqLworCS5yeF9zbGVlcF9jbnQJCQk9IDEyODAsCQkvKiB1bml0OiBucyAqLworCS5y
eF9zdGFsbF9jbnQJCQk9IDMyMCwJCS8qIHVuaXQ6IG5zICovCisJLnJ4X2hzX2cxX3N5bmNfbGVu
X2NhcAkJPSBTWU5DX0xFTl9DT0FSU0UoMHhmKSwKKwkucnhfaHNfZzJfc3luY19sZW5fY2FwCQk9
IFNZTkNfTEVOX0NPQVJTRSgweGYpLAorCS5yeF9oc19nM19zeW5jX2xlbl9jYXAJCT0gU1lOQ19M
RU5fQ09BUlNFKDB4ZiksCisJLnJ4X2hzX2cxX3ByZXBfc3luY19sZW5fY2FwCT0gUFJFUF9MRU4o
MHhmKSwKKwkucnhfaHNfZzJfcHJlcF9zeW5jX2xlbl9jYXAJPSBQUkVQX0xFTigweGYpLAorCS5y
eF9oc19nM19wcmVwX3N5bmNfbGVuX2NhcAk9IFBSRVBfTEVOKDB4ZiksCisJLnBhX2RiZ19vcHRp
b25fc3VpdGUJCT0gMHgzMDEwMywKK307CisjZW5kaWYgLyogX1VGU19FWFlOT1NfSF8gKi8KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvc2NzaS91ZnMvdW5pcHJvLmggYi9kcml2ZXJzL3Njc2kvdWZzL3Vu
aXByby5oCmluZGV4IDNkYzRkOGI3NjUwOS4uNjU1YzBkMzQxNjllIDEwMDY0NAotLS0gYS9kcml2
ZXJzL3Njc2kvdWZzL3VuaXByby5oCisrKyBiL2RyaXZlcnMvc2NzaS91ZnMvdW5pcHJvLmgKQEAg
LTY0LDggKzY0LDI1IEBACiAjZGVmaW5lIENGR1JYT1ZSNAkJCQkweDAwRTkKICNkZWZpbmUgUlhT
UUNUUkwJCQkJMHgwMEI1CiAjZGVmaW5lIENGR1JYT1ZSNgkJCQkweDAwQkYKKyNkZWZpbmUgUlhf
SFNfRzFfU1lOQ19MRU5HVEhfQ0FQCQkweDAwOEIKKyNkZWZpbmUgUlhfSFNfRzFfUFJFUF9MRU5H
VEhfQ0FQCQkweDAwOEMKKyNkZWZpbmUgUlhfSFNfRzJfU1lOQ19MRU5HVEhfQ0FQCQkweDAwOTQK
KyNkZWZpbmUgUlhfSFNfRzNfU1lOQ19MRU5HVEhfQ0FQCQkweDAwOTUKKyNkZWZpbmUgUlhfSFNf
RzJfUFJFUF9MRU5HVEhfQ0FQCQkweDAwOTYKKyNkZWZpbmUgUlhfSFNfRzNfUFJFUF9MRU5HVEhf
Q0FQCQkweDAwOTcKKyNkZWZpbmUgUlhfQURWX0dSQU5VTEFSSVRZX0NBUAkJCTB4MDA5OAorI2Rl
ZmluZSBSWF9NSU5fQUNUSVZBVEVUSU1FX0NBUAkJCTB4MDA4RgorI2RlZmluZSBSWF9ISUJFUk44
VElNRV9DQVAJCQkweDAwOTIKKyNkZWZpbmUgUlhfQURWX0hJQkVSTjhUSU1FX0NBUAkJCTB4MDA5
OQorI2RlZmluZSBSWF9BRFZfTUlOX0FDVElWQVRFVElNRV9DQVAJCTB4MDA5QQorCiAKICNkZWZp
bmUgaXNfbXBoeV90eF9hdHRyKGF0dHIpCQkJKGF0dHIgPCBSWF9NT0RFKQorI2RlZmluZSBSWF9B
RFZfRklORV9HUkFOX1NURVAoeCkJCSgoKCh4KSAmIDB4MykgPDwgMSkgfCAweDEpCisjZGVmaW5l
IFNZTkNfTEVOX0ZJTkUoeCkJCQkoKHgpICYgMHgzRikKKyNkZWZpbmUgU1lOQ19MRU5fQ09BUlNF
KHgpCQkJKCgxIDw8IDYpIHwgKCh4KSAmIDB4M0YpKQorI2RlZmluZSBQUkVQX0xFTih4KQkJCQko
KHgpICYgMHhGKQorCiAjZGVmaW5lIFJYX01JTl9BQ1RJVkFURVRJTUVfVU5JVF9VUwkJMTAwCiAj
ZGVmaW5lIEhJQkVSTjhUSU1FX1VOSVRfVVMJCQkxMDAKIApAQCAtMTI0LDYgKzE0MSw3IEBACiAj
ZGVmaW5lIFBBX1BBQ1BSRVFFT0JUSU1FT1VUCTB4MTU5MQogI2RlZmluZSBQQV9ISUJFUk44VElN
RQkJMHgxNUE3CiAjZGVmaW5lIFBBX0xPQ0FMVkVSSU5GTwkJMHgxNUE5CisjZGVmaW5lIFBBX0dS
QU5VTEFSSVRZCQkweDE1QUEKICNkZWZpbmUgUEFfVEFDVElWQVRFCQkweDE1QTgKICNkZWZpbmUg
UEFfUEFDUEZSQU1FQ09VTlQJMHgxNUMwCiAjZGVmaW5lIFBBX1BBQ1BFUlJPUkNPVU5UCTB4MTVD
MQpAQCAtMTgxLDYgKzE5OSw5IEBAIGVudW0gewogCVVOQ0hBTkdFRAk9IDcsCiB9OwogCisjZGVm
aW5lIElTX1VGU19QV1JfTU9ERV9IUyhtKQkoKChtKSA9PSBGQVNUX01PREUpIHx8ICgobSkgPT0g
RkFTVEFVVE9fTU9ERSkpCisjZGVmaW5lIElTX1VGU19QV1JfTU9ERV9QV00obSkJKCgobSkgPT0g
U0xPV19NT0RFKSB8fCAoKG0pID09IFNMT1dBVVRPX01PREUpKQorCiAvKiBQQSBUWC9SWCBGcmVx
dWVuY3kgU2VyaWVzICovCiBlbnVtIHsKIAlQQV9IU19NT0RFX0EJPSAxLApAQCAtMjg0LDQgKzMw
NSwxOSBAQCBlbnVtIHsKIAlUUlVFLAogfTsKIAorLyogQ1BvcnQgc2V0dGluZyAqLworI2RlZmlu
ZSBFMkVGQ19PTgkoMSA8PCAwKQorI2RlZmluZSBFMkVGQ19PRkYJKDAgPDwgMCkKKyNkZWZpbmUg
Q1NEX05fT04JKDAgPDwgMSkKKyNkZWZpbmUgQ1NEX05fT0ZGCSgxIDw8IDEpCisjZGVmaW5lIENT
Vl9OX09OCSgwIDw8IDIpCisjZGVmaW5lIENTVl9OX09GRgkoMSA8PCAyKQorI2RlZmluZSBDUE9S
VF9ERUZfRkxBR1MJKENTVl9OX09GRiB8IENTRF9OX09GRiB8IEUyRUZDX09GRikKKworLyogQ1Bv
cnQgY29ubmVjdGlvbiBzdGF0ZSAqLworZW51bSB7CisJQ1BPUlRfSURMRSA9IDAsCisJQ1BPUlRf
Q09OTkVDVEVELAorfTsKKwogI2VuZGlmIC8qIF9VTklQUk9fSF8gKi8KLS0gCjIuMTcuMQoKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmxpbnV4LWFybS1r
ZXJuZWwgbWFpbGluZyBsaXN0CmxpbnV4LWFybS1rZXJuZWxAbGlzdHMuaW5mcmFkZWFkLm9yZwpo
dHRwOi8vbGlzdHMuaW5mcmFkZWFkLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbnV4LWFybS1rZXJu
ZWwK
