Return-Path: <linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-arm-kernel@lfdr.de
Delivered-To: lists+linux-arm-kernel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id AF2721AE48A
	for <lists+linux-arm-kernel@lfdr.de>; Fri, 17 Apr 2020 20:13:34 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:References:MIME-Version:In-Reply-To:
	Message-Id:Date:Subject:To:From:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=2a04MGei8E2kss3MGVEF6dWGf9sOXM1LGCX6Pj2zfWI=; b=PLTF/xOfV3HWKR
	Itcw8ojFKR3vdqfoG6+wn12/9cGRi+ftHG/uosM0qFuBpUwVza2k7FCG1+5oVGM/RH+tHt1YBg1JR
	qcXpy4pYvMAufV5YkQ5YkqLO0HszkJN2otvAqAjrWYRLI9aC+WRrqqqWQqwAkCqtUnO/Z3UyIIk8o
	J5xpy7QR2u3Fv+ymgBoPXVE0ZX9WUDmAllEeueG87pP5ooqBSnqOGMPvU8wale+Lm6gCNPul6qg8w
	0zrVmu0GGcDweUCLg7HfqDwL0tk4ZqD0NSwX2YpEZXCQq9ROiVgRdkK2vEG1vVyijf+tRqZRqVrgH
	WSHjfXEG2ZfE/9NNRmkg==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1jPVUQ-0003RS-O2; Fri, 17 Apr 2020 18:13:22 +0000
Received: from mailout3.samsung.com ([203.254.224.33])
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1jPVRc-00018J-Fx
 for linux-arm-kernel@lists.infradead.org; Fri, 17 Apr 2020 18:10:37 +0000
Received: from epcas5p2.samsung.com (unknown [182.195.41.40])
 by mailout3.samsung.com (KnoxPortal) with ESMTP id
 20200417181026epoutp03f00bfd195bfb2f32cbbc17c8fe3705a6~Grc_r-9KM0168001680epoutp03B
 for <linux-arm-kernel@lists.infradead.org>;
 Fri, 17 Apr 2020 18:10:26 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout3.samsung.com
 20200417181026epoutp03f00bfd195bfb2f32cbbc17c8fe3705a6~Grc_r-9KM0168001680epoutp03B
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=samsung.com;
 s=mail20170921; t=1587147026;
 bh=abrRcmD7PErEDWrSo1etAHY9d7IsdF/uDfAWnuH7QOE=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=in+b6fBtPcXtXIO5k9xZn1b/bEf56zxpVsvhyjMLZ77kerO1bVGFKBGRnfugLz+R0
 mMRpFe1q+8WO2QDuHhLY1rAvDILKJ+kO7JY5egMDM78/Hd9qVi9APYNAjBhCftseHj
 3in6880kE4oVccbpqNMVRaGmvHV0LWj7GF5GwjVw=
Received: from epsmges5p3new.samsung.com (unknown [182.195.42.75]) by
 epcas5p4.samsung.com (KnoxPortal) with ESMTP id
 20200417181025epcas5p4bc217de235b32a7f778deff29d544f7e~Grc95uyo-0789107891epcas5p48;
 Fri, 17 Apr 2020 18:10:25 +0000 (GMT)
Received: from epcas5p2.samsung.com ( [182.195.41.40]) by
 epsmges5p3new.samsung.com (Symantec Messaging Gateway) with SMTP id
 DB.0B.04736.111F99E5; Sat, 18 Apr 2020 03:10:25 +0900 (KST)
Received: from epsmtrp1.samsung.com (unknown [182.195.40.13]) by
 epcas5p4.samsung.com (KnoxPortal) with ESMTPA id
 20200417181024epcas5p4231ae3dd2598155854e9b7ee52438bcb~Grc9fwAKy1060310603epcas5p4y;
 Fri, 17 Apr 2020 18:10:24 +0000 (GMT)
Received: from epsmgms1p1new.samsung.com (unknown [182.195.42.41]) by
 epsmtrp1.samsung.com (KnoxPortal) with ESMTP id
 20200417181024epsmtrp129c6cad6ffe2b8c1bbec82c81516a516~Grc9e8Jlc0669906699epsmtrp1P;
 Fri, 17 Apr 2020 18:10:24 +0000 (GMT)
X-AuditID: b6c32a4b-ae3ff70000001280-64-5e99f111f9bc
Received: from epsmtip1.samsung.com ( [182.195.34.30]) by
 epsmgms1p1new.samsung.com (Symantec Messaging Gateway) with SMTP id
 81.E0.04024.011F99E5; Sat, 18 Apr 2020 03:10:24 +0900 (KST)
Received: from Jaguar.sa.corp.samsungelectronics.net (unknown
 [107.108.73.139]) by epsmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200417181022epsmtip1009f98dabc98e3bf4185e743496a9453~Grc7hAOi-2097520975epsmtip1I;
 Fri, 17 Apr 2020 18:10:22 +0000 (GMT)
From: Alim Akhtar <alim.akhtar@samsung.com>
To: robh@kernel.org
Subject: [PATCH v6 09/10] scsi: ufs-exynos: add UFS host support for Exynos
 SoCs
Date: Fri, 17 Apr 2020 23:29:43 +0530
Message-Id: <20200417175944.47189-10-alim.akhtar@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200417175944.47189-1-alim.akhtar@samsung.com>
MIME-Version: 1.0
X-Brightmail-Tracker: H4sIAAAAAAAAA02Sa0gUYRSG+eauNjquQiejjBXLC5qi0YCaCYtMJGL2yyhtycHE27KjpSFp
 upiXvG2FaZsapOWGaJva5iU3U0OoVbI1DcyolDSIVBDKqFwnqX/vec9zznv4+BhcMUh6MKmZ
 2aI2U52upByJnme+PgGuy/WJQT+/s/z7xh6KX/xuo/iVjlaSbxq2kvz4eCfNz3SNELzp4xTJ
 T/YaKP7G+BOMr3hjpvi7z39h/O9+M823dM+gw6wwWVWJCSZjGSU8vFMg6MYGCWF5/i0hVHUZ
 kbBq2i1ctlRgccwJx/BkMT31nKjdf+i049miiVpa86oGz73+bY4uRBNWrBw5MMCFwphBT5Uj
 R0bB9SHQz5ppuVhB8GzMRtkpBbeG4Is1d2viwUvLX2gAQffCJVIudBiUt+qRnaI4f5it69rM
 cOfcYHitZNPHuWkM3rep7NqNi4fC6VbSrgnOG1Zv92+kMQzLRUDT43A5zBPud1pwu3bYsEt0
 LZsrWc4Vxuo/EfJKTyjuvonL/FUa2n4r7GuAU4GxXyvbbrD0vIuWtQcsVpfQMpIGV3pDZDsf
 WhpHCVlHguW1gbAjOOcLHb375SBnqFz/hMmTLJSWKGTaG4q/2v5O7oTaigpS1gIUvutA8tvU
 IFiZqsNrkGfDf/c3/Hd/w7+0ZoQb0Q5RI2WkiNIBTUimeD5QUmdIOZkpgWeyMkxo81v5HTUj
 kzVmCHEMUm5jS6vqExWk+pyUlzGEgMGV7uzT6A2LTVbnXRC1WUnanHRRGkI7GUK5ndWTtpMK
 LkWdLaaJokbUbnUxxsGjEIVFxaLjUUU6i22Xs/XU2t6YW7FePw6GJNCuA0uG1SPRWe26voUX
 l3PehEb63IPPc/OGD6P5qZVmvcbvWsvhkUPz+8qCvF2cGNWxsoCguMmwysWClR5Pp5FIotoY
 tb4nwVnwdm93/lh2Mf5RvNCYo4poqApL6lV5FUnNIS4Bwf5KQjqrDvbDtZL6D0eVfZ5SAwAA
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFprKIsWRmVeSWpSXmKPExsWy7bCSnK7Ax5lxBpcn6lg8mLeNzeLlz6ts
 Fp/WL2O1mH/kHKvF+fMb2C1ubjnKYrHp8TVWi8u75rBZzDi/j8mi+/oONovlx/8xWfzfs4Pd
 YunWm4wOvB6X+3qZPDat6mTz2Lyk3qPl5H4Wj49Pb7F49G1ZxejxeZOcR/uBbqYAjigum5TU
 nMyy1CJ9uwSujKYLE9kLLk1grpj64T57A+OFc0xdjJwcEgImEhvPHmDvYuTiEBLYzSjx5fN/
 ZoiEtMT1jRPYIWxhiZX/nkMVNTFJLNrWAFbEJqAtcXf6FrBJIkBFR761MYLYzALPmCROPSzt
 YuTgEBYIkJg8ORkkzCKgKvF54R42kDCvgK3E/J02EOPlJVZvOAA2kRMo3NaylAmkREjARmLD
 kxiQMK+AoMTJmU9YQMLMAuoS6+cJQeyRl2jeOpt5AqPgLCRVsxCqZiGpWsDIvIpRMrWgODc9
 t9iwwDAvtVyvODG3uDQvXS85P3cTIziytDR3MF5eEn+IUYCDUYmH16BnZpwQa2JZcWXuIUYJ
 DmYlEd6DbkAh3pTEyqrUovz4otKc1OJDjNIcLErivE/zjkUKCaQnlqRmp6YWpBbBZJk4OKUa
 GDMaTvic9D7x/MQExobEoF9cvgle25dLHlRcuZXtzFlxy2jvJ7vzNnCXTdJTiJ0xebnltPb0
 y011ffVVa/dvPbeUN+0s6xov18P3X3tc3JwZet0zevM0odwCoaeLL5XmRyytPeFTE2r4aett
 0Y5lr+at0uUVlPViCXNcvlqr2vxcyrX7jn83rVRiKc5INNRiLipOBAAAz9j8qAIAAA==
X-CMS-MailID: 20200417181024epcas5p4231ae3dd2598155854e9b7ee52438bcb
X-Msg-Generator: CA
CMS-TYPE: 105P
X-CMS-RootMailID: 20200417181024epcas5p4231ae3dd2598155854e9b7ee52438bcb
References: <20200417175944.47189-1-alim.akhtar@samsung.com>
 <CGME20200417181024epcas5p4231ae3dd2598155854e9b7ee52438bcb@epcas5p4.samsung.com>
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20200417_111029_964371_E21302D7 
X-CRM114-Status: GOOD (  21.30  )
X-Spam-Score: -5.2 (-----)
X-Spam-Report: SpamAssassin version 3.4.4 on bombadil.infradead.org summary:
 Content analysis details:   (-5.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 0.0 RCVD_IN_MSPIKE_H3      RBL: Good reputation (+3)
 [203.254.224.33 listed in wl.mailspike.net]
 -5.0 RCVD_IN_DNSWL_HI       RBL: Sender listed at https://www.dnswl.org/,
 high trust [203.254.224.33 listed in list.dnswl.org]
 -0.0 SPF_HELO_PASS          SPF: HELO matches SPF record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 0.0 RCVD_IN_MSPIKE_WL      Mailspike good senders
 -0.0 DKIMWL_WL_HIGH         DKIMwl.org - Whitelisted High sender
X-BeenThere: linux-arm-kernel@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-arm-kernel.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-arm-kernel/>
List-Post: <mailto:linux-arm-kernel@lists.infradead.org>
List-Help: <mailto:linux-arm-kernel-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=subscribe>
Cc: devicetree@vger.kernel.org, linux-samsung-soc@vger.kernel.org,
 linux-scsi@vger.kernel.org, martin.petersen@oracle.com,
 linux-kernel@vger.kernel.org, krzk@kernel.org, kwmad.kim@samsung.com,
 avri.altman@wdc.com, cang@codeaurora.org,
 Alim Akhtar <alim.akhtar@samsung.com>, stanley.chu@mediatek.com,
 linux-arm-kernel@lists.infradead.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-arm-kernel" <linux-arm-kernel-bounces@lists.infradead.org>
Errors-To: linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org

VGhpcyBwYXRjaCBpbnRyb2R1Y2VzIEV4eW5vcyBVRlMgaG9zdCBjb250cm9sbGVyIGRyaXZlciwK
d2hpY2ggbWFpbmx5IGhhbmRsZXMgdmVuZG9yLXNwZWNpZmljIG9wZXJhdGlvbnMgaW5jbHVkaW5n
Cmxpbmsgc3RhcnR1cCwgcG93ZXIgbW9kZSBjaGFuZ2UgYW5kIGhpYmVybmF0aW9uL3VuaGliZXJu
YXRpb24uCgpSZXBvcnRlZC1ieToga2J1aWxkIHRlc3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+ClJl
cG9ydGVkLWJ5OiBKdWxpYSBMYXdhbGwgPGp1bGlhLmxhd2FsbEBsaXA2LmZyPgpbcm9ib3Q6IGRy
aXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5jOjkzMTo4LTEwOgogV0FSTklORzogcG9zc2libGUg
Y29uZGl0aW9uIHdpdGggbm8gZWZmZWN0IChpZiA9PSBlbHNlKQpdClJldmlld2VkLWJ5OiBLaXdv
b25nIEtpbSA8a3dtYWQua2ltQHNhbXN1bmcuY29tPgpSZXZpZXdlZC1ieTogQXZyaSBBbHRtYW4g
PGF2cmkuYWx0bWFuQHdkYy5jb20+ClNpZ25lZC1vZmYtYnk6IFNldW5nd29uIEplb24gPGVzc3V1
akBnbWFpbC5jb20+ClNpZ25lZC1vZmYtYnk6IEFsaW0gQWtodGFyIDxhbGltLmFraHRhckBzYW1z
dW5nLmNvbT4KVGVzdGVkLWJ5OiBQYXdlxYIgQ2htaWVsIDxwYXdlbC5taWtvbGFqLmNobWllbEBn
bWFpbC5jb20+Ci0tLQogZHJpdmVycy9zY3NpL3Vmcy9LY29uZmlnICAgICAgfCAgIDEyICsKIGRy
aXZlcnMvc2NzaS91ZnMvTWFrZWZpbGUgICAgIHwgICAgMSArCiBkcml2ZXJzL3Njc2kvdWZzL3Vm
cy1leHlub3MuYyB8IDEyODkgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2
ZXJzL3Njc2kvdWZzL3Vmcy1leHlub3MuaCB8ICAyODQgKysrKysrKysKIGRyaXZlcnMvc2NzaS91
ZnMvdW5pcHJvLmggICAgIHwgICAzMyArCiA1IGZpbGVzIGNoYW5nZWQsIDE2MTkgaW5zZXJ0aW9u
cygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5jCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9zY3NpL3Vmcy91ZnMtZXh5bm9zLmgKCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3Njc2kvdWZzL0tjb25maWcgYi9kcml2ZXJzL3Njc2kvdWZzL0tjb25maWcK
aW5kZXggZTIwMDVhZWRkYzJkLi5jYzdlMjljOGMyNGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc2Nz
aS91ZnMvS2NvbmZpZworKysgYi9kcml2ZXJzL3Njc2kvdWZzL0tjb25maWcKQEAgLTE2MCwzICsx
NjAsMTUgQEAgY29uZmlnIFNDU0lfVUZTX0JTRwogCiAJICBTZWxlY3QgdGhpcyBpZiB5b3UgbmVl
ZCBhIGJzZyBkZXZpY2Ugbm9kZSBmb3IgeW91ciBVRlMgY29udHJvbGxlci4KIAkgIElmIHVuc3Vy
ZSwgc2F5IE4uCisKK2NvbmZpZyBTQ1NJX1VGU19FWFlOT1MKKwlib29sICJFWFlOT1Mgc3BlY2lm
aWMgaG9va3MgdG8gVUZTIGNvbnRyb2xsZXIgcGxhdGZvcm0gZHJpdmVyIgorCWRlcGVuZHMgb24g
U0NTSV9VRlNIQ0RfUExBVEZPUk0gJiYgQVJDSF9FWFlOT1MgfHwgQ09NUElMRV9URVNUCisJc2Vs
ZWN0IFBIWV9TQU1TVU5HX1VGUworCWhlbHAKKwkgIFRoaXMgc2VsZWN0cyB0aGUgRVhZTk9TIHNw
ZWNpZmljIGFkZGl0aW9ucyB0byBVRlNIQ0QgcGxhdGZvcm0gZHJpdmVyLgorCSAgVUZTIGhvc3Qg
b24gRVhZTk9TIGluY2x1ZGVzIEhDSSBhbmQgVU5JUFJPIGxheWVyLCBhbmQgYXNzb2NpYXRlcyB3
aXRoCisJICBVRlMtUEhZIGRyaXZlci4KKworCSAgU2VsZWN0IHRoaXMgaWYgeW91IGhhdmUgVUZT
IGhvc3QgY29udHJvbGxlciBvbiBFWFlOT1MgY2hpcHNldC4KKwkgIElmIHVuc3VyZSwgc2F5IE4u
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3Njc2kvdWZzL01ha2VmaWxlIGIvZHJpdmVycy9zY3NpL3Vm
cy9NYWtlZmlsZQppbmRleCA5NGM2YzVkNzMzNGIuLmYwYzViOTVlYzljYyAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9zY3NpL3Vmcy9NYWtlZmlsZQorKysgYi9kcml2ZXJzL3Njc2kvdWZzL01ha2VmaWxl
CkBAIC00LDYgKzQsNyBAQCBvYmotJChDT05GSUdfU0NTSV9VRlNfRFdDX1RDX1BDSSkgKz0gdGMt
ZHdjLWcyMTAtcGNpLm8gdWZzaGNkLWR3Yy5vIHRjLWR3Yy1nMjEwLgogb2JqLSQoQ09ORklHX1ND
U0lfVUZTX0RXQ19UQ19QTEFURk9STSkgKz0gdGMtZHdjLWcyMTAtcGx0ZnJtLm8gdWZzaGNkLWR3
Yy5vIHRjLWR3Yy1nMjEwLm8KIG9iai0kKENPTkZJR19TQ1NJX1VGU19DRE5TX1BMQVRGT1JNKSAr
PSBjZG5zLXBsdGZybS5vCiBvYmotJChDT05GSUdfU0NTSV9VRlNfUUNPTSkgKz0gdWZzLXFjb20u
bworb2JqLSQoQ09ORklHX1NDU0lfVUZTX0VYWU5PUykgKz0gdWZzLWV4eW5vcy5vCiBvYmotJChD
T05GSUdfU0NTSV9VRlNIQ0QpICs9IHVmc2hjZC1jb3JlLm8KIHVmc2hjZC1jb3JlLXkJCQkJKz0g
dWZzaGNkLm8gdWZzLXN5c2ZzLm8KIHVmc2hjZC1jb3JlLSQoQ09ORklHX1NDU0lfVUZTX0JTRykJ
Kz0gdWZzX2JzZy5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL3Njc2kvdWZzL3Vmcy1leHlub3MuYyBi
L2RyaXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDAwMDAwMDAwMDAwMC4uMDY4MzkwZjRiNmZmCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9z
Y3NpL3Vmcy91ZnMtZXh5bm9zLmMKQEAgLTAsMCArMSwxMjg5IEBACisvLyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogVUZTIEhvc3QgQ29udHJvbGxlciBkcml2
ZXIgZm9yIEV4eW5vcyBzcGVjaWZpYyBleHRlbnNpb25zCisgKgorICogQ29weXJpZ2h0IChDKSAy
MDE0LTIwMTUgU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4KKyAqIEF1dGhvcjogU2V1bmd3
b24gSmVvbiAgPGVzc3V1akBnbWFpbC5jb20+CisgKiBBdXRob3I6IEFsaW0gQWtodGFyIDxhbGlt
LmFraHRhckBzYW1zdW5nLmNvbT4KKyAqCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgor
I2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgorI2luY2x1ZGUgPGxpbnV4L29mLmg+CisjaW5jbHVk
ZSA8bGludXgvb2ZfYWRkcmVzcy5oPgorI2luY2x1ZGUgPGxpbnV4L3BoeS9waHkuaD4KKyNpbmNs
dWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KKworI2luY2x1ZGUgInVmc2hjZC5oIgorI2lu
Y2x1ZGUgInVmc2hjZC1wbHRmcm0uaCIKKyNpbmNsdWRlICJ1ZnNoY2kuaCIKKyNpbmNsdWRlICJ1
bmlwcm8uaCIKKworI2luY2x1ZGUgInVmcy1leHlub3MuaCIKKworLyoKKyAqIEV4eW5vcydzIFZl
bmRvciBzcGVjaWZpYyByZWdpc3RlcnMgZm9yIFVGU0hDSQorICovCisjZGVmaW5lIEhDSV9UWFBS
RFRfRU5UUllfU0laRQkweDAwCisjZGVmaW5lIFBSRFRfUFJFRkVDVF9FTgkJQklUKDMxKQorI2Rl
ZmluZSBQUkRUX1NFVF9TSVpFKHgpCSgoeCkgJiAweDFGKQorI2RlZmluZSBIQ0lfUlhQUkRUX0VO
VFJZX1NJWkUJMHgwNAorI2RlZmluZSBIQ0lfMVVTX1RPX0NOVF9WQUwJMHgwQworI2RlZmluZSBD
TlRfVkFMXzFVU19NQVNLCTB4M0ZGCisjZGVmaW5lIEhDSV9VVFJMX05FWFVTX1RZUEUJMHg0MAor
I2RlZmluZSBIQ0lfVVRNUkxfTkVYVVNfVFlQRQkweDQ0CisjZGVmaW5lIEhDSV9TV19SU1QJCTB4
NTAKKyNkZWZpbmUgVUZTX0xJTktfU1dfUlNUCQlCSVQoMCkKKyNkZWZpbmUgVUZTX1VOSVBST19T
V19SU1QJQklUKDEpCisjZGVmaW5lIFVGU19TV19SU1RfTUFTSwkJKFVGU19VTklQUk9fU1dfUlNU
IHwgVUZTX0xJTktfU1dfUlNUKQorI2RlZmluZSBIQ0lfREFUQV9SRU9SREVSCTB4NjAKKyNkZWZp
bmUgSENJX1VOSVBST19BUEJfQ0xLX0NUUkwJMHg2OAorI2RlZmluZSBVTklQUk9fQVBCX0NMSyh2
LCB4KQkoKCh2KSAmIH4weEYpIHwgKCh4KSAmIDB4RikpCisjZGVmaW5lIEhDSV9BWElETUFfUldE
QVRBX0JVUlNUX0xFTgkweDZDCisjZGVmaW5lIEhDSV9HUElPX09VVAkJMHg3MAorI2RlZmluZSBI
Q0lfRVJSX0VOX1BBX0xBWUVSCTB4NzgKKyNkZWZpbmUgSENJX0VSUl9FTl9ETF9MQVlFUgkweDdD
CisjZGVmaW5lIEhDSV9FUlJfRU5fTl9MQVlFUgkweDgwCisjZGVmaW5lIEhDSV9FUlJfRU5fVF9M
QVlFUgkweDg0CisjZGVmaW5lIEhDSV9FUlJfRU5fRE1FX0xBWUVSCTB4ODgKKyNkZWZpbmUgSENJ
X0NMS1NUT1BfQ1RSTAkweEIwCisjZGVmaW5lIFJFRkNMS19TVE9QCQlCSVQoMikKKyNkZWZpbmUg
VU5JUFJPX01DTEtfU1RPUAlCSVQoMSkKKyNkZWZpbmUgVU5JUFJPX1BDTEtfU1RPUAlCSVQoMCkK
KyNkZWZpbmUgQ0xLX1NUT1BfTUFTSwkJKFJFRkNMS19TVE9QIHxcCisJCQkJIFVOSVBST19NQ0xL
X1NUT1AgfFwKKwkJCQkgVU5JUFJPX1BDTEtfU1RPUCkKKyNkZWZpbmUgSENJX01JU0MJCTB4QjQK
KyNkZWZpbmUgUkVGQ0xLX0NUUkxfRU4JCUJJVCg3KQorI2RlZmluZSBVTklQUk9fUENMS19DVFJM
X0VOCUJJVCg2KQorI2RlZmluZSBVTklQUk9fTUNMS19DVFJMX0VOCUJJVCg1KQorI2RlZmluZSBI
Q0lfQ09SRUNMS19DVFJMX0VOCUJJVCg0KQorI2RlZmluZSBDTEtfQ1RSTF9FTl9NQVNLCShSRUZD
TEtfQ1RSTF9FTiB8XAorCQkJCSBVTklQUk9fUENMS19DVFJMX0VOIHxcCisJCQkJIFVOSVBST19N
Q0xLX0NUUkxfRU4pCisvKiBEZXZpY2UgZmF0YWwgZXJyb3IgKi8KKyNkZWZpbmUgREZFU19FUlJf
RU4JCUJJVCgzMSkKKyNkZWZpbmUgREZFU19ERUZfTDJfRVJSUwkoVUlDX0RBVEFfTElOS19MQVlF
Ul9FUlJPUl9SWF9CVUZfT0YgfFwKKwkJCQkgVUlDX0RBVEFfTElOS19MQVlFUl9FUlJPUl9QQV9J
TklUKQorI2RlZmluZSBERkVTX0RFRl9MM19FUlJTCShVSUNfTkVUV09SS19VTlNVUFBPUlRFRF9I
RUFERVJfVFlQRSB8XAorCQkJCSBVSUNfTkVUV09SS19CQURfREVWSUNFSURfRU5DIHxcCisJCQkJ
IFVJQ19ORVRXT1JLX0xIRFJfVFJBUF9QQUNLRVRfRFJPUFBJTkcpCisjZGVmaW5lIERGRVNfREVG
X0w0X0VSUlMJKFVJQ19UUkFOU1BPUlRfVU5TVVBQT1JURURfSEVBREVSX1RZUEUgfFwKKwkJCQkg
VUlDX1RSQU5TUE9SVF9VTktOT1dOX0NQT1JUSUQgfFwKKwkJCQkgVUlDX1RSQU5TUE9SVF9OT19D
T05ORUNUSU9OX1JYIHxcCisJCQkJIFVJQ19UUkFOU1BPUlRfQkFEX1RDKQorCitlbnVtIHsKKwlV
TklQUk9fTDFfNSA9IDAsLyogUEhZIEFkYXB0ZXIgKi8KKwlVTklQUk9fTDIsCS8qIERhdGEgTGlu
ayAqLworCVVOSVBST19MMywJLyogTmV0d29yayAqLworCVVOSVBST19MNCwJLyogVHJhbnNwb3J0
ICovCisJVU5JUFJPX0RNRSwJLyogRE1FICovCit9OworCisvKgorICogVU5JUFJPIHJlZ2lzdGVy
cworICovCisjZGVmaW5lIFVOSVBST19DT01QX1ZFUlNJT04JCQkweDAwMAorI2RlZmluZSBVTklQ
Uk9fRE1FX1BXUl9SRVEJCQkweDA5MAorI2RlZmluZSBVTklQUk9fRE1FX1BXUl9SRVFfUE9XRVJN
T0RFCQkweDA5NAorI2RlZmluZSBVTklQUk9fRE1FX1BXUl9SRVFfTE9DQUxMMlRJTUVSMAkweDA5
OAorI2RlZmluZSBVTklQUk9fRE1FX1BXUl9SRVFfTE9DQUxMMlRJTUVSMQkweDA5QworI2RlZmlu
ZSBVTklQUk9fRE1FX1BXUl9SRVFfTE9DQUxMMlRJTUVSMgkweDBBMAorI2RlZmluZSBVTklQUk9f
RE1FX1BXUl9SRVFfUkVNT1RFTDJUSU1FUjAJMHgwQTQKKyNkZWZpbmUgVU5JUFJPX0RNRV9QV1Jf
UkVRX1JFTU9URUwyVElNRVIxCTB4MEE4CisjZGVmaW5lIFVOSVBST19ETUVfUFdSX1JFUV9SRU1P
VEVMMlRJTUVSMgkweDBBQworCisvKgorICogVUZTIFByb3RlY3RvciByZWdpc3RlcnMKKyAqLwor
I2RlZmluZSBVRlNQUlNFQ1VSSVRZCTB4MDEwCisjZGVmaW5lIE5TU01VCQlCSVQoMTQpCisjZGVm
aW5lIFVGU1BTQkVHSU4wCTB4MjAwCisjZGVmaW5lIFVGU1BTRU5EMAkweDIwNAorI2RlZmluZSBV
RlNQU0xVTjAJMHgyMDgKKyNkZWZpbmUgVUZTUFNDVFJMMAkweDIwQworCisjZGVmaW5lIENOVFJf
RElWX1ZBTCA0MAorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX2F1dG9fY3RybF9oY2Moc3RydWN0
IGV4eW5vc191ZnMgKnVmcywgYm9vbCBlbik7CitzdGF0aWMgdm9pZCBleHlub3NfdWZzX2N0cmxf
Y2xrc3RvcChzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzLCBib29sIGVuKTsKKworc3RhdGljIGlubGlu
ZSB2b2lkIGV4eW5vc191ZnNfZW5hYmxlX2F1dG9fY3RybF9oY2Moc3RydWN0IGV4eW5vc191ZnMg
KnVmcykKK3sKKwlleHlub3NfdWZzX2F1dG9fY3RybF9oY2ModWZzLCB0cnVlKTsKK30KKworc3Rh
dGljIGlubGluZSB2b2lkIGV4eW5vc191ZnNfZGlzYWJsZV9hdXRvX2N0cmxfaGNjKHN0cnVjdCBl
eHlub3NfdWZzICp1ZnMpCit7CisJZXh5bm9zX3Vmc19hdXRvX2N0cmxfaGNjKHVmcywgZmFsc2Up
OworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgZXh5bm9zX3Vmc19kaXNhYmxlX2F1dG9fY3RybF9o
Y2Nfc2F2ZSgKKwkJCQkJc3RydWN0IGV4eW5vc191ZnMgKnVmcywgdTMyICp2YWwpCit7CisJKnZh
bCA9IGhjaV9yZWFkbCh1ZnMsIEhDSV9NSVNDKTsKKwlleHlub3NfdWZzX2F1dG9fY3RybF9oY2Mo
dWZzLCBmYWxzZSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleHlub3NfdWZzX2F1dG9fY3Ry
bF9oY2NfcmVzdG9yZSgKKwkJCQkJc3RydWN0IGV4eW5vc191ZnMgKnVmcywgdTMyICp2YWwpCit7
CisJaGNpX3dyaXRlbCh1ZnMsICp2YWwsIEhDSV9NSVNDKTsKK30KKworc3RhdGljIGlubGluZSB2
b2lkIGV4eW5vc191ZnNfZ2F0ZV9jbGtzKHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJZXh5
bm9zX3Vmc19jdHJsX2Nsa3N0b3AodWZzLCB0cnVlKTsKK30KKworc3RhdGljIGlubGluZSB2b2lk
IGV4eW5vc191ZnNfdW5nYXRlX2Nsa3Moc3RydWN0IGV4eW5vc191ZnMgKnVmcykKK3sKKwlleHlu
b3NfdWZzX2N0cmxfY2xrc3RvcCh1ZnMsIGZhbHNlKTsKK30KKworc3RhdGljIGludCBleHlub3M3
X3Vmc19kcnZfaW5pdChzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBleHlub3NfdWZzICp1ZnMp
Cit7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZXh5bm9zN191ZnNfcHJlX2xpbmsoc3Ry
dWN0IGV4eW5vc191ZnMgKnVmcykKK3sKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJhID0gdWZzLT5oYmE7
CisJdTMyIHZhbCA9IHVmcy0+ZHJ2X2RhdGEtPnVpY19hdHRyLT5wYV9kYmdfb3B0aW9uX3N1aXRl
OworCWludCBpOworCisJZXh5bm9zX3Vmc19lbmFibGVfb3ZfdG0oaGJhKTsKKwlmb3JfZWFjaF91
ZnNfdHhfbGFuZSh1ZnMsIGkpCisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VM
KDB4Mjk3LCBpKSwgMHgxNyk7CisJZm9yX2VhY2hfdWZzX3J4X2xhbmUodWZzLCBpKSB7CisJCXVm
c2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKDB4MzYyLCBpKSwgMHhmZik7CisJCXVm
c2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKDB4MzYzLCBpKSwgMHgwMCk7CisJfQor
CWV4eW5vc191ZnNfZGlzYWJsZV9vdl90bShoYmEpOworCisJZm9yX2VhY2hfdWZzX3R4X2xhbmUo
dWZzLCBpKQorCQl1ZnNoY2RfZG1lX3NldChoYmEsCisJCQlVSUNfQVJHX01JQl9TRUwoVFhfSElC
RVJOOF9DT05UUk9MLCBpKSwgMHgwKTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlC
KFBBX0RCR19UWFBIWV9DRkdVUERUKSwgMHgxKTsKKwl1ZGVsYXkoMSk7CisJdWZzaGNkX2RtZV9z
ZXQoaGJhLCBVSUNfQVJHX01JQihQQV9EQkdfT1BUSU9OX1NVSVRFKSwgdmFsIHwgKDEgPDwgMTIp
KTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0RCR19TS0lQX1JFU0VUX1BI
WSksIDB4MSk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9EQkdfU0tJUF9M
SU5FX1JFU0VUKSwgMHgxKTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0RC
R19MSU5FX1JFU0VUX1JFUSksIDB4MSk7CisJdWRlbGF5KDE2MDApOworCXVmc2hjZF9kbWVfc2V0
KGhiYSwgVUlDX0FSR19NSUIoUEFfREJHX09QVElPTl9TVUlURSksIHZhbCk7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBleHlub3M3X3Vmc19wb3N0X2xpbmsoc3RydWN0IGV4eW5vc191
ZnMgKnVmcykKK3sKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJhID0gdWZzLT5oYmE7CisJaW50IGk7CisK
KwlleHlub3NfdWZzX2VuYWJsZV9vdl90bShoYmEpOworCWZvcl9lYWNoX3Vmc190eF9sYW5lKHVm
cywgaSkgeworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTCgweDI4YiwgaSks
IDB4ODMpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTCgweDI5YSwgaSks
IDB4MDcpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTCgweDI3NywgaSks
CisJCQlUWF9MSU5FUkVTRVRfTihleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgMjAwMDAw
KSkpOworCX0KKwlleHlub3NfdWZzX2Rpc2FibGVfb3ZfdG0oaGJhKTsKKworCWV4eW5vc191ZnNf
ZW5hYmxlX2RiZ19tb2RlKGhiYSk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQ
QV9TQVZFQ09ORklHVElNRSksIDB4YmI4KTsKKwlleHlub3NfdWZzX2Rpc2FibGVfZGJnX21vZGUo
aGJhKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGV4eW5vczdfdWZzX3ByZV9wd3Jf
Y2hhbmdlKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsCisJCQkJCQlzdHJ1Y3QgdWZzX3BhX2xheWVy
X2F0dHIgKnB3cikKK3sKKwl1bmlwcm9fd3JpdGVsKHVmcywgMHgyMiwgVU5JUFJPX0RCR19GT1JD
RV9ETUVfQ1RSTF9TVEFURSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBleHlub3M3
X3Vmc19wb3N0X3B3cl9jaGFuZ2Uoc3RydWN0IGV4eW5vc191ZnMgKnVmcywKKwkJCQkJCXN0cnVj
dCB1ZnNfcGFfbGF5ZXJfYXR0ciAqcHdyKQoreworCXN0cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMt
PmhiYTsKKwlpbnQgbGFuZXMgPSBtYXhfdCh1MzIsIHB3ci0+bGFuZV9yeCwgcHdyLT5sYW5lX3R4
KTsKKworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoUEFfREJHX1JYUEhZX0NGR1VQ
RFQpLCAweDEpOworCisJaWYgKGxhbmVzID09IDEpIHsKKwkJZXh5bm9zX3Vmc19lbmFibGVfZGJn
X21vZGUoaGJhKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9DT05ORUNU
RURUWERBVEFMQU5FUyksIDB4MSk7CisJCWV4eW5vc191ZnNfZGlzYWJsZV9kYmdfbW9kZShoYmEp
OworCX0KKworCXJldHVybiAwOworfQorCisvKioKKyAqIGV4eW5vc191ZnNfYXV0b19jdHJsX2hj
YyAtIEhDSSBjb3JlIGNsb2NrIGNvbnRyb2wgYnkgaC93CisgKiBDb250cm9sIHNob3VsZCBiZSBk
aXNhYmxlZCBpbiB0aGUgYmVsb3cgY2FzZXMKKyAqIC0gQmVmb3JlIGhvc3QgY29udHJvbGxlciBT
L1cgcmVzZXQKKyAqIC0gQWNjZXNzIHRvIFVGUyBwcm90ZWN0b3IncyByZWdpc3RlcgorICovCitz
dGF0aWMgdm9pZCBleHlub3NfdWZzX2F1dG9fY3RybF9oY2Moc3RydWN0IGV4eW5vc191ZnMgKnVm
cywgYm9vbCBlbikKK3sKKwl1MzIgbWlzYyA9IGhjaV9yZWFkbCh1ZnMsIEhDSV9NSVNDKTsKKwor
CWlmIChlbikKKwkJaGNpX3dyaXRlbCh1ZnMsIG1pc2MgfCBIQ0lfQ09SRUNMS19DVFJMX0VOLCBI
Q0lfTUlTQyk7CisJZWxzZQorCQloY2lfd3JpdGVsKHVmcywgbWlzYyAmIH5IQ0lfQ09SRUNMS19D
VFJMX0VOLCBIQ0lfTUlTQyk7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfY3RybF9jbGtz
dG9wKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsIGJvb2wgZW4pCit7CisJdTMyIGN0cmwgPSBoY2lf
cmVhZGwodWZzLCBIQ0lfQ0xLU1RPUF9DVFJMKTsKKwl1MzIgbWlzYyA9IGhjaV9yZWFkbCh1ZnMs
IEhDSV9NSVNDKTsKKworCWlmIChlbikgeworCQloY2lfd3JpdGVsKHVmcywgbWlzYyB8IENMS19D
VFJMX0VOX01BU0ssIEhDSV9NSVNDKTsKKwkJaGNpX3dyaXRlbCh1ZnMsIGN0cmwgfCBDTEtfU1RP
UF9NQVNLLCBIQ0lfQ0xLU1RPUF9DVFJMKTsKKwl9IGVsc2UgeworCQloY2lfd3JpdGVsKHVmcywg
Y3RybCAmIH5DTEtfU1RPUF9NQVNLLCBIQ0lfQ0xLU1RPUF9DVFJMKTsKKwkJaGNpX3dyaXRlbCh1
ZnMsIG1pc2MgJiB+Q0xLX0NUUkxfRU5fTUFTSywgSENJX01JU0MpOworCX0KK30KKworc3RhdGlj
IGludCBleHlub3NfdWZzX2dldF9jbGtfaW5mbyhzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQorewor
CXN0cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMtPmhiYTsKKwlzdHJ1Y3QgbGlzdF9oZWFkICpoZWFk
ID0gJmhiYS0+Y2xrX2xpc3RfaGVhZDsKKwlzdHJ1Y3QgdWZzX2Nsa19pbmZvICpjbGtpOworCXUz
MiBwY2xrX3JhdGU7CisJdTMyIGZfbWluLCBmX21heDsKKwl1OCBkaXYgPSAwOworCWludCByZXQg
PSAwOworCisJaWYgKCFoZWFkIHx8IGxpc3RfZW1wdHkoaGVhZCkpCisJCWdvdG8gb3V0OworCisJ
bGlzdF9mb3JfZWFjaF9lbnRyeShjbGtpLCBoZWFkLCBsaXN0KSB7CisJCWlmICghSVNfRVJSKGNs
a2ktPmNsaykpIHsKKwkJCWlmICghc3RyY21wKGNsa2ktPm5hbWUsICJjb3JlX2NsayIpKQorCQkJ
CXVmcy0+Y2xrX2hjaV9jb3JlID0gY2xraS0+Y2xrOworCQkJZWxzZSBpZiAoIXN0cmNtcChjbGtp
LT5uYW1lLCAic2Nsa191bmlwcm9fbWFpbiIpKQorCQkJCXVmcy0+Y2xrX3VuaXByb19tYWluID0g
Y2xraS0+Y2xrOworCQl9CisJfQorCisJaWYgKCF1ZnMtPmNsa19oY2lfY29yZSB8fCAhdWZzLT5j
bGtfdW5pcHJvX21haW4pIHsKKwkJZGV2X2VycihoYmEtPmRldiwgImZhaWxlZCB0byBnZXQgY2xr
IGluZm9cbiIpOworCQlyZXQgPSAtRUlOVkFMOworCQlnb3RvIG91dDsKKwl9CisKKwl1ZnMtPm1j
bGtfcmF0ZSA9IGNsa19nZXRfcmF0ZSh1ZnMtPmNsa191bmlwcm9fbWFpbik7CisJcGNsa19yYXRl
ID0gY2xrX2dldF9yYXRlKHVmcy0+Y2xrX2hjaV9jb3JlKTsKKwlmX21pbiA9IHVmcy0+cGNsa19h
dmFpbF9taW47CisJZl9tYXggPSB1ZnMtPnBjbGtfYXZhaWxfbWF4OworCisJaWYgKHVmcy0+b3B0
cyAmIEVYWU5PU19VRlNfT1BUX0hBU19BUEJfQ0xLX0NUUkwpIHsKKwkJZG8geworCQkJcGNsa19y
YXRlIC89IChkaXYgKyAxKTsKKworCQkJaWYgKHBjbGtfcmF0ZSA8PSBmX21heCkKKwkJCQlicmVh
azsKKwkJCWRpdisrOworCQl9IHdoaWxlIChwY2xrX3JhdGUgPj0gZl9taW4pOworCX0KKworCWlm
ICh1bmxpa2VseShwY2xrX3JhdGUgPCBmX21pbiB8fCBwY2xrX3JhdGUgPiBmX21heCkpIHsKKwkJ
ZGV2X2VycihoYmEtPmRldiwgIm5vdCBhdmFpbGFibGUgcGNsayByYW5nZSAlZFxuIiwgcGNsa19y
YXRlKTsKKwkJcmV0ID0gLUVJTlZBTDsKKwkJZ290byBvdXQ7CisJfQorCisJdWZzLT5wY2xrX3Jh
dGUgPSBwY2xrX3JhdGU7CisJdWZzLT5wY2xrX2RpdiA9IGRpdjsKKworb3V0OgorCXJldHVybiBy
ZXQ7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfc2V0X3VuaXByb19wY2xrX2RpdihzdHJ1
Y3QgZXh5bm9zX3VmcyAqdWZzKQoreworCWlmICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09QVF9I
QVNfQVBCX0NMS19DVFJMKSB7CisJCXUzMiB2YWw7CisKKwkJdmFsID0gaGNpX3JlYWRsKHVmcywg
SENJX1VOSVBST19BUEJfQ0xLX0NUUkwpOworCQloY2lfd3JpdGVsKHVmcywgVU5JUFJPX0FQQl9D
TEsodmFsLCB1ZnMtPnBjbGtfZGl2KSwKKwkJCSAgIEhDSV9VTklQUk9fQVBCX0NMS19DVFJMKTsK
Kwl9Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfc2V0X3B3bV9jbGtfZGl2KHN0cnVjdCBl
eHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVmc19oYmEgKmhiYSA9IHVmcy0+aGJhOworCXN0
cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICphdHRyID0gdWZzLT5kcnZfZGF0YS0+dWljX2F0dHI7
CisKKwl1ZnNoY2RfZG1lX3NldChoYmEsCisJCVVJQ19BUkdfTUlCKENNTl9QV01fQ0xLX0NUUkwp
LCBhdHRyLT5jbW5fcHdtX2Nsa19jdHJsKTsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19j
YWxjX3B3bV9jbGtfZGl2KHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVmc19o
YmEgKmhiYSA9IHVmcy0+aGJhOworCXN0cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICphdHRyID0g
dWZzLT5kcnZfZGF0YS0+dWljX2F0dHI7CisJY29uc3QgdW5zaWduZWQgaW50IGRpdiA9IDMwLCBt
dWx0ID0gMjA7CisJY29uc3QgdW5zaWduZWQgbG9uZyBwd21fbWluID0gMyAqIDEwMDAgKiAxMDAw
OworCWNvbnN0IHVuc2lnbmVkIGxvbmcgcHdtX21heCA9IDkgKiAxMDAwICogMTAwMDsKKwljb25z
dCBpbnQgZGl2c1tdID0gezMyLCAxNiwgOCwgNH07CisJdW5zaWduZWQgbG9uZyBjbGsgPSAwLCBf
Y2xrLCBjbGtfcGVyaW9kOworCWludCBpID0gMCwgY2xrX2lkeCA9IC0xOworCisJY2xrX3Blcmlv
ZCA9IFVOSVBST19QQ0xLX1BFUklPRCh1ZnMpOworCWZvciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpF
KGRpdnMpOyBpKyspIHsKKwkJX2NsayA9IE5TRUNfUEVSX1NFQyAqIG11bHQgLyAoY2xrX3Blcmlv
ZCAqIGRpdnNbaV0gKiBkaXYpOworCQlpZiAoX2NsayA+PSBwd21fbWluICYmIF9jbGsgPD0gcHdt
X21heCkgeworCQkJaWYgKF9jbGsgPiBjbGspIHsKKwkJCQljbGtfaWR4ID0gaTsKKwkJCQljbGsg
PSBfY2xrOworCQkJfQorCQl9CisJfQorCisJaWYgKGNsa19pZHggPT0gLTEpIHsKKwkJdWZzaGNk
X2RtZV9nZXQoaGJhLCBVSUNfQVJHX01JQihDTU5fUFdNX0NMS19DVFJMKSwgJmNsa19pZHgpOwor
CQlkZXZfZXJyKGhiYS0+ZGV2LAorCQkJImZhaWxlZCB0byBkZWNpZGUgcHdtIGNsb2NrIGRpdmlk
ZXIsIHdpbGwgbm90IGNoYW5nZVxuIik7CisJfQorCisJYXR0ci0+Y21uX3B3bV9jbGtfY3RybCA9
IGNsa19pZHggJiBQV01fQ0xLX0NUUkxfTUFTSzsKK30KKworbG9uZyBleHlub3NfdWZzX2NhbGNf
dGltZV9jbnRyKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsIGxvbmcgcGVyaW9kKQoreworCWNvbnN0
IGludCBwcmVjaXNlID0gMTA7CisJbG9uZyBwY2xrX3JhdGUgPSB1ZnMtPnBjbGtfcmF0ZTsKKwls
b25nIGNsa19wZXJpb2QsIGZyYWN0aW9uOworCisJY2xrX3BlcmlvZCA9IFVOSVBST19QQ0xLX1BF
UklPRCh1ZnMpOworCWZyYWN0aW9uID0gKChOU0VDX1BFUl9TRUMgJSBwY2xrX3JhdGUpICogcHJl
Y2lzZSkgLyBwY2xrX3JhdGU7CisKKwlyZXR1cm4gKHBlcmlvZCAqIHByZWNpc2UpIC8gKChjbGtf
cGVyaW9kICogcHJlY2lzZSkgKyBmcmFjdGlvbik7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191
ZnNfc3BlY2lmeV9waHlfdGltZV9hdHRyKHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3Ry
dWN0IGV4eW5vc191ZnNfdWljX2F0dHIgKmF0dHIgPSB1ZnMtPmRydl9kYXRhLT51aWNfYXR0cjsK
KwlzdHJ1Y3QgdWZzX3BoeV90aW1lX2NmZyAqdF9jZmcgPSAmdWZzLT50X2NmZzsKKworCXRfY2Zn
LT50eF9saW5lcmVzZXRfcCA9CisJCWV4eW5vc191ZnNfY2FsY190aW1lX2NudHIodWZzLCBhdHRy
LT50eF9kaWZfcF9uc2VjKTsKKwl0X2NmZy0+dHhfbGluZXJlc2V0X24gPQorCQlleHlub3NfdWZz
X2NhbGNfdGltZV9jbnRyKHVmcywgYXR0ci0+dHhfZGlmX25fbnNlYyk7CisJdF9jZmctPnR4X2hp
Z2hfel9jbnQgPQorCQlleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgYXR0ci0+dHhfaGln
aF96X2NudF9uc2VjKTsKKwl0X2NmZy0+dHhfYmFzZV9uX3ZhbCA9CisJCWV4eW5vc191ZnNfY2Fs
Y190aW1lX2NudHIodWZzLCBhdHRyLT50eF9iYXNlX3VuaXRfbnNlYyk7CisJdF9jZmctPnR4X2dy
YW5fbl92YWwgPQorCQlleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgYXR0ci0+dHhfZ3Jh
bl91bml0X25zZWMpOworCXRfY2ZnLT50eF9zbGVlcF9jbnQgPQorCQlleHlub3NfdWZzX2NhbGNf
dGltZV9jbnRyKHVmcywgYXR0ci0+dHhfc2xlZXBfY250KTsKKworCXRfY2ZnLT5yeF9saW5lcmVz
ZXQgPQorCQlleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgYXR0ci0+cnhfZGlmX3BfbnNl
Yyk7CisJdF9jZmctPnJ4X2hpYmVybjhfd2FpdCA9CisJCWV4eW5vc191ZnNfY2FsY190aW1lX2Nu
dHIodWZzLCBhdHRyLT5yeF9oaWJlcm44X3dhaXRfbnNlYyk7CisJdF9jZmctPnJ4X2Jhc2Vfbl92
YWwgPQorCQlleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVmcywgYXR0ci0+cnhfYmFzZV91bml0
X25zZWMpOworCXRfY2ZnLT5yeF9ncmFuX25fdmFsID0KKwkJZXh5bm9zX3Vmc19jYWxjX3RpbWVf
Y250cih1ZnMsIGF0dHItPnJ4X2dyYW5fdW5pdF9uc2VjKTsKKwl0X2NmZy0+cnhfc2xlZXBfY250
ID0KKwkJZXh5bm9zX3Vmc19jYWxjX3RpbWVfY250cih1ZnMsIGF0dHItPnJ4X3NsZWVwX2NudCk7
CisJdF9jZmctPnJ4X3N0YWxsX2NudCA9CisJCWV4eW5vc191ZnNfY2FsY190aW1lX2NudHIodWZz
LCBhdHRyLT5yeF9zdGFsbF9jbnQpOworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX2NvbmZp
Z19waHlfdGltZV9hdHRyKHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVmc19o
YmEgKmhiYSA9IHVmcy0+aGJhOworCXN0cnVjdCB1ZnNfcGh5X3RpbWVfY2ZnICp0X2NmZyA9ICZ1
ZnMtPnRfY2ZnOworCWludCBpOworCisJZXh5bm9zX3Vmc19zZXRfcHdtX2Nsa19kaXYodWZzKTsK
KworCWV4eW5vc191ZnNfZW5hYmxlX292X3RtKGhiYSk7CisKKwlmb3JfZWFjaF91ZnNfcnhfbGFu
ZSh1ZnMsIGkpIHsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoUlhfRklM
TEVSX0VOQUJMRSwgaSksCisJCQkJdWZzLT5kcnZfZGF0YS0+dWljX2F0dHItPnJ4X2ZpbGxlcl9l
bmFibGUpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTChSWF9MSU5FUkVT
RVRfVkFMLCBpKSwKKwkJCQlSWF9MSU5FUkVTRVQodF9jZmctPnJ4X2xpbmVyZXNldCkpOworCQl1
ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTChSWF9CQVNFX05WQUxfMDdfMDAsIGkp
LAorCQkJCVJYX0JBU0VfTlZBTF9MKHRfY2ZnLT5yeF9iYXNlX25fdmFsKSk7CisJCXVmc2hjZF9k
bWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VMKFJYX0JBU0VfTlZBTF8xNV8wOCwgaSksCisJCQkJ
UlhfQkFTRV9OVkFMX0godF9jZmctPnJ4X2Jhc2Vfbl92YWwpKTsKKwkJdWZzaGNkX2RtZV9zZXQo
aGJhLCBVSUNfQVJHX01JQl9TRUwoUlhfR1JBTl9OVkFMXzA3XzAwLCBpKSwKKwkJCQlSWF9HUkFO
X05WQUxfTCh0X2NmZy0+cnhfZ3Jhbl9uX3ZhbCkpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJ
Q19BUkdfTUlCX1NFTChSWF9HUkFOX05WQUxfMTBfMDgsIGkpLAorCQkJCVJYX0dSQU5fTlZBTF9I
KHRfY2ZnLT5yeF9ncmFuX25fdmFsKSk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19N
SUJfU0VMKFJYX09WX1NMRUVQX0NOVF9USU1FUiwgaSksCisJCQkJUlhfT1ZfU0xFRVBfQ05UKHRf
Y2ZnLT5yeF9zbGVlcF9jbnQpKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9T
RUwoUlhfT1ZfU1RBTExfQ05UX1RJTUVSLCBpKSwKKwkJCQlSWF9PVl9TVEFMTF9DTlQodF9jZmct
PnJ4X3N0YWxsX2NudCkpOworCX0KKworCWZvcl9lYWNoX3Vmc190eF9sYW5lKHVmcywgaSkgewor
CQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTChUWF9MSU5FUkVTRVRfUF9WQUws
IGkpLAorCQkJCVRYX0xJTkVSRVNFVF9QKHRfY2ZnLT50eF9saW5lcmVzZXRfcCkpOworCQl1ZnNo
Y2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCX1NFTChUWF9ISUdIX1pfQ05UXzA3XzAwLCBpKSwK
KwkJCQlUWF9ISUdIX1pfQ05UX0wodF9jZmctPnR4X2hpZ2hfel9jbnQpKTsKKwkJdWZzaGNkX2Rt
ZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoVFhfSElHSF9aX0NOVF8xMV8wOCwgaSksCisJCQkJ
VFhfSElHSF9aX0NOVF9IKHRfY2ZnLT50eF9oaWdoX3pfY250KSk7CisJCXVmc2hjZF9kbWVfc2V0
KGhiYSwgVUlDX0FSR19NSUJfU0VMKFRYX0JBU0VfTlZBTF8wN18wMCwgaSksCisJCQkJVFhfQkFT
RV9OVkFMX0wodF9jZmctPnR4X2Jhc2Vfbl92YWwpKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBV
SUNfQVJHX01JQl9TRUwoVFhfQkFTRV9OVkFMXzE1XzA4LCBpKSwKKwkJCQlUWF9CQVNFX05WQUxf
SCh0X2NmZy0+dHhfYmFzZV9uX3ZhbCkpOworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdf
TUlCX1NFTChUWF9HUkFOX05WQUxfMDdfMDAsIGkpLAorCQkJCVRYX0dSQU5fTlZBTF9MKHRfY2Zn
LT50eF9ncmFuX25fdmFsKSk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUJfU0VM
KFRYX0dSQU5fTlZBTF8xMF8wOCwgaSksCisJCQkJVFhfR1JBTl9OVkFMX0godF9jZmctPnR4X2dy
YW5fbl92YWwpKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQl9TRUwoVFhfT1Zf
U0xFRVBfQ05UX1RJTUVSLCBpKSwKKwkJCQlUWF9PVl9IOF9FTlRFUl9FTiB8CisJCQkJVFhfT1Zf
U0xFRVBfQ05UKHRfY2ZnLT50eF9zbGVlcF9jbnQpKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLCBV
SUNfQVJHX01JQl9TRUwoVFhfTUlOX0FDVElWQVRFVElNRSwgaSksCisJCQkJdWZzLT5kcnZfZGF0
YS0+dWljX2F0dHItPnR4X21pbl9hY3RpdmF0ZXRpbWUpOworCX0KKworCWV4eW5vc191ZnNfZGlz
YWJsZV9vdl90bShoYmEpOworfQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX2NvbmZpZ19waHlf
Y2FwX2F0dHIoc3RydWN0IGV4eW5vc191ZnMgKnVmcykKK3sKKwlzdHJ1Y3QgdWZzX2hiYSAqaGJh
ID0gdWZzLT5oYmE7CisJc3RydWN0IGV4eW5vc191ZnNfdWljX2F0dHIgKmF0dHIgPSB1ZnMtPmRy
dl9kYXRhLT51aWNfYXR0cjsKKwlpbnQgaTsKKworCWV4eW5vc191ZnNfZW5hYmxlX292X3RtKGhi
YSk7CisKKwlmb3JfZWFjaF91ZnNfcnhfbGFuZSh1ZnMsIGkpIHsKKwkJdWZzaGNkX2RtZV9zZXQo
aGJhLAorCQkJCVVJQ19BUkdfTUlCX1NFTChSWF9IU19HMV9TWU5DX0xFTkdUSF9DQVAsIGkpLAor
CQkJCWF0dHItPnJ4X2hzX2cxX3N5bmNfbGVuX2NhcCk7CisJCXVmc2hjZF9kbWVfc2V0KGhiYSwK
KwkJCQlVSUNfQVJHX01JQl9TRUwoUlhfSFNfRzJfU1lOQ19MRU5HVEhfQ0FQLCBpKSwKKwkJCQlh
dHRyLT5yeF9oc19nMl9zeW5jX2xlbl9jYXApOworCQl1ZnNoY2RfZG1lX3NldChoYmEsCisJCQkJ
VUlDX0FSR19NSUJfU0VMKFJYX0hTX0czX1NZTkNfTEVOR1RIX0NBUCwgaSksCisJCQkJYXR0ci0+
cnhfaHNfZzNfc3luY19sZW5fY2FwKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLAorCQkJCVVJQ19B
UkdfTUlCX1NFTChSWF9IU19HMV9QUkVQX0xFTkdUSF9DQVAsIGkpLAorCQkJCWF0dHItPnJ4X2hz
X2cxX3ByZXBfc3luY19sZW5fY2FwKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLAorCQkJCVVJQ19B
UkdfTUlCX1NFTChSWF9IU19HMl9QUkVQX0xFTkdUSF9DQVAsIGkpLAorCQkJCWF0dHItPnJ4X2hz
X2cyX3ByZXBfc3luY19sZW5fY2FwKTsKKwkJdWZzaGNkX2RtZV9zZXQoaGJhLAorCQkJCVVJQ19B
UkdfTUlCX1NFTChSWF9IU19HM19QUkVQX0xFTkdUSF9DQVAsIGkpLAorCQkJCWF0dHItPnJ4X2hz
X2czX3ByZXBfc3luY19sZW5fY2FwKTsKKwl9CisKKwlpZiAoYXR0ci0+cnhfYWR2X2ZpbmVfZ3Jh
bl9zdXBfZW4gPT0gMCkgeworCQlmb3JfZWFjaF91ZnNfcnhfbGFuZSh1ZnMsIGkpIHsKKwkJCXVm
c2hjZF9kbWVfc2V0KGhiYSwKKwkJCQlVSUNfQVJHX01JQl9TRUwoUlhfQURWX0dSQU5VTEFSSVRZ
X0NBUCwgaSksIDApOworCisJCQlpZiAoYXR0ci0+cnhfbWluX2FjdHZfdGltZV9jYXApCisJCQkJ
dWZzaGNkX2RtZV9zZXQoaGJhLAorCQkJCQlVSUNfQVJHX01JQl9TRUwoUlhfTUlOX0FDVElWQVRF
VElNRV9DQVAsCisJCQkJCQlpKSwgYXR0ci0+cnhfbWluX2FjdHZfdGltZV9jYXApOworCisJCQlp
ZiAoYXR0ci0+cnhfaGliZXJuOF90aW1lX2NhcCkKKwkJCQl1ZnNoY2RfZG1lX3NldChoYmEsCisJ
CQkJCVVJQ19BUkdfTUlCX1NFTChSWF9ISUJFUk44VElNRV9DQVAsIGkpLAorCQkJCQkJYXR0ci0+
cnhfaGliZXJuOF90aW1lX2NhcCk7CisJCX0KKwl9IGVsc2UgaWYgKGF0dHItPnJ4X2Fkdl9maW5l
X2dyYW5fc3VwX2VuID09IDEpIHsKKwkJZm9yX2VhY2hfdWZzX3J4X2xhbmUodWZzLCBpKSB7CisJ
CQlpZiAoYXR0ci0+cnhfYWR2X2ZpbmVfZ3Jhbl9zdGVwKQorCQkJCXVmc2hjZF9kbWVfc2V0KGhi
YSwKKwkJCQkJVUlDX0FSR19NSUJfU0VMKFJYX0FEVl9HUkFOVUxBUklUWV9DQVAsCisJCQkJCQlp
KSwgUlhfQURWX0ZJTkVfR1JBTl9TVEVQKAorCQkJCQkJYXR0ci0+cnhfYWR2X2ZpbmVfZ3Jhbl9z
dGVwKSk7CisKKwkJCWlmIChhdHRyLT5yeF9hZHZfbWluX2FjdHZfdGltZV9jYXApCisJCQkJdWZz
aGNkX2RtZV9zZXQoaGJhLAorCQkJCQlVSUNfQVJHX01JQl9TRUwoCisJCQkJCQlSWF9BRFZfTUlO
X0FDVElWQVRFVElNRV9DQVAsIGkpLAorCQkJCQkJYXR0ci0+cnhfYWR2X21pbl9hY3R2X3RpbWVf
Y2FwKTsKKworCQkJaWYgKGF0dHItPnJ4X2Fkdl9oaWJlcm44X3RpbWVfY2FwKQorCQkJCXVmc2hj
ZF9kbWVfc2V0KGhiYSwKKwkJCQkJVUlDX0FSR19NSUJfU0VMKFJYX0FEVl9ISUJFUk44VElNRV9D
QVAsCisJCQkJCQlpKSwKKwkJCQkJCWF0dHItPnJ4X2Fkdl9oaWJlcm44X3RpbWVfY2FwKTsKKwkJ
fQorCX0KKworCWV4eW5vc191ZnNfZGlzYWJsZV9vdl90bShoYmEpOworfQorCitzdGF0aWMgdm9p
ZCBleHlub3NfdWZzX2VzdGFibGlzaF9jb25udChzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKQorewor
CXN0cnVjdCB1ZnNfaGJhICpoYmEgPSB1ZnMtPmhiYTsKKwllbnVtIHsKKwkJREVWX0lECQk9IDB4
MDAsCisJCVBFRVJfREVWX0lECT0gMHgwMSwKKwkJUEVFUl9DUE9SVF9JRAk9IDB4MDAsCisJCVRS
QUZGSUNfQ0xBU1MJPSAweDAwLAorCX07CisKKwkvKiBhbGxvdyBjcG9ydCBhdHRyaWJ1dGVzIHRv
IGJlIHNldCAqLworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoVF9DT05ORUNUSU9O
U1RBVEUpLCBDUE9SVF9JRExFKTsKKworCS8qIGxvY2FsIHVuaXBybyBhdHRyaWJ1dGVzICovCisJ
dWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihOX0RFVklDRUlEKSwgREVWX0lEKTsKKwl1
ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKE5fREVWSUNFSURfVkFMSUQpLCBUUlVFKTsK
Kwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFRfUEVFUkRFVklDRUlEKSwgUEVFUl9E
RVZfSUQpOworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoVF9QRUVSQ1BPUlRJRCks
IFBFRVJfQ1BPUlRfSUQpOworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoVF9DUE9S
VEZMQUdTKSwgQ1BPUlRfREVGX0ZMQUdTKTsKKwl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdf
TUlCKFRfVFJBRkZJQ0NMQVNTKSwgVFJBRkZJQ19DTEFTUyk7CisJdWZzaGNkX2RtZV9zZXQoaGJh
LCBVSUNfQVJHX01JQihUX0NPTk5FQ1RJT05TVEFURSksIENQT1JUX0NPTk5FQ1RFRCk7Cit9CisK
K3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfY29uZmlnX3NtdShzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZz
KQoreworCXUzMiByZWcsIHZhbDsKKworCWV4eW5vc191ZnNfZGlzYWJsZV9hdXRvX2N0cmxfaGNj
X3NhdmUodWZzLCAmdmFsKTsKKworCS8qIG1ha2UgZW5jcnlwdGlvbiBkaXNhYmxlZCBieSBkZWZh
dWx0ICovCisJcmVnID0gdWZzcF9yZWFkbCh1ZnMsIFVGU1BSU0VDVVJJVFkpOworCXVmc3Bfd3Jp
dGVsKHVmcywgcmVnIHwgTlNTTVUsIFVGU1BSU0VDVVJJVFkpOworCXVmc3Bfd3JpdGVsKHVmcywg
MHgwLCBVRlNQU0JFR0lOMCk7CisJdWZzcF93cml0ZWwodWZzLCAweGZmZmZmZmZmLCBVRlNQU0VO
RDApOworCXVmc3Bfd3JpdGVsKHVmcywgMHhmZiwgVUZTUFNMVU4wKTsKKwl1ZnNwX3dyaXRlbCh1
ZnMsIDB4ZjEsIFVGU1BTQ1RSTDApOworCisJZXh5bm9zX3Vmc19hdXRvX2N0cmxfaGNjX3Jlc3Rv
cmUodWZzLCAmdmFsKTsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19jb25maWdfc3luY19w
YXR0ZXJuX21hc2soc3RydWN0IGV4eW5vc191ZnMgKnVmcywKKwkJCQkJc3RydWN0IHVmc19wYV9s
YXllcl9hdHRyICpwd3IpCit7CisJc3RydWN0IHVmc19oYmEgKmhiYSA9IHVmcy0+aGJhOworCXU4
IGcgPSBtYXhfdCh1MzIsIHB3ci0+Z2Vhcl9yeCwgcHdyLT5nZWFyX3R4KTsKKwl1MzIgbWFzaywg
c3luY19sZW47CisJZW51bSB7CisJCVNZTkNfTEVOX0cxID0gODAgKiAxMDAwLCAvKiA4MHVzICov
CisJCVNZTkNfTEVOX0cyID0gNDAgKiAxMDAwLCAvKiA0NHVzICovCisJCVNZTkNfTEVOX0czID0g
MjAgKiAxMDAwLCAvKiAyMHVzICovCisJfTsKKwlpbnQgaTsKKworCWlmIChnID09IDEpCisJCXN5
bmNfbGVuID0gU1lOQ19MRU5fRzE7CisJZWxzZSBpZiAoZyA9PSAyKQorCQlzeW5jX2xlbiA9IFNZ
TkNfTEVOX0cyOworCWVsc2UgaWYgKGcgPT0gMykKKwkJc3luY19sZW4gPSBTWU5DX0xFTl9HMzsK
KwllbHNlCisJCXJldHVybjsKKworCW1hc2sgPSBleHlub3NfdWZzX2NhbGNfdGltZV9jbnRyKHVm
cywgc3luY19sZW4pOworCW1hc2sgPSAobWFzayA+PiA4KSAmIDB4ZmY7CisKKwlleHlub3NfdWZz
X2VuYWJsZV9vdl90bShoYmEpOworCisJZm9yX2VhY2hfdWZzX3J4X2xhbmUodWZzLCBpKQorCQl1
ZnNoY2RfZG1lX3NldChoYmEsCisJCQlVSUNfQVJHX01JQl9TRUwoUlhfU1lOQ19NQVNLX0xFTkdU
SCwgaSksIG1hc2spOworCisJZXh5bm9zX3Vmc19kaXNhYmxlX292X3RtKGhiYSk7Cit9CisKK3N0
YXRpYyBpbnQgZXh5bm9zX3Vmc19wcmVfcHdyX21vZGUoc3RydWN0IHVmc19oYmEgKmhiYSwKKwkJ
CQlzdHJ1Y3QgdWZzX3BhX2xheWVyX2F0dHIgKmRldl9tYXhfcGFyYW1zLAorCQkJCXN0cnVjdCB1
ZnNfcGFfbGF5ZXJfYXR0ciAqZGV2X3JlcV9wYXJhbXMpCit7CisJc3RydWN0IGV4eW5vc191ZnMg
KnVmcyA9IHVmc2hjZF9nZXRfdmFyaWFudChoYmEpOworCXN0cnVjdCBwaHkgKmdlbmVyaWNfcGh5
ID0gdWZzLT5waHk7CisJc3RydWN0IHVmc19kZXZfcGFyYW1zIHVmc19leHlub3NfY2FwOworCWlu
dCByZXQ7CisKKwlpZiAoIWRldl9yZXFfcGFyYW1zKSB7CisJCXByX2VycigiJXM6IGluY29taW5n
IGRldl9yZXFfcGFyYW1zIGlzIE5VTExcbiIsIF9fZnVuY19fKTsKKwkJcmV0ID0gLUVJTlZBTDsK
KwkJZ290byBvdXQ7CisJfQorCisKKwl1ZnNfZXh5bm9zX2NhcC50eF9sYW5lcyA9IFVGU19FWFlO
T1NfTElNSVRfTlVNX0xBTkVTX1RYOworCXVmc19leHlub3NfY2FwLnJ4X2xhbmVzID0gVUZTX0VY
WU5PU19MSU1JVF9OVU1fTEFORVNfUlg7CisJdWZzX2V4eW5vc19jYXAuaHNfcnhfZ2VhciA9IFVG
U19FWFlOT1NfTElNSVRfSFNHRUFSX1JYOworCXVmc19leHlub3NfY2FwLmhzX3R4X2dlYXIgPSBV
RlNfRVhZTk9TX0xJTUlUX0hTR0VBUl9UWDsKKwl1ZnNfZXh5bm9zX2NhcC5wd21fcnhfZ2VhciA9
IFVGU19FWFlOT1NfTElNSVRfUFdNR0VBUl9SWDsKKwl1ZnNfZXh5bm9zX2NhcC5wd21fdHhfZ2Vh
ciA9IFVGU19FWFlOT1NfTElNSVRfUFdNR0VBUl9UWDsKKwl1ZnNfZXh5bm9zX2NhcC5yeF9wd3Jf
cHdtID0gVUZTX0VYWU5PU19MSU1JVF9SWF9QV1JfUFdNOworCXVmc19leHlub3NfY2FwLnR4X3B3
cl9wd20gPSBVRlNfRVhZTk9TX0xJTUlUX1RYX1BXUl9QV007CisJdWZzX2V4eW5vc19jYXAucnhf
cHdyX2hzID0gVUZTX0VYWU5PU19MSU1JVF9SWF9QV1JfSFM7CisJdWZzX2V4eW5vc19jYXAudHhf
cHdyX2hzID0gVUZTX0VYWU5PU19MSU1JVF9UWF9QV1JfSFM7CisJdWZzX2V4eW5vc19jYXAuaHNf
cmF0ZSA9IFVGU19FWFlOT1NfTElNSVRfSFNfUkFURTsKKwl1ZnNfZXh5bm9zX2NhcC5kZXNpcmVk
X3dvcmtpbmdfbW9kZSA9CisJCQkJVUZTX0VYWU5PU19MSU1JVF9ERVNJUkVEX01PREU7CisKKwly
ZXQgPSB1ZnNoY2RfZ2V0X3B3cl9kZXZfcGFyYW0oJnVmc19leHlub3NfY2FwLAorCQkJCSAgICAg
ICBkZXZfbWF4X3BhcmFtcywgZGV2X3JlcV9wYXJhbXMpOworCWlmIChyZXQpIHsKKwkJcHJfZXJy
KCIlczogZmFpbGVkIHRvIGRldGVybWluZSBjYXBhYmlsaXRpZXNcbiIsIF9fZnVuY19fKTsKKwkJ
Z290byBvdXQ7CisJfQorCisJaWYgKHVmcy0+ZHJ2X2RhdGEtPnByZV9wd3JfY2hhbmdlKQorCQl1
ZnMtPmRydl9kYXRhLT5wcmVfcHdyX2NoYW5nZSh1ZnMsIGRldl9yZXFfcGFyYW1zKTsKKworCWlm
ICh1ZnNoY2RfaXNfaHNfbW9kZShkZXZfcmVxX3BhcmFtcykpIHsKKwkJZXh5bm9zX3Vmc19jb25m
aWdfc3luY19wYXR0ZXJuX21hc2sodWZzLCBkZXZfcmVxX3BhcmFtcyk7CisKKwkJc3dpdGNoIChk
ZXZfcmVxX3BhcmFtcy0+aHNfcmF0ZSkgeworCQljYXNlIFBBX0hTX01PREVfQToKKwkJY2FzZSBQ
QV9IU19NT0RFX0I6CisJCQlwaHlfY2FsaWJyYXRlKGdlbmVyaWNfcGh5KTsKKwkJCWJyZWFrOwor
CQl9CisJfQorCisJcmV0dXJuIDA7CitvdXQ6CisJcmV0dXJuIHJldDsKK30KKworI2RlZmluZSBQ
V1JfTU9ERV9TVFJfTEVOCTY0CitzdGF0aWMgaW50IGV4eW5vc191ZnNfcG9zdF9wd3JfbW9kZShz
dHJ1Y3QgdWZzX2hiYSAqaGJhLAorCQkJCXN0cnVjdCB1ZnNfcGFfbGF5ZXJfYXR0ciAqcHdyX21h
eCwKKwkJCQlzdHJ1Y3QgdWZzX3BhX2xheWVyX2F0dHIgKnB3cl9yZXEpCit7CisJc3RydWN0IGV4
eW5vc191ZnMgKnVmcyA9IHVmc2hjZF9nZXRfdmFyaWFudChoYmEpOworCXN0cnVjdCBwaHkgKmdl
bmVyaWNfcGh5ID0gdWZzLT5waHk7CisJaW50IGdlYXIgPSBtYXhfdCh1MzIsIHB3cl9yZXEtPmdl
YXJfcngsIHB3cl9yZXEtPmdlYXJfdHgpOworCWludCBsYW5lcyA9IG1heF90KHUzMiwgcHdyX3Jl
cS0+bGFuZV9yeCwgcHdyX3JlcS0+bGFuZV90eCk7CisJY2hhciBwd3Jfc3RyW1BXUl9NT0RFX1NU
Ul9MRU5dID0gIiI7CisKKwkvKiBsZXQgZGVmYXVsdCBiZSBQV00gR2VhciAxLCBMYW5lIDEgKi8K
KwlpZiAoIWdlYXIpCisJCWdlYXIgPSAxOworCisJaWYgKCFsYW5lcykKKwkJbGFuZXMgPSAxOwor
CisJaWYgKHVmcy0+ZHJ2X2RhdGEtPnBvc3RfcHdyX2NoYW5nZSkKKwkJdWZzLT5kcnZfZGF0YS0+
cG9zdF9wd3JfY2hhbmdlKHVmcywgcHdyX3JlcSk7CisKKwlpZiAoKHVmc2hjZF9pc19oc19tb2Rl
KHB3cl9yZXEpKSkgeworCQlzd2l0Y2ggKHB3cl9yZXEtPmhzX3JhdGUpIHsKKwkJY2FzZSBQQV9I
U19NT0RFX0E6CisJCWNhc2UgUEFfSFNfTU9ERV9COgorCQkJcGh5X2NhbGlicmF0ZShnZW5lcmlj
X3BoeSk7CisJCQlicmVhazsKKwkJfQorCisJCXNucHJpbnRmKHB3cl9zdHIsIFBXUl9NT0RFX1NU
Ul9MRU4sICIlcyBzZXJpZXNfJXMgR18lZCBMXyVkIiwKKwkJCSJGQVNUIiwJcHdyX3JlcS0+aHNf
cmF0ZSA9PSBQQV9IU19NT0RFX0EgPyAiQSIgOiAiQiIsCisJCQlnZWFyLCBsYW5lcyk7CisJfSBl
bHNlIHsKKwkJc25wcmludGYocHdyX3N0ciwgUFdSX01PREVfU1RSX0xFTiwgIiVzIEdfJWQgTF8l
ZCIsCisJCQkiU0xPVyIsIGdlYXIsIGxhbmVzKTsKKwl9CisKKwlkZXZfaW5mbyhoYmEtPmRldiwg
IlBvd2VyIG1vZGUgY2hhbmdlZCB0byA6ICVzXG4iLCBwd3Jfc3RyKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgdm9pZCBleHlub3NfdWZzX3NwZWNpZnlfbmV4dXNfdF94ZmVyX3JlcShzdHJ1
Y3QgdWZzX2hiYSAqaGJhLAorCQkJCQkJaW50IHRhZywgYm9vbCBvcCkKK3sKKwlzdHJ1Y3QgZXh5
bm9zX3VmcyAqdWZzID0gdWZzaGNkX2dldF92YXJpYW50KGhiYSk7CisJdTMyIHR5cGU7CisKKwl0
eXBlID0gIGhjaV9yZWFkbCh1ZnMsIEhDSV9VVFJMX05FWFVTX1RZUEUpOworCisJaWYgKG9wKQor
CQloY2lfd3JpdGVsKHVmcywgdHlwZSB8ICgxIDw8IHRhZyksIEhDSV9VVFJMX05FWFVTX1RZUEUp
OworCWVsc2UKKwkJaGNpX3dyaXRlbCh1ZnMsIHR5cGUgJiB+KDEgPDwgdGFnKSwgSENJX1VUUkxf
TkVYVVNfVFlQRSk7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfc3BlY2lmeV9uZXh1c190
X3RtX3JlcShzdHJ1Y3QgdWZzX2hiYSAqaGJhLAorCQkJCQkJaW50IHRhZywgdTggZnVuYykKK3sK
KwlzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzID0gdWZzaGNkX2dldF92YXJpYW50KGhiYSk7CisJdTMy
IHR5cGU7CisKKwl0eXBlID0gIGhjaV9yZWFkbCh1ZnMsIEhDSV9VVE1STF9ORVhVU19UWVBFKTsK
KworCXN3aXRjaCAoZnVuYykgeworCWNhc2UgVUZTX0FCT1JUX1RBU0s6CisJY2FzZSBVRlNfUVVF
UllfVEFTSzoKKwkJaGNpX3dyaXRlbCh1ZnMsIHR5cGUgfCAoMSA8PCB0YWcpLCBIQ0lfVVRNUkxf
TkVYVVNfVFlQRSk7CisJCWJyZWFrOworCWNhc2UgVUZTX0FCT1JUX1RBU0tfU0VUOgorCWNhc2Ug
VUZTX0NMRUFSX1RBU0tfU0VUOgorCWNhc2UgVUZTX0xPR0lDQUxfUkVTRVQ6CisJY2FzZSBVRlNf
UVVFUllfVEFTS19TRVQ6CisJCWhjaV93cml0ZWwodWZzLCB0eXBlICYgfigxIDw8IHRhZyksIEhD
SV9VVE1STF9ORVhVU19UWVBFKTsKKwkJYnJlYWs7CisJfQorfQorCitzdGF0aWMgdm9pZCBleHlu
b3NfdWZzX3BoeV9pbml0KHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IHVmc19o
YmEgKmhiYSA9IHVmcy0+aGJhOworCXN0cnVjdCBwaHkgKmdlbmVyaWNfcGh5ID0gdWZzLT5waHk7
CisKKwlpZiAodWZzLT5hdmFpbF9sbl9yeCA9PSAwIHx8IHVmcy0+YXZhaWxfbG5fdHggPT0gMCkg
eworCQl1ZnNoY2RfZG1lX2dldChoYmEsIFVJQ19BUkdfTUlCKFBBX0FWQUlMUlhEQVRBTEFORVMp
LAorCQkJJnVmcy0+YXZhaWxfbG5fcngpOworCQl1ZnNoY2RfZG1lX2dldChoYmEsIFVJQ19BUkdf
TUlCKFBBX0FWQUlMVFhEQVRBTEFORVMpLAorCQkJJnVmcy0+YXZhaWxfbG5fdHgpOworCQlXQVJO
KHVmcy0+YXZhaWxfbG5fcnggIT0gdWZzLT5hdmFpbF9sbl90eCwKKwkJCSJhdmFpbGFibGUgZGF0
YSBsYW5lIGlzIG5vdCBlcXVhbChyeDolZCwgdHg6JWQpXG4iLAorCQkJdWZzLT5hdmFpbF9sbl9y
eCwgdWZzLT5hdmFpbF9sbl90eCk7CisJfQorCisJcGh5X3NldF9idXNfd2lkdGgoZ2VuZXJpY19w
aHksIHVmcy0+YXZhaWxfbG5fcngpOworCXBoeV9pbml0KGdlbmVyaWNfcGh5KTsKK30KKworc3Rh
dGljIHZvaWQgZXh5bm9zX3Vmc19jb25maWdfdW5pcHJvKHN0cnVjdCBleHlub3NfdWZzICp1ZnMp
Cit7CisJc3RydWN0IHVmc19oYmEgKmhiYSA9IHVmcy0+aGJhOworCisJdWZzaGNkX2RtZV9zZXQo
aGJhLCBVSUNfQVJHX01JQihQQV9EQkdfQ0xLX1BFUklPRCksCisJCURJVl9ST1VORF9VUChOU0VD
X1BFUl9TRUMsIHVmcy0+bWNsa19yYXRlKSk7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJH
X01JQihQQV9UWFRSQUlMSU5HQ0xPQ0tTKSwKKwkJCXVmcy0+ZHJ2X2RhdGEtPnVpY19hdHRyLT50
eF90cmFpbGluZ2Nsa3MpOworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FSR19NSUIoUEFfREJH
X09QVElPTl9TVUlURSksCisJCQl1ZnMtPmRydl9kYXRhLT51aWNfYXR0ci0+cGFfZGJnX29wdGlv
bl9zdWl0ZSk7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfY29uZmlnX2ludHIoc3RydWN0
IGV4eW5vc191ZnMgKnVmcywgdTMyIGVycnMsIHU4IGluZGV4KQoreworCXN3aXRjaCAoaW5kZXgp
IHsKKwljYXNlIFVOSVBST19MMV81OgorCQloY2lfd3JpdGVsKHVmcywgREZFU19FUlJfRU4gfCBl
cnJzLCBIQ0lfRVJSX0VOX1BBX0xBWUVSKTsKKwkJYnJlYWs7CisJY2FzZSBVTklQUk9fTDI6CisJ
CWhjaV93cml0ZWwodWZzLCBERkVTX0VSUl9FTiB8IGVycnMsIEhDSV9FUlJfRU5fRExfTEFZRVIp
OworCQlicmVhazsKKwljYXNlIFVOSVBST19MMzoKKwkJaGNpX3dyaXRlbCh1ZnMsIERGRVNfRVJS
X0VOIHwgZXJycywgSENJX0VSUl9FTl9OX0xBWUVSKTsKKwkJYnJlYWs7CisJY2FzZSBVTklQUk9f
TDQ6CisJCWhjaV93cml0ZWwodWZzLCBERkVTX0VSUl9FTiB8IGVycnMsIEhDSV9FUlJfRU5fVF9M
QVlFUik7CisJCWJyZWFrOworCWNhc2UgVU5JUFJPX0RNRToKKwkJaGNpX3dyaXRlbCh1ZnMsIERG
RVNfRVJSX0VOIHwgZXJycywgSENJX0VSUl9FTl9ETUVfTEFZRVIpOworCQlicmVhazsKKwl9Cit9
CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19wcmVfbGluayhzdHJ1Y3QgdWZzX2hiYSAqaGJhKQor
eworCXN0cnVjdCBleHlub3NfdWZzICp1ZnMgPSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKwor
CS8qIGhjaSAqLworCWV4eW5vc191ZnNfY29uZmlnX2ludHIodWZzLCBERkVTX0RFRl9MMl9FUlJT
LCBVTklQUk9fTDIpOworCWV4eW5vc191ZnNfY29uZmlnX2ludHIodWZzLCBERkVTX0RFRl9MM19F
UlJTLCBVTklQUk9fTDMpOworCWV4eW5vc191ZnNfY29uZmlnX2ludHIodWZzLCBERkVTX0RFRl9M
NF9FUlJTLCBVTklQUk9fTDQpOworCWV4eW5vc191ZnNfc2V0X3VuaXByb19wY2xrX2Rpdih1ZnMp
OworCisJLyogdW5pcHJvICovCisJZXh5bm9zX3Vmc19jb25maWdfdW5pcHJvKHVmcyk7CisKKwkv
KiBtLXBoeSAqLworCWV4eW5vc191ZnNfcGh5X2luaXQodWZzKTsKKwlleHlub3NfdWZzX2NvbmZp
Z19waHlfdGltZV9hdHRyKHVmcyk7CisJZXh5bm9zX3Vmc19jb25maWdfcGh5X2NhcF9hdHRyKHVm
cyk7CisKKwlpZiAodWZzLT5kcnZfZGF0YS0+cHJlX2xpbmspCisJCXVmcy0+ZHJ2X2RhdGEtPnBy
ZV9saW5rKHVmcyk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19m
aXRfYWdncl90aW1lb3V0KHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJdTMyIHZhbDsKKwor
CXZhbCA9IGV4eW5vc191ZnNfY2FsY190aW1lX2NudHIodWZzLCBJQVRPVkFMX05TRUMgLyBDTlRS
X0RJVl9WQUwpOworCWhjaV93cml0ZWwodWZzLCB2YWwgJiBDTlRfVkFMXzFVU19NQVNLLCBIQ0lf
MVVTX1RPX0NOVF9WQUwpOworfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfcG9zdF9saW5rKHN0
cnVjdCB1ZnNfaGJhICpoYmEpCit7CisJc3RydWN0IGV4eW5vc191ZnMgKnVmcyA9IHVmc2hjZF9n
ZXRfdmFyaWFudChoYmEpOworCXN0cnVjdCBwaHkgKmdlbmVyaWNfcGh5ID0gdWZzLT5waHk7CisJ
c3RydWN0IGV4eW5vc191ZnNfdWljX2F0dHIgKmF0dHIgPSB1ZnMtPmRydl9kYXRhLT51aWNfYXR0
cjsKKworCWV4eW5vc191ZnNfZXN0YWJsaXNoX2Nvbm50KHVmcyk7CisJZXh5bm9zX3Vmc19maXRf
YWdncl90aW1lb3V0KHVmcyk7CisKKwloY2lfd3JpdGVsKHVmcywgMHhhLCBIQ0lfREFUQV9SRU9S
REVSKTsKKwloY2lfd3JpdGVsKHVmcywgUFJEVF9TRVRfU0laRSgxMiksIEhDSV9UWFBSRFRfRU5U
UllfU0laRSk7CisJaGNpX3dyaXRlbCh1ZnMsIFBSRFRfU0VUX1NJWkUoMTIpLCBIQ0lfUlhQUkRU
X0VOVFJZX1NJWkUpOworCWhjaV93cml0ZWwodWZzLCAoMSA8PCBoYmEtPm51dHJzKSAtIDEsIEhD
SV9VVFJMX05FWFVTX1RZUEUpOworCWhjaV93cml0ZWwodWZzLCAoMSA8PCBoYmEtPm51dG1ycykg
LSAxLCBIQ0lfVVRNUkxfTkVYVVNfVFlQRSk7CisJaGNpX3dyaXRlbCh1ZnMsIDB4ZiwgSENJX0FY
SURNQV9SV0RBVEFfQlVSU1RfTEVOKTsKKworCWlmICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09Q
VF9TS0lQX0NPTk5FQ1RJT05fRVNUQUIpCisJCXVmc2hjZF9kbWVfc2V0KGhiYSwKKwkJCVVJQ19B
UkdfTUlCKFRfREJHX1NLSVBfSU5JVF9ISUJFUk44X0VYSVQpLCBUUlVFKTsKKworCWlmIChhdHRy
LT5wYV9ncmFudWxhcml0eSkgeworCQlleHlub3NfdWZzX2VuYWJsZV9kYmdfbW9kZShoYmEpOwor
CQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0dSQU5VTEFSSVRZKSwKKwkJCQlh
dHRyLT5wYV9ncmFudWxhcml0eSk7CisJCWV4eW5vc191ZnNfZGlzYWJsZV9kYmdfbW9kZShoYmEp
OworCisJCWlmIChhdHRyLT5wYV90YWN0aXZhdGUpCisJCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJ
Q19BUkdfTUlCKFBBX1RBQ1RJVkFURSksCisJCQkJCWF0dHItPnBhX3RhY3RpdmF0ZSk7CisJCWlm
IChhdHRyLT5wYV9oaWJlcm44dGltZSAmJgorCQkgICAgISh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZT
X09QVF9VU0VfU1dfSElCRVJOOF9USU1FUikpCisJCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19B
UkdfTUlCKFBBX0hJQkVSTjhUSU1FKSwKKwkJCQkJYXR0ci0+cGFfaGliZXJuOHRpbWUpOworCX0K
KworCWlmICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09QVF9VU0VfU1dfSElCRVJOOF9USU1FUikg
eworCQlpZiAoIWF0dHItPnBhX2dyYW51bGFyaXR5KQorCQkJdWZzaGNkX2RtZV9nZXQoaGJhLCBV
SUNfQVJHX01JQihQQV9HUkFOVUxBUklUWSksCisJCQkJCSZhdHRyLT5wYV9ncmFudWxhcml0eSk7
CisJCWlmICghYXR0ci0+cGFfaGliZXJuOHRpbWUpCisJCQl1ZnNoY2RfZG1lX2dldChoYmEsIFVJ
Q19BUkdfTUlCKFBBX0hJQkVSTjhUSU1FKSwKKwkJCQkJJmF0dHItPnBhX2hpYmVybjh0aW1lKTsK
KwkJLyoKKwkJICogbm90IHdhaXQgZm9yIEhJQkVSTjggdGltZSB0byBleGl0IGhpYmVybmF0aW9u
CisJCSAqLworCQl1ZnNoY2RfZG1lX3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0hJQkVSTjhUSU1F
KSwgMCk7CisKKwkJaWYgKGF0dHItPnBhX2dyYW51bGFyaXR5IDwgMSB8fCBhdHRyLT5wYV9ncmFu
dWxhcml0eSA+IDYpIHsKKwkJCS8qIFZhbGlkIHJhbmdlIGZvciBncmFudWxhcml0eTogMSB+IDYg
Ki8KKwkJCWRldl93YXJuKGhiYS0+ZGV2LAorCQkJCSIlczogcGFfZ3JhbnVsYXJ0eSAlZCBpcyBp
bnZhbGlkLCBhc3N1bWluZyBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxuIiwKKwkJCQlfX2Z1bmNf
XywKKwkJCQlhdHRyLT5wYV9ncmFudWxhcml0eSk7CisJCQlhdHRyLT5wYV9ncmFudWxhcml0eSA9
IDY7CisJCX0KKwl9CisKKwlwaHlfY2FsaWJyYXRlKGdlbmVyaWNfcGh5KTsKKworCWlmICh1ZnMt
PmRydl9kYXRhLT5wb3N0X2xpbmspCisJCXVmcy0+ZHJ2X2RhdGEtPnBvc3RfbGluayh1ZnMpOwor
CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19wYXJzZV9kdChzdHJ1Y3Qg
ZGV2aWNlICpkZXYsIHN0cnVjdCBleHlub3NfdWZzICp1ZnMpCit7CisJc3RydWN0IGRldmljZV9u
b2RlICpucCA9IGRldi0+b2Zfbm9kZTsKKwlzdHJ1Y3QgZXh5bm9zX3Vmc19kcnZfZGF0YSAqZHJ2
X2RhdGEgPSAmZXh5bm9zX3Vmc19kcnZzOworCXN0cnVjdCBleHlub3NfdWZzX3VpY19hdHRyICph
dHRyOworCXUzMiBmcmVxWzJdOworCWludCByZXQ7CisKKwl3aGlsZSAoZHJ2X2RhdGEtPmNvbXBh
dGlibGUpIHsKKwkJaWYgKG9mX2RldmljZV9pc19jb21wYXRpYmxlKG5wLCBkcnZfZGF0YS0+Y29t
cGF0aWJsZSkpIHsKKwkJCXVmcy0+ZHJ2X2RhdGEgPSBkcnZfZGF0YTsKKwkJCWJyZWFrOworCQl9
CisJCWRydl9kYXRhKys7CisJfQorCisJaWYgKHVmcy0+ZHJ2X2RhdGEgJiYgdWZzLT5kcnZfZGF0
YS0+dWljX2F0dHIpIHsKKwkJYXR0ciA9IHVmcy0+ZHJ2X2RhdGEtPnVpY19hdHRyOworCX0gZWxz
ZSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGdldCB1aWMgYXR0cmlidXRlc1xuIik7CisJ
CXJldCA9IC1FSU5WQUw7CisJCWdvdG8gb3V0OworCX0KKworCXJldCA9IG9mX3Byb3BlcnR5X3Jl
YWRfdTMyX2FycmF5KG5wLAorCQkJInBjbGstZnJlcS1hdmFpbC1yYW5nZSIsIGZyZXEsIEFSUkFZ
X1NJWkUoZnJlcSkpOworCWlmICghcmV0KSB7CisJCXVmcy0+cGNsa19hdmFpbF9taW4gPSBmcmVx
WzBdOworCQl1ZnMtPnBjbGtfYXZhaWxfbWF4ID0gZnJlcVsxXTsKKwl9IGVsc2UgeworCQlkZXZf
ZXJyKGRldiwgImZhaWxlZCB0byBnZXQgYXZhaWxhYmxlIHBjbGsgcmFuZ2VcbiIpOworCQlnb3Rv
IG91dDsKKwl9CisKKwlhdHRyLT5yeF9hZHZfZmluZV9ncmFuX3N1cF9lbiA9IFJYX0FEVl9GSU5F
X0dSQU5fU1VQX0VOOworCWF0dHItPnJ4X2Fkdl9maW5lX2dyYW5fc3RlcCA9IFJYX0FEVl9GSU5F
X0dSQU5fU1RFUF9WQUw7CisJYXR0ci0+cnhfYWR2X21pbl9hY3R2X3RpbWVfY2FwID0gUlhfQURW
X01JTl9BQ1RWX1RJTUVfQ0FQOworCWF0dHItPnBhX2dyYW51bGFyaXR5ID0gUEFfR1JBTlVMQVJJ
VFlfVkFMOworCWF0dHItPnBhX3RhY3RpdmF0ZSA9IFBBX1RBQ1RJVkFURV9WQUw7CisJYXR0ci0+
cGFfaGliZXJuOHRpbWUgPSBQQV9ISUJFUk44VElNRV9WQUw7CisKK291dDoKKwlyZXR1cm4gcmV0
OworfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNfaW5pdChzdHJ1Y3QgdWZzX2hiYSAqaGJhKQor
eworCXN0cnVjdCBkZXZpY2UgKmRldiA9IGhiYS0+ZGV2OworCXN0cnVjdCBwbGF0Zm9ybV9kZXZp
Y2UgKnBkZXYgPSB0b19wbGF0Zm9ybV9kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgZXh5bm9zX3VmcyAq
dWZzOworCXN0cnVjdCByZXNvdXJjZSAqcmVzOworCWludCByZXQ7CisKKwl1ZnMgPSBkZXZtX2t6
YWxsb2MoZGV2LCBzaXplb2YoKnVmcyksIEdGUF9LRVJORUwpOworCWlmICghdWZzKQorCQlyZXR1
cm4gLUVOT01FTTsKKworCS8qIGV4eW5vcy1zcGVjaWZpYyBoY2kgKi8KKwlyZXMgPSBwbGF0Zm9y
bV9nZXRfcmVzb3VyY2VfYnluYW1lKHBkZXYsIElPUkVTT1VSQ0VfTUVNLCAidnNfaGNpIik7CisJ
dWZzLT5yZWdfaGNpID0gZGV2bV9pb3JlbWFwX3Jlc291cmNlKGRldiwgcmVzKTsKKwlpZiAoIXVm
cy0+cmVnX2hjaSkgeworCQlkZXZfZXJyKGRldiwgImNhbm5vdCBpb3JlbWFwIGZvciBoY2kgdmVu
ZG9yIHJlZ2lzdGVyXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJfQorCisJLyogdW5pcHJvICov
CisJcmVzID0gcGxhdGZvcm1fZ2V0X3Jlc291cmNlX2J5bmFtZShwZGV2LCBJT1JFU09VUkNFX01F
TSwgInVuaXBybyIpOworCXVmcy0+cmVnX3VuaXBybyA9IGRldm1faW9yZW1hcF9yZXNvdXJjZShk
ZXYsIHJlcyk7CisJaWYgKCF1ZnMtPnJlZ191bmlwcm8pIHsKKwkJZGV2X2VycihkZXYsICJjYW5u
b3QgaW9yZW1hcCBmb3IgdW5pcHJvIHJlZ2lzdGVyXG4iKTsKKwkJcmV0dXJuIC1FTk9NRU07CisJ
fQorCisJLyogdWZzIHByb3RlY3RvciAqLworCXJlcyA9IHBsYXRmb3JtX2dldF9yZXNvdXJjZV9i
eW5hbWUocGRldiwgSU9SRVNPVVJDRV9NRU0sICJ1ZnNwIik7CisJdWZzLT5yZWdfdWZzcCA9IGRl
dm1faW9yZW1hcF9yZXNvdXJjZShkZXYsIHJlcyk7CisJaWYgKCF1ZnMtPnJlZ191ZnNwKSB7CisJ
CWRldl9lcnIoZGV2LCAiY2Fubm90IGlvcmVtYXAgZm9yIHVmcyBwcm90ZWN0b3IgcmVnaXN0ZXJc
biIpOworCQlyZXR1cm4gLUVOT01FTTsKKwl9CisKKwlyZXQgPSBleHlub3NfdWZzX3BhcnNlX2R0
KGRldiwgdWZzKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGdldCBk
dCBpbmZvLlxuIik7CisJCWdvdG8gb3V0OworCX0KKworCXVmcy0+cGh5ID0gZGV2bV9waHlfZ2V0
KGRldiwgInVmcy1waHkiKTsKKwlpZiAoSVNfRVJSKHVmcy0+cGh5KSkgeworCQlyZXQgPSBQVFJf
RVJSKHVmcy0+cGh5KTsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gZ2V0IHVmcy1waHlcbiIp
OworCQlnb3RvIG91dDsKKwl9CisKKwlyZXQgPSBwaHlfcG93ZXJfb24odWZzLT5waHkpOworCWlm
IChyZXQpCisJCWdvdG8gcGh5X2V4aXQ7CisKKwl1ZnMtPmhiYSA9IGhiYTsKKwl1ZnMtPm9wdHMg
PSB1ZnMtPmRydl9kYXRhLT5vcHRzIHwKKwkJRVhZTk9TX1VGU19PUFRfU0tJUF9DT05ORUNUSU9O
X0VTVEFCIHwKKwkJRVhZTk9TX1VGU19PUFRfVVNFX1NXX0hJQkVSTjhfVElNRVI7CisJdWZzLT5y
eF9zZWxfaWR4ID0gUEFfTUFYREFUQUxBTkVTOworCWlmICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZT
X09QVF9CUk9LRU5fUlhfU0VMX0lEWCkKKwkJdWZzLT5yeF9zZWxfaWR4ID0gMDsKKwloYmEtPnBy
aXYgPSAodm9pZCAqKXVmczsKKwloYmEtPnF1aXJrcyA9IHVmcy0+ZHJ2X2RhdGEtPnF1aXJrczsK
KwlpZiAodWZzLT5kcnZfZGF0YS0+ZHJ2X2luaXQpIHsKKwkJcmV0ID0gdWZzLT5kcnZfZGF0YS0+
ZHJ2X2luaXQoZGV2LCB1ZnMpOworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJyKGRldiwgImZhaWxl
ZCB0byBpbml0IGRydi1kYXRhXG4iKTsKKwkJCWdvdG8gcGh5X29mZjsKKwkJfQorCX0KKworCXJl
dCA9IGV4eW5vc191ZnNfZ2V0X2Nsa19pbmZvKHVmcyk7CisJaWYgKHJldCkKKwkJZ290byBwaHlf
b2ZmOworCWV4eW5vc191ZnNfc3BlY2lmeV9waHlfdGltZV9hdHRyKHVmcyk7CisJZXh5bm9zX3Vm
c19jb25maWdfc211KHVmcyk7CisJcmV0dXJuIDA7CisKK3BoeV9vZmY6CisJcGh5X3Bvd2VyX29m
Zih1ZnMtPnBoeSk7CitwaHlfZXhpdDoKKwlwaHlfZXhpdCh1ZnMtPnBoeSk7CisJaGJhLT5wcml2
ID0gTlVMTDsKK291dDoKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGV4eW5vc191ZnNf
aG9zdF9yZXNldChzdHJ1Y3QgdWZzX2hiYSAqaGJhKQoreworCXN0cnVjdCBleHlub3NfdWZzICp1
ZnMgPSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKwl1bnNpZ25lZCBsb25nIHRpbWVvdXQgPSBq
aWZmaWVzICsgbXNlY3NfdG9famlmZmllcygxKTsKKwl1MzIgdmFsOworCWludCByZXQgPSAwOwor
CisJZXh5bm9zX3Vmc19kaXNhYmxlX2F1dG9fY3RybF9oY2Nfc2F2ZSh1ZnMsICZ2YWwpOworCisJ
aGNpX3dyaXRlbCh1ZnMsIFVGU19TV19SU1RfTUFTSywgSENJX1NXX1JTVCk7CisKKwlkbyB7CisJ
CWlmICghKGhjaV9yZWFkbCh1ZnMsIEhDSV9TV19SU1QpICYgVUZTX1NXX1JTVF9NQVNLKSkKKwkJ
CWdvdG8gb3V0OworCX0gd2hpbGUgKHRpbWVfYmVmb3JlKGppZmZpZXMsIHRpbWVvdXQpKTsKKwor
CWRldl9lcnIoaGJhLT5kZXYsICJ0aW1lb3V0IGhvc3Qgc3ctcmVzZXRcbiIpOworCXJldCA9IC1F
VElNRURPVVQ7CisKK291dDoKKwlleHlub3NfdWZzX2F1dG9fY3RybF9oY2NfcmVzdG9yZSh1ZnMs
ICZ2YWwpOworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfZGV2X2h3
X3Jlc2V0KHN0cnVjdCB1ZnNfaGJhICpoYmEpCit7CisJc3RydWN0IGV4eW5vc191ZnMgKnVmcyA9
IHVmc2hjZF9nZXRfdmFyaWFudChoYmEpOworCisJaGNpX3dyaXRlbCh1ZnMsIDAgPDwgMCwgSENJ
X0dQSU9fT1VUKTsKKwl1ZGVsYXkoNSk7CisJaGNpX3dyaXRlbCh1ZnMsIDEgPDwgMCwgSENJX0dQ
SU9fT1VUKTsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vmc19wcmVfaGliZXJuOChzdHJ1Y3Qg
dWZzX2hiYSAqaGJhLCB1OCBlbnRlcikKK3sKKwlzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzID0gdWZz
aGNkX2dldF92YXJpYW50KGhiYSk7CisJc3RydWN0IGV4eW5vc191ZnNfdWljX2F0dHIgKmF0dHIg
PSB1ZnMtPmRydl9kYXRhLT51aWNfYXR0cjsKKworCWlmICghZW50ZXIpIHsKKwkJaWYgKHVmcy0+
b3B0cyAmIEVYWU5PU19VRlNfT1BUX0JST0tFTl9BVVRPX0NMS19DVFJMKQorCQkJZXh5bm9zX3Vm
c19kaXNhYmxlX2F1dG9fY3RybF9oY2ModWZzKTsKKwkJZXh5bm9zX3Vmc191bmdhdGVfY2xrcyh1
ZnMpOworCisJCWlmICh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09QVF9VU0VfU1dfSElCRVJOOF9U
SU1FUikgeworCQkJY29uc3QgdW5zaWduZWQgaW50IGdyYW51bGFyaXR5X3RibFtdID0geworCQkJ
CTEsIDQsIDgsIDE2LCAzMiwgMTAwCisJCQl9OworCQkJaW50IGg4X3RpbWUgPSBhdHRyLT5wYV9o
aWJlcm44dGltZSAqCisJCQkJZ3JhbnVsYXJpdHlfdGJsW2F0dHItPnBhX2dyYW51bGFyaXR5IC0g
MV07CisJCQl1bnNpZ25lZCBsb25nIHVzOworCQkJczY0IGRlbHRhOworCisJCQlkbyB7CisJCQkJ
ZGVsdGEgPSBoOF90aW1lIC0ga3RpbWVfdXNfZGVsdGEoa3RpbWVfZ2V0KCksCisJCQkJCQkJdWZz
LT5lbnRyeV9oaWJlcm44X3QpOworCQkJCWlmIChkZWx0YSA8PSAwKQorCQkJCQlicmVhazsKKwor
CQkJCXVzID0gbWluX3QoczY0LCBkZWx0YSwgVVNFQ19QRVJfTVNFQyk7CisJCQkJaWYgKHVzID49
IDEwKQorCQkJCQl1c2xlZXBfcmFuZ2UodXMsIHVzICsgMTApOworCQkJfSB3aGlsZSAoMSk7CisJ
CX0KKwl9Cit9CisKK3N0YXRpYyB2b2lkIGV4eW5vc191ZnNfcG9zdF9oaWJlcm44KHN0cnVjdCB1
ZnNfaGJhICpoYmEsIHU4IGVudGVyKQoreworCXN0cnVjdCBleHlub3NfdWZzICp1ZnMgPSB1ZnNo
Y2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKworCWlmICghZW50ZXIpIHsKKwkJdTMyIGN1cl9tb2RlID0g
MDsKKwkJdTMyIHB3cm1vZGU7CisKKwkJaWYgKHVmc2hjZF9pc19oc19tb2RlKCZ1ZnMtPmRldl9y
ZXFfcGFyYW1zKSkKKwkJCXB3cm1vZGUgPSBGQVNUX01PREU7CisJCWVsc2UKKwkJCXB3cm1vZGUg
PSBTTE9XX01PREU7CisKKwkJdWZzaGNkX2RtZV9nZXQoaGJhLCBVSUNfQVJHX01JQihQQV9QV1JN
T0RFKSwgJmN1cl9tb2RlKTsKKwkJaWYgKGN1cl9tb2RlICE9IChwd3Jtb2RlIDw8IDQgfCBwd3Jt
b2RlKSkgeworCQkJZGV2X3dhcm4oaGJhLT5kZXYsICIlczogcG93ZXIgbW9kZSBjaGFuZ2VcbiIs
IF9fZnVuY19fKTsKKwkJCWhiYS0+cHdyX2luZm8ucHdyX3J4ID0gKGN1cl9tb2RlID4+IDQpICYg
MHhmOworCQkJaGJhLT5wd3JfaW5mby5wd3JfdHggPSBjdXJfbW9kZSAmIDB4ZjsKKwkJCXVmc2hj
ZF9jb25maWdfcHdyX21vZGUoaGJhLCAmaGJhLT5tYXhfcHdyX2luZm8uaW5mbyk7CisJCX0KKwor
CQlpZiAoISh1ZnMtPm9wdHMgJiBFWFlOT1NfVUZTX09QVF9TS0lQX0NPTk5FQ1RJT05fRVNUQUIp
KQorCQkJZXh5bm9zX3Vmc19lc3RhYmxpc2hfY29ubnQodWZzKTsKKwl9IGVsc2UgeworCQl1ZnMt
PmVudHJ5X2hpYmVybjhfdCA9IGt0aW1lX2dldCgpOworCQlleHlub3NfdWZzX2dhdGVfY2xrcyh1
ZnMpOworCQlpZiAodWZzLT5vcHRzICYgRVhZTk9TX1VGU19PUFRfQlJPS0VOX0FVVE9fQ0xLX0NU
UkwpCisJCQlleHlub3NfdWZzX2VuYWJsZV9hdXRvX2N0cmxfaGNjKHVmcyk7CisJfQorfQorCitz
dGF0aWMgaW50IGV4eW5vc191ZnNfaGNlX2VuYWJsZV9ub3RpZnkoc3RydWN0IHVmc19oYmEgKmhi
YSwKKwkJCQkJZW51bSB1ZnNfbm90aWZ5X2NoYW5nZV9zdGF0dXMgc3RhdHVzKQoreworCXN0cnVj
dCBleHlub3NfdWZzICp1ZnMgPSB1ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKwlpbnQgcmV0ID0g
MDsKKworCXN3aXRjaCAoc3RhdHVzKSB7CisJY2FzZSBQUkVfQ0hBTkdFOgorCQlyZXQgPSBleHlu
b3NfdWZzX2hvc3RfcmVzZXQoaGJhKTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7CisJCWV4
eW5vc191ZnNfZGV2X2h3X3Jlc2V0KGhiYSk7CisJCWJyZWFrOworCWNhc2UgUE9TVF9DSEFOR0U6
CisJCWV4eW5vc191ZnNfY2FsY19wd21fY2xrX2Rpdih1ZnMpOworCQlpZiAoISh1ZnMtPm9wdHMg
JiBFWFlOT1NfVUZTX09QVF9CUk9LRU5fQVVUT19DTEtfQ1RSTCkpCisJCQlleHlub3NfdWZzX2Vu
YWJsZV9hdXRvX2N0cmxfaGNjKHVmcyk7CisJCWJyZWFrOworCX0KKworCXJldHVybiByZXQ7Cit9
CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19saW5rX3N0YXJ0dXBfbm90aWZ5KHN0cnVjdCB1ZnNf
aGJhICpoYmEsCisJCQkJCSAgZW51bSB1ZnNfbm90aWZ5X2NoYW5nZV9zdGF0dXMgc3RhdHVzKQor
eworCWludCByZXQgPSAwOworCisJc3dpdGNoIChzdGF0dXMpIHsKKwljYXNlIFBSRV9DSEFOR0U6
CisJCXJldCA9IGV4eW5vc191ZnNfcHJlX2xpbmsoaGJhKTsKKwkJYnJlYWs7CisJY2FzZSBQT1NU
X0NIQU5HRToKKwkJcmV0ID0gZXh5bm9zX3Vmc19wb3N0X2xpbmsoaGJhKTsKKwkJYnJlYWs7CisJ
fQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIGludCBleHlub3NfdWZzX3B3cl9jaGFuZ2Vf
bm90aWZ5KHN0cnVjdCB1ZnNfaGJhICpoYmEsCisJCQkJZW51bSB1ZnNfbm90aWZ5X2NoYW5nZV9z
dGF0dXMgc3RhdHVzLAorCQkJCXN0cnVjdCB1ZnNfcGFfbGF5ZXJfYXR0ciAqZGV2X21heF9wYXJh
bXMsCisJCQkJc3RydWN0IHVmc19wYV9sYXllcl9hdHRyICpkZXZfcmVxX3BhcmFtcykKK3sKKwlp
bnQgcmV0ID0gMDsKKworCXN3aXRjaCAoc3RhdHVzKSB7CisJY2FzZSBQUkVfQ0hBTkdFOgorCQly
ZXQgPSBleHlub3NfdWZzX3ByZV9wd3JfbW9kZShoYmEsIGRldl9tYXhfcGFyYW1zLAorCQkJCQkg
ICAgICBkZXZfcmVxX3BhcmFtcyk7CisJCWJyZWFrOworCWNhc2UgUE9TVF9DSEFOR0U6CisJCXJl
dCA9IGV4eW5vc191ZnNfcG9zdF9wd3JfbW9kZShoYmEsIE5VTEwsIGRldl9yZXFfcGFyYW1zKTsK
KwkJYnJlYWs7CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHZvaWQgZXh5bm9zX3Vm
c19oaWJlcm44X25vdGlmeShzdHJ1Y3QgdWZzX2hiYSAqaGJhLAorCQkJCSAgICAgZW51bSB1aWNf
Y21kX2RtZSBlbnRlciwKKwkJCQkgICAgIGVudW0gdWZzX25vdGlmeV9jaGFuZ2Vfc3RhdHVzIG5v
dGlmeSkKK3sKKwlzd2l0Y2ggKCh1OClub3RpZnkpIHsKKwljYXNlIFBSRV9DSEFOR0U6CisJCWV4
eW5vc191ZnNfcHJlX2hpYmVybjgoaGJhLCBlbnRlcik7CisJCWJyZWFrOworCWNhc2UgUE9TVF9D
SEFOR0U6CisJCWV4eW5vc191ZnNfcG9zdF9oaWJlcm44KGhiYSwgZW50ZXIpOworCQlicmVhazsK
Kwl9Cit9CisKK3N0YXRpYyBpbnQgZXh5bm9zX3Vmc19zdXNwZW5kKHN0cnVjdCB1ZnNfaGJhICpo
YmEsIGVudW0gdWZzX3BtX29wIHBtX29wKQoreworCXN0cnVjdCBleHlub3NfdWZzICp1ZnMgPSB1
ZnNoY2RfZ2V0X3ZhcmlhbnQoaGJhKTsKKworCWlmICghdWZzaGNkX2lzX2xpbmtfYWN0aXZlKGhi
YSkpCisJCXBoeV9wb3dlcl9vZmYodWZzLT5waHkpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRp
YyBpbnQgZXh5bm9zX3Vmc19yZXN1bWUoc3RydWN0IHVmc19oYmEgKmhiYSwgZW51bSB1ZnNfcG1f
b3AgcG1fb3ApCit7CisJc3RydWN0IGV4eW5vc191ZnMgKnVmcyA9IHVmc2hjZF9nZXRfdmFyaWFu
dChoYmEpOworCisJaWYgKCF1ZnNoY2RfaXNfbGlua19hY3RpdmUoaGJhKSkKKwkJcGh5X3Bvd2Vy
X29uKHVmcy0+cGh5KTsKKworCWV4eW5vc191ZnNfY29uZmlnX3NtdSh1ZnMpOworCisJcmV0dXJu
IDA7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgdWZzX2hiYV92YXJpYW50X29wcyB1ZnNfaGJhX2V4eW5v
c19vcHMgPSB7CisJLm5hbWUJCQkJPSAiZXh5bm9zX3VmcyIsCisJLmluaXQJCQkJPSBleHlub3Nf
dWZzX2luaXQsCisJLmhjZV9lbmFibGVfbm90aWZ5CQk9IGV4eW5vc191ZnNfaGNlX2VuYWJsZV9u
b3RpZnksCisJLmxpbmtfc3RhcnR1cF9ub3RpZnkJCT0gZXh5bm9zX3Vmc19saW5rX3N0YXJ0dXBf
bm90aWZ5LAorCS5wd3JfY2hhbmdlX25vdGlmeQkJPSBleHlub3NfdWZzX3B3cl9jaGFuZ2Vfbm90
aWZ5LAorCS5zZXR1cF94ZmVyX3JlcQkJCT0gZXh5bm9zX3Vmc19zcGVjaWZ5X25leHVzX3RfeGZl
cl9yZXEsCisJLnNldHVwX3Rhc2tfbWdtdAkJPSBleHlub3NfdWZzX3NwZWNpZnlfbmV4dXNfdF90
bV9yZXEsCisJLmhpYmVybjhfbm90aWZ5CQkJPSBleHlub3NfdWZzX2hpYmVybjhfbm90aWZ5LAor
CS5zdXNwZW5kCQkJPSBleHlub3NfdWZzX3N1c3BlbmQsCisJLnJlc3VtZQkJCQk9IGV4eW5vc191
ZnNfcmVzdW1lLAorfTsKKworc3RhdGljIGludCBleHlub3NfdWZzX3Byb2JlKHN0cnVjdCBwbGF0
Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJaW50IGVycjsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAm
cGRldi0+ZGV2OworCisJZXJyID0gdWZzaGNkX3BsdGZybV9pbml0KHBkZXYsICZ1ZnNfaGJhX2V4
eW5vc19vcHMpOworCWlmIChlcnIpCisJCWRldl9lcnIoZGV2LCAidWZzaGNkX3BsdGZybV9pbml0
KCkgZmFpbGVkICVkXG4iLCBlcnIpOworCisJcmV0dXJuIGVycjsKK30KKworc3RhdGljIGludCBl
eHlub3NfdWZzX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVj
dCB1ZnNfaGJhICpoYmEgPSAgcGxhdGZvcm1fZ2V0X2RydmRhdGEocGRldik7CisKKwlwbV9ydW50
aW1lX2dldF9zeW5jKCYocGRldiktPmRldik7CisJdWZzaGNkX3JlbW92ZShoYmEpOworCXJldHVy
biAwOworfQorCitzdHJ1Y3QgZXh5bm9zX3Vmc19kcnZfZGF0YSBleHlub3NfdWZzX2RydnMgPSB7
CisKKwkuY29tcGF0aWJsZQkJPSAic2Ftc3VuZyxleHlub3M3LXVmcyIsCisJLnVpY19hdHRyCQk9
ICZleHlub3M3X3VpY19hdHRyLAorCS5xdWlya3MJCQk9IFVGU0hDRF9RVUlSS19QUkRUX0JZVEVf
R1JBTiB8CisJCQkJICBVRlNIQ0lfUVVJUktfQlJPS0VOX1JFUV9MSVNUX0NMUiB8CisJCQkJICBV
RlNIQ0lfUVVJUktfQlJPS0VOX0hDRSB8CisJCQkJICBVRlNIQ0lfUVVJUktfU0tJUF9SRVNFVF9J
TlRSX0FHR1IgfAorCQkJCSAgVUZTSENEX1FVSVJLX0JST0tFTl9PQ1NfRkFUQUxfRVJST1IsCisJ
Lm9wdHMJCQk9IEVYWU5PU19VRlNfT1BUX0hBU19BUEJfQ0xLX0NUUkwgfAorCQkJCSAgRVhZTk9T
X1VGU19PUFRfQlJPS0VOX0FVVE9fQ0xLX0NUUkwgfAorCQkJCSAgRVhZTk9TX1VGU19PUFRfQlJP
S0VOX1JYX1NFTF9JRFgsCisJLmRydl9pbml0CQk9IGV4eW5vczdfdWZzX2Rydl9pbml0LAorCS5w
cmVfbGluawkJPSBleHlub3M3X3Vmc19wcmVfbGluaywKKwkucG9zdF9saW5rCQk9IGV4eW5vczdf
dWZzX3Bvc3RfbGluaywKKwkucHJlX3B3cl9jaGFuZ2UJCT0gZXh5bm9zN191ZnNfcHJlX3B3cl9j
aGFuZ2UsCisJLnBvc3RfcHdyX2NoYW5nZQk9IGV4eW5vczdfdWZzX3Bvc3RfcHdyX2NoYW5nZSwK
K307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2ZfZGV2aWNlX2lkIGV4eW5vc191ZnNfb2ZfbWF0
Y2hbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInNhbXN1bmcsZXh5bm9zNy11ZnMiLAorCSAgLmRh
dGEJICAgICAgPSAmZXh5bm9zX3Vmc19kcnZzIH0sCisJe30sCit9OworCitzdGF0aWMgY29uc3Qg
c3RydWN0IGRldl9wbV9vcHMgZXh5bm9zX3Vmc19wbV9vcHMgPSB7CisJLnN1c3BlbmQJPSB1ZnNo
Y2RfcGx0ZnJtX3N1c3BlbmQsCisJLnJlc3VtZQkJPSB1ZnNoY2RfcGx0ZnJtX3Jlc3VtZSwKKwku
cnVudGltZV9zdXNwZW5kID0gdWZzaGNkX3BsdGZybV9ydW50aW1lX3N1c3BlbmQsCisJLnJ1bnRp
bWVfcmVzdW1lICA9IHVmc2hjZF9wbHRmcm1fcnVudGltZV9yZXN1bWUsCisJLnJ1bnRpbWVfaWRs
ZSAgICA9IHVmc2hjZF9wbHRmcm1fcnVudGltZV9pZGxlLAorfTsKKworc3RhdGljIHN0cnVjdCBw
bGF0Zm9ybV9kcml2ZXIgZXh5bm9zX3Vmc19wbHRmb3JtID0geworCS5wcm9iZQk9IGV4eW5vc191
ZnNfcHJvYmUsCisJLnJlbW92ZQk9IGV4eW5vc191ZnNfcmVtb3ZlLAorCS5zaHV0ZG93biA9IHVm
c2hjZF9wbHRmcm1fc2h1dGRvd24sCisJLmRyaXZlcgk9IHsKKwkJLm5hbWUJPSAiZXh5bm9zLXVm
c2hjIiwKKwkJLnBtCT0gJmV4eW5vc191ZnNfcG1fb3BzLAorCQkub2ZfbWF0Y2hfdGFibGUgPSBv
Zl9tYXRjaF9wdHIoZXh5bm9zX3Vmc19vZl9tYXRjaCksCisJfSwKK307Cittb2R1bGVfcGxhdGZv
cm1fZHJpdmVyKGV4eW5vc191ZnNfcGx0Zm9ybSk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3Njc2kv
dWZzL3Vmcy1leHlub3MuaCBiL2RyaXZlcnMvc2NzaS91ZnMvdWZzLWV4eW5vcy5oCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uODEzYjI4NmFmZDlkCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9zY3NpL3Vmcy91ZnMtZXh5bm9zLmgKQEAgLTAsMCArMSwyODQgQEAK
Ky8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisgKiBVRlMg
SG9zdCBDb250cm9sbGVyIGRyaXZlciBmb3IgRXh5bm9zIHNwZWNpZmljIGV4dGVuc2lvbnMKKyAq
CisgKiBDb3B5cmlnaHQgKEMpIDIwMTQtMjAxNSBTYW1zdW5nIEVsZWN0cm9uaWNzIENvLiwgTHRk
LgorICoKKyAqLworCisjaWZuZGVmIF9VRlNfRVhZTk9TX0hfCisjZGVmaW5lIF9VRlNfRVhZTk9T
X0hfCisKKy8qCisgKiBVTklQUk8gcmVnaXN0ZXJzCisgKi8KKyNkZWZpbmUgVU5JUFJPX0RCR19G
T1JDRV9ETUVfQ1RSTF9TVEFURQkJMHgxNTAKKworLyoKKyAqIE1JQnMgZm9yIFBBIGRlYnVnIHJl
Z2lzdGVycworICovCisjZGVmaW5lIFBBX0RCR19DTEtfUEVSSU9ECTB4OTUxNAorI2RlZmluZSBQ
QV9EQkdfVFhQSFlfQ0ZHVVBEVAkweDk1MTgKKyNkZWZpbmUgUEFfREJHX1JYUEhZX0NGR1VQRFQJ
MHg5NTE5CisjZGVmaW5lIFBBX0RCR19NT0RFCQkweDk1MjkKKyNkZWZpbmUgUEFfREJHX1NLSVBf
UkVTRVRfUEhZCTB4OTUzOQorI2RlZmluZSBQQV9EQkdfT1ZfVE0JCTB4OTU0MAorI2RlZmluZSBQ
QV9EQkdfU0tJUF9MSU5FX1JFU0VUCTB4OTU0MQorI2RlZmluZSBQQV9EQkdfTElORV9SRVNFVF9S
RVEJMHg5NTQzCisjZGVmaW5lIFBBX0RCR19PUFRJT05fU1VJVEUJMHg5NTY0CisjZGVmaW5lIFBB
X0RCR19PUFRJT05fU1VJVEVfRFlOCTB4OTU2NQorCisvKgorICogTUlCcyBmb3IgVHJhbnNwb3J0
IExheWVyIGRlYnVnIHJlZ2lzdGVycworICovCisjZGVmaW5lIFRfREJHX1NLSVBfSU5JVF9ISUJF
Uk44X0VYSVQJMHhjMDAxCisKKy8qCisgKiBFeHlub3MgTVBIWSBhdHRyaWJ1dGVzCisgKi8KKyNk
ZWZpbmUgVFhfTElORVJFU0VUX05fVkFMCTB4MDI3NworI2RlZmluZSBUWF9MSU5FUkVTRVRfTih2
KQkoKCh2KSA+PiAxMCkgJiAweEZGKQorI2RlZmluZSBUWF9MSU5FUkVTRVRfUF9WQUwJMHgwMjdE
CisjZGVmaW5lIFRYX0xJTkVSRVNFVF9QKHYpCSgoKHYpID4+IDEyKSAmIDB4RkYpCisjZGVmaW5l
IFRYX09WX1NMRUVQX0NOVF9USU1FUgkweDAyOEUKKyNkZWZpbmUgVFhfT1ZfSDhfRU5URVJfRU4J
KDEgPDwgNykKKyNkZWZpbmUgVFhfT1ZfU0xFRVBfQ05UKHYpCSgoKHYpID4+IDUpICYgMHg3RikK
KyNkZWZpbmUgVFhfSElHSF9aX0NOVF8xMV8wOAkweDAyOEMKKyNkZWZpbmUgVFhfSElHSF9aX0NO
VF9IKHYpCSgoKHYpID4+IDgpICYgMHhGKQorI2RlZmluZSBUWF9ISUdIX1pfQ05UXzA3XzAwCTB4
MDI4RAorI2RlZmluZSBUWF9ISUdIX1pfQ05UX0wodikJKCh2KSAmIDB4RkYpCisjZGVmaW5lIFRY
X0JBU0VfTlZBTF8wN18wMAkweDAyOTMKKyNkZWZpbmUgVFhfQkFTRV9OVkFMX0wodikJKCh2KSAm
IDB4RkYpCisjZGVmaW5lIFRYX0JBU0VfTlZBTF8xNV8wOAkweDAyOTQKKyNkZWZpbmUgVFhfQkFT
RV9OVkFMX0godikJKCgodikgPj4gOCkgJiAweEZGKQorI2RlZmluZSBUWF9HUkFOX05WQUxfMDdf
MDAJMHgwMjk1CisjZGVmaW5lIFRYX0dSQU5fTlZBTF9MKHYpCSgodikgJiAweEZGKQorI2RlZmlu
ZSBUWF9HUkFOX05WQUxfMTBfMDgJMHgwMjk2CisjZGVmaW5lIFRYX0dSQU5fTlZBTF9IKHYpCSgo
KHYpID4+IDgpICYgMHgzKQorCisjZGVmaW5lIFJYX0ZJTExFUl9FTkFCTEUJMHgwMzE2CisjZGVm
aW5lIFJYX0ZJTExFUl9FTgkJKDEgPDwgMSkKKyNkZWZpbmUgUlhfTElORVJFU0VUX1ZBTAkweDAz
MTcKKyNkZWZpbmUgUlhfTElORVJFU0VUKHYpCSgoKHYpID4+IDEyKSAmIDB4RkYpCisjZGVmaW5l
IFJYX0xDQ19JR05PUkUJCTB4MDMxOAorI2RlZmluZSBSWF9TWU5DX01BU0tfTEVOR1RICTB4MDMy
MQorI2RlZmluZSBSWF9ISUJFUk44X1dBSVRfVkFMX0JJVF8yMF8xNgkweDAzMzEKKyNkZWZpbmUg
UlhfSElCRVJOOF9XQUlUX1ZBTF9CSVRfMTVfMDgJMHgwMzMyCisjZGVmaW5lIFJYX0hJQkVSTjhf
V0FJVF9WQUxfQklUXzA3XzAwCTB4MDMzMworI2RlZmluZSBSWF9PVl9TTEVFUF9DTlRfVElNRVIJ
MHgwMzQwCisjZGVmaW5lIFJYX09WX1NMRUVQX0NOVCh2KQkoKCh2KSA+PiA2KSAmIDB4MUYpCisj
ZGVmaW5lIFJYX09WX1NUQUxMX0NOVF9USU1FUgkweDAzNDEKKyNkZWZpbmUgUlhfT1ZfU1RBTExf
Q05UKHYpCSgoKHYpID4+IDQpICYgMHhGRikKKyNkZWZpbmUgUlhfQkFTRV9OVkFMXzA3XzAwCTB4
MDM1NQorI2RlZmluZSBSWF9CQVNFX05WQUxfTCh2KQkoKHYpICYgMHhGRikKKyNkZWZpbmUgUlhf
QkFTRV9OVkFMXzE1XzA4CTB4MDM1NAorI2RlZmluZSBSWF9CQVNFX05WQUxfSCh2KQkoKCh2KSA+
PiA4KSAmIDB4RkYpCisjZGVmaW5lIFJYX0dSQU5fTlZBTF8wN18wMAkweDAzNTMKKyNkZWZpbmUg
UlhfR1JBTl9OVkFMX0wodikJKCh2KSAmIDB4RkYpCisjZGVmaW5lIFJYX0dSQU5fTlZBTF8xMF8w
OAkweDAzNTIKKyNkZWZpbmUgUlhfR1JBTl9OVkFMX0godikJKCgodikgPj4gOCkgJiAweDMpCisK
KyNkZWZpbmUgQ01OX1BXTV9DTEtfQ1RSTAkweDA0MDIKKyNkZWZpbmUgUFdNX0NMS19DVFJMX01B
U0sJMHgzCisKKyNkZWZpbmUgSUFUT1ZBTF9OU0VDCQkyMDAwMAkvKiB1bml0OiBucyAqLworI2Rl
ZmluZSBVTklQUk9fUENMS19QRVJJT0QodWZzKSAoTlNFQ19QRVJfU0VDIC8gdWZzLT5wY2xrX3Jh
dGUpCisKK3N0cnVjdCBleHlub3NfdWZzOworCisvKiB2ZW5kb3Igc3BlY2lmaWMgcHJlLWRlZmlu
ZWQgcGFyYW1ldGVycyAqLworI2RlZmluZSBTTE9XIDEKKyNkZWZpbmUgRkFTVCAyCisKKyNkZWZp
bmUgVUZTX0VYWU5PU19MSU1JVF9OVU1fTEFORVNfUlgJMgorI2RlZmluZSBVRlNfRVhZTk9TX0xJ
TUlUX05VTV9MQU5FU19UWAkyCisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfSFNHRUFSX1JYCVVG
U19IU19HMworI2RlZmluZSBVRlNfRVhZTk9TX0xJTUlUX0hTR0VBUl9UWAlVRlNfSFNfRzMKKyNk
ZWZpbmUgVUZTX0VYWU5PU19MSU1JVF9QV01HRUFSX1JYCVVGU19QV01fRzQKKyNkZWZpbmUgVUZT
X0VYWU5PU19MSU1JVF9QV01HRUFSX1RYCVVGU19QV01fRzQKKyNkZWZpbmUgVUZTX0VYWU5PU19M
SU1JVF9SWF9QV1JfUFdNCVNMT1dfTU9ERQorI2RlZmluZSBVRlNfRVhZTk9TX0xJTUlUX1RYX1BX
Ul9QV00JU0xPV19NT0RFCisjZGVmaW5lIFVGU19FWFlOT1NfTElNSVRfUlhfUFdSX0hTCUZBU1Rf
TU9ERQorI2RlZmluZSBVRlNfRVhZTk9TX0xJTUlUX1RYX1BXUl9IUwlGQVNUX01PREUKKyNkZWZp
bmUgVUZTX0VYWU5PU19MSU1JVF9IU19SQVRFCQlQQV9IU19NT0RFX0IKKyNkZWZpbmUgVUZTX0VY
WU5PU19MSU1JVF9ERVNJUkVEX01PREUJRkFTVAorCisjZGVmaW5lIFJYX0FEVl9GSU5FX0dSQU5f
U1VQX0VOCTB4MQorI2RlZmluZSBSWF9BRFZfRklORV9HUkFOX1NURVBfVkFMCTB4MworI2RlZmlu
ZSBSWF9BRFZfTUlOX0FDVFZfVElNRV9DQVAJMHg5CisKKyNkZWZpbmUgUEFfR1JBTlVMQVJJVFlf
VkFMCTB4NgorI2RlZmluZSBQQV9UQUNUSVZBVEVfVkFMCTB4MworI2RlZmluZSBQQV9ISUJFUk44
VElNRV9WQUwJMHgyMAorCitzdHJ1Y3QgZXh5bm9zX3Vmc191aWNfYXR0ciB7CisJLyogVFggQXR0
cmlidXRlcyAqLworCXVuc2lnbmVkIGludCB0eF90cmFpbGluZ2Nsa3M7CisJdW5zaWduZWQgaW50
IHR4X2RpZl9wX25zZWM7CisJdW5zaWduZWQgaW50IHR4X2RpZl9uX25zZWM7CisJdW5zaWduZWQg
aW50IHR4X2hpZ2hfel9jbnRfbnNlYzsKKwl1bnNpZ25lZCBpbnQgdHhfYmFzZV91bml0X25zZWM7
CisJdW5zaWduZWQgaW50IHR4X2dyYW5fdW5pdF9uc2VjOworCXVuc2lnbmVkIGludCB0eF9zbGVl
cF9jbnQ7CisJdW5zaWduZWQgaW50IHR4X21pbl9hY3RpdmF0ZXRpbWU7CisJLyogUlggQXR0cmli
dXRlcyAqLworCXVuc2lnbmVkIGludCByeF9maWxsZXJfZW5hYmxlOworCXVuc2lnbmVkIGludCBy
eF9kaWZfcF9uc2VjOworCXVuc2lnbmVkIGludCByeF9oaWJlcm44X3dhaXRfbnNlYzsKKwl1bnNp
Z25lZCBpbnQgcnhfYmFzZV91bml0X25zZWM7CisJdW5zaWduZWQgaW50IHJ4X2dyYW5fdW5pdF9u
c2VjOworCXVuc2lnbmVkIGludCByeF9zbGVlcF9jbnQ7CisJdW5zaWduZWQgaW50IHJ4X3N0YWxs
X2NudDsKKwl1bnNpZ25lZCBpbnQgcnhfaHNfZzFfc3luY19sZW5fY2FwOworCXVuc2lnbmVkIGlu
dCByeF9oc19nMl9zeW5jX2xlbl9jYXA7CisJdW5zaWduZWQgaW50IHJ4X2hzX2czX3N5bmNfbGVu
X2NhcDsKKwl1bnNpZ25lZCBpbnQgcnhfaHNfZzFfcHJlcF9zeW5jX2xlbl9jYXA7CisJdW5zaWdu
ZWQgaW50IHJ4X2hzX2cyX3ByZXBfc3luY19sZW5fY2FwOworCXVuc2lnbmVkIGludCByeF9oc19n
M19wcmVwX3N5bmNfbGVuX2NhcDsKKwkvKiBDb21tb24gQXR0cmlidXRlcyAqLworCXVuc2lnbmVk
IGludCBjbW5fcHdtX2Nsa19jdHJsOworCS8qIEludGVybmFsIEF0dHJpYnV0ZXMgKi8KKwl1bnNp
Z25lZCBpbnQgcGFfZGJnX29wdGlvbl9zdWl0ZTsKKwkvKiBDaGFuZ2VhYmxlIEF0dHJpYnV0ZXMg
Ki8KKwl1bnNpZ25lZCBpbnQgcnhfYWR2X2ZpbmVfZ3Jhbl9zdXBfZW47CisJdW5zaWduZWQgaW50
IHJ4X2Fkdl9maW5lX2dyYW5fc3RlcDsKKwl1bnNpZ25lZCBpbnQgcnhfbWluX2FjdHZfdGltZV9j
YXA7CisJdW5zaWduZWQgaW50IHJ4X2hpYmVybjhfdGltZV9jYXA7CisJdW5zaWduZWQgaW50IHJ4
X2Fkdl9taW5fYWN0dl90aW1lX2NhcDsKKwl1bnNpZ25lZCBpbnQgcnhfYWR2X2hpYmVybjhfdGlt
ZV9jYXA7CisJdW5zaWduZWQgaW50IHBhX2dyYW51bGFyaXR5OworCXVuc2lnbmVkIGludCBwYV90
YWN0aXZhdGU7CisJdW5zaWduZWQgaW50IHBhX2hpYmVybjh0aW1lOworfTsKKworc3RydWN0IGV4
eW5vc191ZnNfZHJ2X2RhdGEgeworCWNoYXIgKmNvbXBhdGlibGU7CisJc3RydWN0IGV4eW5vc191
ZnNfdWljX2F0dHIgKnVpY19hdHRyOworCXVuc2lnbmVkIGludCBxdWlya3M7CisJdW5zaWduZWQg
aW50IG9wdHM7CisJLyogU29DJ3Mgc3BlY2lmaWMgb3BlcmF0aW9ucyAqLworCWludCAoKmRydl9p
bml0KShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBleHlub3NfdWZzICp1ZnMpOworCWludCAo
KnByZV9saW5rKShzdHJ1Y3QgZXh5bm9zX3VmcyAqdWZzKTsKKwlpbnQgKCpwb3N0X2xpbmspKHN0
cnVjdCBleHlub3NfdWZzICp1ZnMpOworCWludCAoKnByZV9wd3JfY2hhbmdlKShzdHJ1Y3QgZXh5
bm9zX3VmcyAqdWZzLAorCQkJCXN0cnVjdCB1ZnNfcGFfbGF5ZXJfYXR0ciAqcHdyKTsKKwlpbnQg
KCpwb3N0X3B3cl9jaGFuZ2UpKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsCisJCQkJc3RydWN0IHVm
c19wYV9sYXllcl9hdHRyICpwd3IpOworfTsKKworc3RydWN0IHVmc19waHlfdGltZV9jZmcgewor
CXUzMiB0eF9saW5lcmVzZXRfcDsKKwl1MzIgdHhfbGluZXJlc2V0X247CisJdTMyIHR4X2hpZ2hf
el9jbnQ7CisJdTMyIHR4X2Jhc2Vfbl92YWw7CisJdTMyIHR4X2dyYW5fbl92YWw7CisJdTMyIHR4
X3NsZWVwX2NudDsKKwl1MzIgcnhfbGluZXJlc2V0OworCXUzMiByeF9oaWJlcm44X3dhaXQ7CisJ
dTMyIHJ4X2Jhc2Vfbl92YWw7CisJdTMyIHJ4X2dyYW5fbl92YWw7CisJdTMyIHJ4X3NsZWVwX2Nu
dDsKKwl1MzIgcnhfc3RhbGxfY250OworfTsKKworc3RydWN0IGV4eW5vc191ZnMgeworCXN0cnVj
dCB1ZnNfaGJhICpoYmE7CisJc3RydWN0IHBoeSAqcGh5OworCXZvaWQgX19pb21lbSAqcmVnX2hj
aTsKKwl2b2lkIF9faW9tZW0gKnJlZ191bmlwcm87CisJdm9pZCBfX2lvbWVtICpyZWdfdWZzcDsK
KwlzdHJ1Y3QgY2xrICpjbGtfaGNpX2NvcmU7CisJc3RydWN0IGNsayAqY2xrX3VuaXByb19tYWlu
OworCXN0cnVjdCBjbGsgKmNsa19hcGI7CisJdTMyIHBjbGtfcmF0ZTsKKwl1MzIgcGNsa19kaXY7
CisJdTMyIHBjbGtfYXZhaWxfbWluOworCXUzMiBwY2xrX2F2YWlsX21heDsKKwl1MzIgbWNsa19y
YXRlOworCWludCBhdmFpbF9sbl9yeDsKKwlpbnQgYXZhaWxfbG5fdHg7CisJaW50IHJ4X3NlbF9p
ZHg7CisJc3RydWN0IHVmc19wYV9sYXllcl9hdHRyIGRldl9yZXFfcGFyYW1zOworCXN0cnVjdCB1
ZnNfcGh5X3RpbWVfY2ZnIHRfY2ZnOworCWt0aW1lX3QgZW50cnlfaGliZXJuOF90OworCXN0cnVj
dCBleHlub3NfdWZzX2Rydl9kYXRhICpkcnZfZGF0YTsKKworCXUzMiBvcHRzOworI2RlZmluZSBF
WFlOT1NfVUZTX09QVF9IQVNfQVBCX0NMS19DVFJMCQlCSVQoMCkKKyNkZWZpbmUgRVhZTk9TX1VG
U19PUFRfU0tJUF9DT05ORUNUSU9OX0VTVEFCCUJJVCgxKQorI2RlZmluZSBFWFlOT1NfVUZTX09Q
VF9CUk9LRU5fQVVUT19DTEtfQ1RSTAlCSVQoMikKKyNkZWZpbmUgRVhZTk9TX1VGU19PUFRfQlJP
S0VOX1JYX1NFTF9JRFgJQklUKDMpCisjZGVmaW5lIEVYWU5PU19VRlNfT1BUX1VTRV9TV19ISUJF
Uk44X1RJTUVSCUJJVCg0KQorfTsKKworI2RlZmluZSBmb3JfZWFjaF91ZnNfcnhfbGFuZSh1ZnMs
IGkpIFwKKwlmb3IgKGkgPSAodWZzKS0+cnhfc2VsX2lkeDsgXAorCQlpIDwgKHVmcyktPnJ4X3Nl
bF9pZHggKyAodWZzKS0+YXZhaWxfbG5fcng7IGkrKykKKyNkZWZpbmUgZm9yX2VhY2hfdWZzX3R4
X2xhbmUodWZzLCBpKSBcCisJZm9yIChpID0gMDsgaSA8ICh1ZnMpLT5hdmFpbF9sbl90eDsgaSsr
KQorCisjZGVmaW5lIEVYWU5PU19VRlNfTU1JT19GVU5DKG5hbWUpCQkJCQkgIFwKK3N0YXRpYyBp
bmxpbmUgdm9pZCBuYW1lIyNfd3JpdGVsKHN0cnVjdCBleHlub3NfdWZzICp1ZnMsIHUzMiB2YWws
IHUzMiByZWcpXAorewkJCQkJCQkJCSAgXAorCXdyaXRlbCh2YWwsIHVmcy0+cmVnXyMjbmFtZSAr
IHJlZyk7CQkJCSAgXAorfQkJCQkJCQkJCSAgXAorCQkJCQkJCQkJICBcCitzdGF0aWMgaW5saW5l
IHUzMiBuYW1lIyNfcmVhZGwoc3RydWN0IGV4eW5vc191ZnMgKnVmcywgdTMyIHJlZykJCSAgXAor
ewkJCQkJCQkJCSAgXAorCXJldHVybiByZWFkbCh1ZnMtPnJlZ18jI25hbWUgKyByZWcpOwkJCQkg
IFwKK30KKworRVhZTk9TX1VGU19NTUlPX0ZVTkMoaGNpKTsKK0VYWU5PU19VRlNfTU1JT19GVU5D
KHVuaXBybyk7CitFWFlOT1NfVUZTX01NSU9fRlVOQyh1ZnNwKTsKKyN1bmRlZiBFWFlOT1NfVUZT
X01NSU9fRlVOQworCitsb25nIGV4eW5vc191ZnNfY2FsY190aW1lX2NudHIoc3RydWN0IGV4eW5v
c191ZnMgKiwgbG9uZyk7CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleHlub3NfdWZzX2VuYWJsZV9v
dl90bShzdHJ1Y3QgdWZzX2hiYSAqaGJhKQoreworCXVmc2hjZF9kbWVfc2V0KGhiYSwgVUlDX0FS
R19NSUIoUEFfREJHX09WX1RNKSwgVFJVRSk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBleHlu
b3NfdWZzX2Rpc2FibGVfb3ZfdG0oc3RydWN0IHVmc19oYmEgKmhiYSkKK3sKKwl1ZnNoY2RfZG1l
X3NldChoYmEsIFVJQ19BUkdfTUlCKFBBX0RCR19PVl9UTSksIEZBTFNFKTsKK30KKworc3RhdGlj
IGlubGluZSB2b2lkIGV4eW5vc191ZnNfZW5hYmxlX2RiZ19tb2RlKHN0cnVjdCB1ZnNfaGJhICpo
YmEpCit7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01JQihQQV9EQkdfTU9ERSksIFRS
VUUpOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgZXh5bm9zX3Vmc19kaXNhYmxlX2RiZ19tb2Rl
KHN0cnVjdCB1ZnNfaGJhICpoYmEpCit7CisJdWZzaGNkX2RtZV9zZXQoaGJhLCBVSUNfQVJHX01J
QihQQV9EQkdfTU9ERSksIEZBTFNFKTsKK30KKworc3RydWN0IGV4eW5vc191ZnNfZHJ2X2RhdGEg
ZXh5bm9zX3Vmc19kcnZzOworCitzdHJ1Y3QgZXh5bm9zX3Vmc191aWNfYXR0ciBleHlub3M3X3Vp
Y19hdHRyID0geworCS50eF90cmFpbGluZ2Nsa3MJCT0gMHgxMCwKKwkudHhfZGlmX3BfbnNlYwkJ
CT0gMzAwMDAwMCwJLyogdW5pdDogbnMgKi8KKwkudHhfZGlmX25fbnNlYwkJCT0gMTAwMDAwMCwJ
LyogdW5pdDogbnMgKi8KKwkudHhfaGlnaF96X2NudF9uc2VjCQk9IDIwMDAwLAkvKiB1bml0OiBu
cyAqLworCS50eF9iYXNlX3VuaXRfbnNlYwkJPSAxMDAwMDAsCS8qIHVuaXQ6IG5zICovCisJLnR4
X2dyYW5fdW5pdF9uc2VjCQk9IDQwMDAsCQkvKiB1bml0OiBucyAqLworCS50eF9zbGVlcF9jbnQJ
CQk9IDEwMDAsCQkvKiB1bml0OiBucyAqLworCS50eF9taW5fYWN0aXZhdGV0aW1lCQk9IDB4YSwK
KwkucnhfZmlsbGVyX2VuYWJsZQkJPSAweDIsCisJLnJ4X2RpZl9wX25zZWMJCQk9IDEwMDAwMDAs
CS8qIHVuaXQ6IG5zICovCisJLnJ4X2hpYmVybjhfd2FpdF9uc2VjCQk9IDQwMDAwMDAsCS8qIHVu
aXQ6IG5zICovCisJLnJ4X2Jhc2VfdW5pdF9uc2VjCQk9IDEwMDAwMCwJLyogdW5pdDogbnMgKi8K
KwkucnhfZ3Jhbl91bml0X25zZWMJCT0gNDAwMCwJCS8qIHVuaXQ6IG5zICovCisJLnJ4X3NsZWVw
X2NudAkJCT0gMTI4MCwJCS8qIHVuaXQ6IG5zICovCisJLnJ4X3N0YWxsX2NudAkJCT0gMzIwLAkJ
LyogdW5pdDogbnMgKi8KKwkucnhfaHNfZzFfc3luY19sZW5fY2FwCQk9IFNZTkNfTEVOX0NPQVJT
RSgweGYpLAorCS5yeF9oc19nMl9zeW5jX2xlbl9jYXAJCT0gU1lOQ19MRU5fQ09BUlNFKDB4Ziks
CisJLnJ4X2hzX2czX3N5bmNfbGVuX2NhcAkJPSBTWU5DX0xFTl9DT0FSU0UoMHhmKSwKKwkucnhf
aHNfZzFfcHJlcF9zeW5jX2xlbl9jYXAJPSBQUkVQX0xFTigweGYpLAorCS5yeF9oc19nMl9wcmVw
X3N5bmNfbGVuX2NhcAk9IFBSRVBfTEVOKDB4ZiksCisJLnJ4X2hzX2czX3ByZXBfc3luY19sZW5f
Y2FwCT0gUFJFUF9MRU4oMHhmKSwKKwkucGFfZGJnX29wdGlvbl9zdWl0ZQkJPSAweDMwMTAzLAor
fTsKKyNlbmRpZiAvKiBfVUZTX0VYWU5PU19IXyAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zY3Np
L3Vmcy91bmlwcm8uaCBiL2RyaXZlcnMvc2NzaS91ZnMvdW5pcHJvLmgKaW5kZXggNzY2ZDU1MWRm
M2ZjLi40ZWU2NDc4MmZkNDggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc2NzaS91ZnMvdW5pcHJvLmgK
KysrIGIvZHJpdmVycy9zY3NpL3Vmcy91bmlwcm8uaApAQCAtNjQsOCArNjQsMjUgQEAKICNkZWZp
bmUgQ0ZHUlhPVlI0CQkJCTB4MDBFOQogI2RlZmluZSBSWFNRQ1RSTAkJCQkweDAwQjUKICNkZWZp
bmUgQ0ZHUlhPVlI2CQkJCTB4MDBCRgorI2RlZmluZSBSWF9IU19HMV9TWU5DX0xFTkdUSF9DQVAJ
CTB4MDA4QgorI2RlZmluZSBSWF9IU19HMV9QUkVQX0xFTkdUSF9DQVAJCTB4MDA4QworI2RlZmlu
ZSBSWF9IU19HMl9TWU5DX0xFTkdUSF9DQVAJCTB4MDA5NAorI2RlZmluZSBSWF9IU19HM19TWU5D
X0xFTkdUSF9DQVAJCTB4MDA5NQorI2RlZmluZSBSWF9IU19HMl9QUkVQX0xFTkdUSF9DQVAJCTB4
MDA5NgorI2RlZmluZSBSWF9IU19HM19QUkVQX0xFTkdUSF9DQVAJCTB4MDA5NworI2RlZmluZSBS
WF9BRFZfR1JBTlVMQVJJVFlfQ0FQCQkJMHgwMDk4CisjZGVmaW5lIFJYX01JTl9BQ1RJVkFURVRJ
TUVfQ0FQCQkJMHgwMDhGCisjZGVmaW5lIFJYX0hJQkVSTjhUSU1FX0NBUAkJCTB4MDA5MgorI2Rl
ZmluZSBSWF9BRFZfSElCRVJOOFRJTUVfQ0FQCQkJMHgwMDk5CisjZGVmaW5lIFJYX0FEVl9NSU5f
QUNUSVZBVEVUSU1FX0NBUAkJMHgwMDlBCisKIAogI2RlZmluZSBpc19tcGh5X3R4X2F0dHIoYXR0
cikJCQkoYXR0ciA8IFJYX01PREUpCisjZGVmaW5lIFJYX0FEVl9GSU5FX0dSQU5fU1RFUCh4KQkJ
KCgoKHgpICYgMHgzKSA8PCAxKSB8IDB4MSkKKyNkZWZpbmUgU1lOQ19MRU5fRklORSh4KQkJCSgo
eCkgJiAweDNGKQorI2RlZmluZSBTWU5DX0xFTl9DT0FSU0UoeCkJCQkoKDEgPDwgNikgfCAoKHgp
ICYgMHgzRikpCisjZGVmaW5lIFBSRVBfTEVOKHgpCQkJCSgoeCkgJiAweEYpCisKICNkZWZpbmUg
UlhfTUlOX0FDVElWQVRFVElNRV9VTklUX1VTCQkxMDAKICNkZWZpbmUgSElCRVJOOFRJTUVfVU5J
VF9VUwkJCTEwMAogCkBAIC0xMjQsNiArMTQxLDcgQEAKICNkZWZpbmUgUEFfUEFDUFJFUUVPQlRJ
TUVPVVQJMHgxNTkxCiAjZGVmaW5lIFBBX0hJQkVSTjhUSU1FCQkweDE1QTcKICNkZWZpbmUgUEFf
TE9DQUxWRVJJTkZPCQkweDE1QTkKKyNkZWZpbmUgUEFfR1JBTlVMQVJJVFkJCTB4MTVBQQogI2Rl
ZmluZSBQQV9UQUNUSVZBVEUJCTB4MTVBOAogI2RlZmluZSBQQV9QQUNQRlJBTUVDT1VOVAkweDE1
QzAKICNkZWZpbmUgUEFfUEFDUEVSUk9SQ09VTlQJMHgxNUMxCkBAIC0yOTEsNCArMzA5LDE5IEBA
IGVudW0gewogCVRSVUUsCiB9OwogCisvKiBDUG9ydCBzZXR0aW5nICovCisjZGVmaW5lIEUyRUZD
X09OCSgxIDw8IDApCisjZGVmaW5lIEUyRUZDX09GRgkoMCA8PCAwKQorI2RlZmluZSBDU0RfTl9P
TgkoMCA8PCAxKQorI2RlZmluZSBDU0RfTl9PRkYJKDEgPDwgMSkKKyNkZWZpbmUgQ1NWX05fT04J
KDAgPDwgMikKKyNkZWZpbmUgQ1NWX05fT0ZGCSgxIDw8IDIpCisjZGVmaW5lIENQT1JUX0RFRl9G
TEFHUwkoQ1NWX05fT0ZGIHwgQ1NEX05fT0ZGIHwgRTJFRkNfT0ZGKQorCisvKiBDUG9ydCBjb25u
ZWN0aW9uIHN0YXRlICovCitlbnVtIHsKKwlDUE9SVF9JRExFID0gMCwKKwlDUE9SVF9DT05ORUNU
RUQsCit9OworCiAjZW5kaWYgLyogX1VOSVBST19IXyAqLwotLSAKMi4xNy4xCgoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KbGludXgtYXJtLWtlcm5lbCBt
YWlsaW5nIGxpc3QKbGludXgtYXJtLWtlcm5lbEBsaXN0cy5pbmZyYWRlYWQub3JnCmh0dHA6Ly9s
aXN0cy5pbmZyYWRlYWQub3JnL21haWxtYW4vbGlzdGluZm8vbGludXgtYXJtLWtlcm5lbAo=
