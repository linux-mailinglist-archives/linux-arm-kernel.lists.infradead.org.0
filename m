Return-Path: <linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-arm-kernel@lfdr.de
Delivered-To: lists+linux-arm-kernel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id BE2F711C443
	for <lists+linux-arm-kernel@lfdr.de>; Thu, 12 Dec 2019 04:43:09 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:References:In-Reply-To:
	Message-Id:Date:Subject:To:From:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=NcAAThldBk+hna/XFBTUdJWqcjfuhF5qBWA+W0KlRhE=; b=m69cgXUuq8p4Df
	WrrvGgLKigivrFNOIvTNytbD1EGVXiu5WxKzD4pnCoX+td9zh6p+kKy8hn7bVOcWoc0tnVaR4Tf3Q
	o5d4dygtwp0BnhROvHO3Y3VyZkB362w18/zmE2vj+vn/suF+pCADkvjZ9NFKUuKV1TKKPSmQdgacc
	0F4+G0y0wfBL0UJHsfui4H+sXNIowIEzRUFHWKH8bg1FPfExdlAcahkqQvENJG8oiJTuDLFixw1D+
	VXePWF4ZkmHPU+5YINkNvUE3Vu7YL0iyXyAcv6z9qrtQ02bzHlCU/cAMtB1MRf+eI0neVoWLuCymz
	r7r/s82qtib+FtEUYbMg==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1ifFNb-0004HG-SO; Thu, 12 Dec 2019 03:43:07 +0000
Received: from mx2.suse.de ([195.135.220.15] helo=mx1.suse.de)
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1ifFKb-0000Op-47; Thu, 12 Dec 2019 03:40:09 +0000
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id D1D8BAF21;
 Thu, 12 Dec 2019 03:39:59 +0000 (UTC)
From: =?UTF-8?q?Andreas=20F=C3=A4rber?= <afaerber@suse.de>
To: linux-realtek-soc@lists.infradead.org,
	linux-leds@vger.kernel.org
Subject: [RFC 07/25] leds: Add Titan Micro Electronics TM1628
Date: Thu, 12 Dec 2019 04:39:34 +0100
Message-Id: <20191212033952.5967-8-afaerber@suse.de>
X-Mailer: git-send-email 2.16.4
In-Reply-To: <20191212033952.5967-1-afaerber@suse.de>
References: <20191212033952.5967-1-afaerber@suse.de>
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20191211_194001_472620_35C44DB1 
X-CRM114-Status: GOOD (  17.66  )
X-Spam-Score: -2.3 (--)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-2.3 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -2.3 RCVD_IN_DNSWL_MED      RBL: Sender listed at https://www.dnswl.org/,
 medium trust [195.135.220.15 listed in list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
X-BeenThere: linux-arm-kernel@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-arm-kernel.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-arm-kernel/>
List-Post: <mailto:linux-arm-kernel@lists.infradead.org>
List-Help: <mailto:linux-arm-kernel-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-arm-kernel>, 
 <mailto:linux-arm-kernel-request@lists.infradead.org?subject=subscribe>
Cc: linux-kernel@vger.kernel.org, Jacek Anaszewski <jacek.anaszewski@gmail.com>,
 Pavel Machek <pavel@ucw.cz>, zypeng@titanmec.com,
 =?UTF-8?q?Andreas=20F=C3=A4rber?= <afaerber@suse.de>,
 linux-arm-kernel@lists.infradead.org, Dan Murphy <dmurphy@ti.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "linux-arm-kernel" <linux-arm-kernel-bounces@lists.infradead.org>
Errors-To: linux-arm-kernel-bounces+lists+linux-arm-kernel=lfdr.de@lists.infradead.org

QWRkIGEgZHJpdmVyIGZvciBUTTE2MjggTEVEIGNvbnRyb2xsZXIuCgpDYzogenlwZW5nQHRpdGFu
bWVjLmNvbQpTaWduZWQtb2ZmLWJ5OiBBbmRyZWFzIEbDpHJiZXIgPGFmYWVyYmVyQHN1c2UuZGU+
Ci0tLQogZHJpdmVycy9sZWRzL0tjb25maWcgICAgICAgfCAgMTEgKysKIGRyaXZlcnMvbGVkcy9N
YWtlZmlsZSAgICAgIHwgICAxICsKIGRyaXZlcnMvbGVkcy9sZWRzLXRtMTYyOC5jIHwgNDIwICsr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogMyBmaWxlcyBjaGFu
Z2VkLCA0MzIgaW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvbGVkcy9s
ZWRzLXRtMTYyOC5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9sZWRzL0tjb25maWcgYi9kcml2ZXJz
L2xlZHMvS2NvbmZpZwppbmRleCA0YjY4NTIwYWMyNTEuLmYzYWZiNDE5YTlhMSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9sZWRzL0tjb25maWcKKysrIGIvZHJpdmVycy9sZWRzL0tjb25maWcKQEAgLTgz
Niw2ICs4MzYsMTcgQEAgY29uZmlnIExFRFNfTE0zNjI3NAogCSAgU2F5IFkgdG8gZW5hYmxlIHRo
ZSBMTTM2Mjc0IExFRCBkcml2ZXIgZm9yIFRJIExNVSBkZXZpY2VzLgogCSAgVGhpcyBzdXBwb3J0
cyB0aGUgTEVEIGRldmljZSBMTTM2Mjc0LgogCitjb25maWcgTEVEU19UTTE2MjgKKwl0cmlzdGF0
ZSAiTEVEIGRyaXZlciBmb3IgVE0xNjI4IgorCWRlcGVuZHMgb24gTEVEU19DTEFTUworCWRlcGVu
ZHMgb24gU1BJCisJZGVwZW5kcyBvbiBPRiB8fCBDT01QSUxFX1RFU1QKKwloZWxwCisJICBTYXkg
WSB0byBlbmFibGUgc3VwcG9ydCBmb3IgVGl0YW4gTWljcm8gRWxlY3Ryb25pY3MgVE0xNjI4CisJ
ICBMRUQgY29udHJvbGxlcnMuCisJICBUaGV5IGFyZSAzLXdpcmUgU1BJIGRldmljZXMgY29udHJv
bGxpbmcgYSB0d28tZGltZW5zaW9uYWwgZ3JpZCBvZgorCSAgTEVEcy4gRGltbWluZyBpcyBhcHBs
aWVkIHRvIGFsbCBvdXRwdXRzIHRocm91Z2ggYW4gaW50ZXJuYWwgUFdNLgorCiBjb21tZW50ICJM
RUQgVHJpZ2dlcnMiCiBzb3VyY2UgImRyaXZlcnMvbGVkcy90cmlnZ2VyL0tjb25maWciCiAKZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbGVkcy9NYWtlZmlsZSBiL2RyaXZlcnMvbGVkcy9NYWtlZmlsZQpp
bmRleCAyZGEzOWU4OTZjZTguLjRjOTMxMDAyZWY0NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9sZWRz
L01ha2VmaWxlCisrKyBiL2RyaXZlcnMvbGVkcy9NYWtlZmlsZQpAQCAtOTAsNiArOTAsNyBAQCBv
YmotJChDT05GSUdfTEVEU19MTTM2Mjc0KQkJKz0gbGVkcy1sbTM2Mjc0Lm8KIG9iai0kKENPTkZJ
R19MRURTX0NSMDAxNDExNCkJCSs9IGxlZHMtY3IwMDE0MTE0Lm8KIG9iai0kKENPTkZJR19MRURT
X0RBQzEyNFMwODUpCQkrPSBsZWRzLWRhYzEyNHMwODUubwogb2JqLSQoQ09ORklHX0xFRFNfRUwx
NTIwMzAwMCkJCSs9IGxlZHMtZWwxNTIwMzAwMC5vCitvYmotJChDT05GSUdfTEVEU19UTTE2Mjgp
CQkrPSBsZWRzLXRtMTYyOC5vCiAKICMgTEVEIFVzZXJzcGFjZSBEcml2ZXJzCiBvYmotJChDT05G
SUdfTEVEU19VU0VSKQkJCSs9IHVsZWRzLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbGVkcy9sZWRz
LXRtMTYyOC5jIGIvZHJpdmVycy9sZWRzL2xlZHMtdG0xNjI4LmMKbmV3IGZpbGUgbW9kZSAxMDA2
NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4zMTliZjM0Y2U4MzUKLS0tIC9kZXYvbnVsbAorKysgYi9k
cml2ZXJzL2xlZHMvbGVkcy10bTE2MjguYwpAQCAtMCwwICsxLDQyMCBAQAorLy8gU1BEWC1MaWNl
bnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb3ItbGF0ZXIKKy8qCisgKiBUaXRhbiBNaWNybyBFbGVj
dHJvbmljcyBUTTE2MjggTEVEIGNvbnRyb2xsZXIKKyAqCisgKiBDb3B5cmlnaHQgKGMpIDIwMTkg
QW5kcmVhcyBGw6RyYmVyCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2JpdG9wcy5oPgorI2luY2x1
ZGUgPGxpbnV4L2xlZHMuaD4KKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxs
aW51eC9wcm9wZXJ0eS5oPgorI2luY2x1ZGUgPGxpbnV4L3B3bS5oPgorI2luY2x1ZGUgPGxpbnV4
L3NwaS9zcGkuaD4KKworI2RlZmluZSBUTTE2MjhfQ01EX01BU0sJCQlHRU5NQVNLKDcsIDYpCisj
ZGVmaW5lIFRNMTYyOF9DTURfRElTUExBWV9NT0RFCQkoMHgwIDw8IDYpCisjZGVmaW5lIFRNMTYy
OF9DTURfREFUQV9TRVRUSU5HCQkoMHgxIDw8IDYpCisjZGVmaW5lIFRNMTYyOF9DTURfRElTUExB
WV9DVFJMCQkoMHgyIDw8IDYpCisjZGVmaW5lIFRNMTYyOF9DTURfQUREUkVTU19TRVRUSU5HCSgw
eDMgPDwgNikKKworI2RlZmluZSBUTTE2MjhfRElTUExBWV9NT0RFX01PREVfTUFTSwlHRU5NQVNL
KDEsIDApCisKKyNkZWZpbmUgVE0xNjI4X0RBVEFfU0VUVElOR19NT0RFX01BU0sJR0VOTUFTSygx
LCAwKQorI2RlZmluZSBUTTE2MjhfREFUQV9TRVRUSU5HX1dSSVRFX0RBVEEJMHgwCisjZGVmaW5l
IFRNMTYyOF9EQVRBX1NFVFRJTkdfUkVBRF9EQVRBCTB4MgorI2RlZmluZSBUTTE2MjhfREFUQV9T
RVRUSU5HX0ZJWEVEX0FERFIJQklUKDIpCisjZGVmaW5lIFRNMTYyOF9EQVRBX1NFVFRJTkdfVEVT
VF9NT0RFCUJJVCgzKQorCisjZGVmaW5lIFRNMTYyOF9ESVNQTEFZX0NUUkxfUFdfTUFTSwlHRU5N
QVNLKDIsIDApCisKKyNkZWZpbmUgVE0xNjI4X0RJU1BMQVlfQ1RSTF9ESVNQTEFZX09OCUJJVCgz
KQorCitzdHJ1Y3QgdG0xNjI4X21vZGUgeworCXU4CWdyaWRfbWFzazsKKwl1MTYJc2VnX21hc2s7
Cit9OworCitzdHJ1Y3QgdG0xNjI4X2luZm8geworCXU4CQkJCWdyaWRfbWFzazsKKwl1MTYJCQkJ
c2VnX21hc2s7CisJY29uc3Qgc3RydWN0IHRtMTYyOF9tb2RlCSptb2RlczsKKwlpbnQJCQkJZGVm
YXVsdF9tb2RlOworCWNvbnN0IHN0cnVjdCBwd21fY2FwdHVyZQkqcHdtX21hcDsKKwlpbnQJCQkJ
ZGVmYXVsdF9wd207Cit9OworCitzdHJ1Y3QgdG0xNjI4X2xlZCB7CisJc3RydWN0IGxlZF9jbGFz
c2RldglsZWRkZXY7CisJc3RydWN0IHRtMTYyOAkJKmN0cmw7CisJdTMyCQkJZ3JpZDsKKwl1MzIJ
CQlzZWc7Cit9OworCitzdHJ1Y3QgdG0xNjI4IHsKKwlzdHJ1Y3Qgc3BpX2RldmljZQkJKnNwaTsK
Kwljb25zdCBzdHJ1Y3QgdG0xNjI4X2luZm8JKmluZm87CisJdTMyCQkJCWdyaWRzOworCXVuc2ln
bmVkIGludAkJCXNlZ21lbnRzOworCWludAkJCQltb2RlX2luZGV4OworCWludAkJCQlwd21faW5k
ZXg7CisJdTgJCQkJZGF0YVsxNF07CisJdW5zaWduZWQgaW50CQkJbnVtX2xlZHM7CisJc3RydWN0
IHRtMTYyOF9sZWQJCWxlZHNbXTsKK307CisKKy8qIENvbW1hbmQgMTogRGlzcGxheSBNb2RlIFNl
dHRpbmcgKi8KK3N0YXRpYyBpbnQgdG0xNjI4X3NldF9kaXNwbGF5X21vZGUoc3RydWN0IHNwaV9k
ZXZpY2UgKnNwaSwgdTggZ3JpZF9tb2RlKQoreworCXU4IGNtZCA9IFRNMTYyOF9DTURfRElTUExB
WV9NT0RFOworCisJaWYgKHVubGlrZWx5KGdyaWRfbW9kZSAmIH5UTTE2MjhfRElTUExBWV9NT0RF
X01PREVfTUFTSykpCisJCXJldHVybiAtRUlOVkFMOworCisJY21kIHw9IGdyaWRfbW9kZTsKKwor
CXJldHVybiBzcGlfd3JpdGUoc3BpLCAmY21kLCAxKTsKK30KKworLyogQ29tbWFuZCAyOiBEYXRh
IFNldHRpbmcgKi8KK3N0YXRpYyBpbnQgdG0xNjI4X3dyaXRlX2RhdGEoc3RydWN0IHNwaV9kZXZp
Y2UgKnNwaSwgY29uc3QgdTggKmRhdGEsIHVuc2lnbmVkIGludCBsZW4pCit7CisJdTggY21kID0g
VE0xNjI4X0NNRF9EQVRBX1NFVFRJTkcgfCBUTTE2MjhfREFUQV9TRVRUSU5HX1dSSVRFX0RBVEE7
CisJc3RydWN0IHNwaV90cmFuc2ZlciB4ZmVyc1tdID0geworCQl7CisJCQkudHhfYnVmID0gJmNt
ZCwKKwkJCS5sZW4gPSAxLAorCQl9LAorCQl7CisJCQkudHhfYnVmID0gZGF0YSwKKwkJCS5sZW4g
PSBsZW4sCisJCX0sCisJfTsKKworCWlmIChsZW4gPiAxNCkKKwkJcmV0dXJuIC1FSU5WQUw7CisK
KwlyZXR1cm4gc3BpX3N5bmNfdHJhbnNmZXIoc3BpLCB4ZmVycywgQVJSQVlfU0laRSh4ZmVycykp
OworfQorCisvKiBDb21tYW5kIDM6IEFkZHJlc3MgU2V0dGluZyAqLworc3RhdGljIGludCB0bTE2
Mjhfc2V0X2FkZHJlc3Moc3RydWN0IHNwaV9kZXZpY2UgKnNwaSwgdTggYWRkcikKK3sKKwl1OCBj
bWQgPSBUTTE2MjhfQ01EX0FERFJFU1NfU0VUVElORzsKKworCWNtZCB8PSAoYWRkciAmIEdFTk1B
U0soMywgMCkpOworCisJcmV0dXJuIHNwaV93cml0ZShzcGksICZjbWQsIDEpOworfQorCisvKiBD
b21tYW5kIDQ6IERpc3BsYXkgQ29udHJvbCAqLworc3RhdGljIGludCB0bTE2Mjhfc2V0X2Rpc3Bs
YXlfY3RybChzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpLCBib29sIG9uLCB1OCBwd21faW5kZXgpCit7
CisJdTggY21kID0gVE0xNjI4X0NNRF9ESVNQTEFZX0NUUkw7CisKKwlpZiAob24pCisJCWNtZCB8
PSBUTTE2MjhfRElTUExBWV9DVFJMX0RJU1BMQVlfT047CisKKwlpZiAocHdtX2luZGV4ICYgflRN
MTYyOF9ESVNQTEFZX0NUUkxfUFdfTUFTSykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwljbWQgfD0g
cHdtX2luZGV4OworCisJcmV0dXJuIHNwaV93cml0ZShzcGksICZjbWQsIDEpOworfQorCitzdGF0
aWMgaW5saW5lIGJvb2wgdG0xNjI4X2lzX3ZhbGlkX2dyaWQoc3RydWN0IHRtMTYyOCAqcywgdW5z
aWduZWQgaW50IGdyaWQpCit7CisJcmV0dXJuIHMtPmluZm8tPm1vZGVzW3MtPm1vZGVfaW5kZXhd
LmdyaWRfbWFzayAmIEJJVChncmlkKTsKK30KKworc3RhdGljIGlubGluZSBib29sIHRtMTYyOF9p
c192YWxpZF9zZWcoc3RydWN0IHRtMTYyOCAqcywgdW5zaWduZWQgaW50IHNlZykKK3sKKwlyZXR1
cm4gcy0+aW5mby0+bW9kZXNbcy0+bW9kZV9pbmRleF0uc2VnX21hc2sgJiBCSVQoc2VnKTsKK30K
Kworc3RhdGljIGludCB0bTE2MjhfZ2V0X2xlZF9vZmZzZXQoc3RydWN0IHRtMTYyOCAqcywKKwl1
bnNpZ25lZCBpbnQgZ3JpZCwgdW5zaWduZWQgaW50IHNlZywgaW50ICpwb2Zmc2V0LCBpbnQgKnBi
aXQpCit7CisJaW50IG9mZnNldCwgYml0OworCisJaWYgKGdyaWQgPT0gMCB8fCBncmlkID4gNyB8
fCBzZWcgPT0gMCB8fCBzZWcgPiAxNikKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlvZmZzZXQgPSAo
Z3JpZCAtIDEpICogMjsKKwliaXQgPSBzZWcgLSAxOworCWlmIChiaXQgPj0gOCkgeworCQliaXQg
LT0gODsKKwkJb2Zmc2V0Kys7CisJfQorCisJKnBvZmZzZXQgPSBvZmZzZXQ7CisJaWYgKHBiaXQp
CisJCSpwYml0ID0gYml0OworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdG0xNjI4X2dl
dF9sZWQoc3RydWN0IHRtMTYyOCAqcywKKwl1bnNpZ25lZCBpbnQgZ3JpZCwgdW5zaWduZWQgaW50
IHNlZywgYm9vbCAqb24pCit7CisJaW50IG9mZnNldCwgYml0OworCWludCByZXQ7CisKKwlyZXQg
PSB0bTE2MjhfZ2V0X2xlZF9vZmZzZXQocywgZ3JpZCwgc2VnLCAmb2Zmc2V0LCAmYml0KTsKKwlp
ZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJKm9uID0gISEocy0+ZGF0YVtvZmZzZXRdICYgQklU
KGJpdCkpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdG0xNjI4X3NldF9sZWQoc3Ry
dWN0IHRtMTYyOCAqcywKKwl1bnNpZ25lZCBpbnQgZ3JpZCwgdW5zaWduZWQgaW50IHNlZywgYm9v
bCBvbikKK3sKKwlpbnQgb2Zmc2V0LCBiaXQ7CisJaW50IHJldDsKKworCXJldCA9IHRtMTYyOF9n
ZXRfbGVkX29mZnNldChzLCBncmlkLCBzZWcsICZvZmZzZXQsICZiaXQpOworCWlmIChyZXQpCisJ
CXJldHVybiByZXQ7CisKKwlpZiAob24pCisJCXMtPmRhdGFbb2Zmc2V0XSB8PSAgQklUKGJpdCk7
CisJZWxzZQorCQlzLT5kYXRhW29mZnNldF0gJj0gfkJJVChiaXQpOworCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyBpbnQgdG0xNjI4X2xlZF9zZXRfYnJpZ2h0bmVzcyhzdHJ1Y3QgbGVkX2NsYXNz
ZGV2ICpsZWRfY2RldiwKKwllbnVtIGxlZF9icmlnaHRuZXNzIGJyaWdodG5lc3MpCit7CisJc3Ry
dWN0IHRtMTYyOF9sZWQgKmxlZCA9IGNvbnRhaW5lcl9vZihsZWRfY2Rldiwgc3RydWN0IHRtMTYy
OF9sZWQsIGxlZGRldik7CisJc3RydWN0IHRtMTYyOCAqcyA9IGxlZC0+Y3RybDsKKwlpbnQgcmV0
LCBvZmZzZXQ7CisKKwlyZXQgPSB0bTE2Mjhfc2V0X2xlZChzLCBsZWQtPmdyaWQsIGxlZC0+c2Vn
LCBicmlnaHRuZXNzICE9IExFRF9PRkYpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwly
ZXQgPSB0bTE2MjhfZ2V0X2xlZF9vZmZzZXQocywgbGVkLT5ncmlkLCBsZWQtPnNlZywgJm9mZnNl
dCwgTlVMTCk7CisJaWYgKHVubGlrZWx5KHJldCkpCisJCXJldHVybiByZXQ7CisKKwlyZXQgPSB0
bTE2Mjhfc2V0X2FkZHJlc3Mocy0+c3BpLCBvZmZzZXQpOworCWlmIChyZXQpCisJCXJldHVybiBy
ZXQ7CisKKwlyZXR1cm4gdG0xNjI4X3dyaXRlX2RhdGEocy0+c3BpLCBzLT5kYXRhICsgb2Zmc2V0
LCAxKTsKK30KKworc3RhdGljIGVudW0gbGVkX2JyaWdodG5lc3MgdG0xNjI4X2xlZF9nZXRfYnJp
Z2h0bmVzcyhzdHJ1Y3QgbGVkX2NsYXNzZGV2ICpsZWRfY2RldikKK3sKKwlzdHJ1Y3QgdG0xNjI4
X2xlZCAqbGVkID0gY29udGFpbmVyX29mKGxlZF9jZGV2LCBzdHJ1Y3QgdG0xNjI4X2xlZCwgbGVk
ZGV2KTsKKwlzdHJ1Y3QgdG0xNjI4ICpzID0gbGVkLT5jdHJsOworCWJvb2wgb247CisJaW50IHJl
dDsKKworCXJldCA9IHRtMTYyOF9nZXRfbGVkKHMsIGxlZC0+Z3JpZCwgbGVkLT5zZWcsICZvbik7
CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiBvbiA/IExFRF9PTiA6IExFRF9P
RkY7Cit9CisKK3N0YXRpYyBpbnQgdG0xNjI4X3JlZ2lzdGVyX2xlZChzdHJ1Y3QgdG0xNjI4ICpz
LAorCXN0cnVjdCBmd25vZGVfaGFuZGxlICpub2RlLCB1MzIgZ3JpZCwgdTMyIHNlZywgc3RydWN0
IHRtMTYyOF9sZWQgKmxlZCkKK3sKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcy0+c3BpLT5kZXY7
CisJc3RydWN0IGxlZF9pbml0X2RhdGEgaW5pdF9kYXRhID0gezB9OworCisJaWYgKCF0bTE2Mjhf
aXNfdmFsaWRfZ3JpZChzLCBncmlkKSB8fCAhdG0xNjI4X2lzX3ZhbGlkX3NlZyhzLCBzZWcpKSB7
CisJCWRldl93YXJuKGRldiwgIiVzIHJlZyBvdXQgb2YgcmFuZ2VcbiIsIGZ3bm9kZV9nZXRfbmFt
ZShub2RlKSk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWxlZC0+Y3RybCA9IHM7CisJbGVk
LT5ncmlkID0gZ3JpZDsKKwlsZWQtPnNlZyAgPSBzZWc7CisJbGVkLT5sZWRkZXYubWF4X2JyaWdo
dG5lc3MgPSBMRURfT047CisJbGVkLT5sZWRkZXYuYnJpZ2h0bmVzc19zZXRfYmxvY2tpbmcgPSB0
bTE2MjhfbGVkX3NldF9icmlnaHRuZXNzOworCWxlZC0+bGVkZGV2LmJyaWdodG5lc3NfZ2V0ID0g
dG0xNjI4X2xlZF9nZXRfYnJpZ2h0bmVzczsKKworCWZ3bm9kZV9wcm9wZXJ0eV9yZWFkX3N0cmlu
Zyhub2RlLCAibGludXgsZGVmYXVsdC10cmlnZ2VyIiwgJmxlZC0+bGVkZGV2LmRlZmF1bHRfdHJp
Z2dlcik7CisKKwlpbml0X2RhdGEuZndub2RlID0gbm9kZTsKKwlpbml0X2RhdGEuZGV2aWNlbmFt
ZSA9ICJ0bTE2MjgiOworCisJcmV0dXJuIGRldm1fbGVkX2NsYXNzZGV2X3JlZ2lzdGVyX2V4dChk
ZXYsICZsZWQtPmxlZGRldiwgJmluaXRfZGF0YSk7Cit9CisKKy8qIFdvcmsgYXJvdW5kIF9fYnVp
bHRpbl9wb3Bjb3VudCgpICovCitzdGF0aWMgdTMyIHRtMTYyOF9ncmlkX3BvcGNvdW50KHU4IGdy
aWRfbWFzaykKK3sKKwlpbnQgaSwgbiA9IDA7CisKKwl3aGlsZSAoZ3JpZF9tYXNrKSB7CisJCWkg
PSBfX2ZmcyhncmlkX21hc2spOworCQlncmlkX21hc2sgJj0gfkJJVChpKTsKKwkJbisrOworCX0K
KworCXJldHVybiBuOworfQorCitzdGF0aWMgaW50IHRtMTYyOF9zcGlfcHJvYmUoc3RydWN0IHNw
aV9kZXZpY2UgKnNwaSkKK3sKKwlzdHJ1Y3QgdG0xNjI4ICpzOworCXN0cnVjdCBmd25vZGVfaGFu
ZGxlICpjaGlsZDsKKwl1MzIgZ3JpZHM7CisJdTMyIHJlZ1syXTsKKwlzaXplX3QgbGVkczsKKwlp
bnQgcmV0LCBpOworCisJbGVkcyA9IGRldmljZV9nZXRfY2hpbGRfbm9kZV9jb3VudCgmc3BpLT5k
ZXYpOworCisJcyA9IGRldm1fa3phbGxvYygmc3BpLT5kZXYsIHN0cnVjdF9zaXplKHMsIGxlZHMs
IGxlZHMpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXMpCisJCXJldHVybiAtRU5PTUVNOworCisJcy0+
c3BpID0gc3BpOworCisJcy0+aW5mbyA9IGRldmljZV9nZXRfbWF0Y2hfZGF0YSgmc3BpLT5kZXYp
OworCWlmICghcy0+aW5mbykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlzLT5wd21faW5kZXggPSBz
LT5pbmZvLT5kZWZhdWx0X3B3bTsKKworCXJldCA9IHRtMTYyOF9zZXRfZGlzcGxheV9jdHJsKHNw
aSwgZmFsc2UsIHMtPnB3bV9pbmRleCk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKCZzcGktPmRl
diwgIlR1cm5pbmcgZGlzcGxheSBvZmYgZmFpbGVkICglZClcbiIsIHJldCk7CisJCXJldHVybiBy
ZXQ7CisJfQorCisJcmV0ID0gZGV2aWNlX3Byb3BlcnR5X3JlYWRfdTMyKCZzcGktPmRldiwgIiNn
cmlkcyIsICZncmlkcyk7CisJaWYgKHJldCAmJiByZXQgIT0gLUVJTlZBTCkgeworCQlkZXZfZXJy
KCZzcGktPmRldiwgIkVycm9yIHJlYWRpbmcgI2dyaWRzIHByb3BlcnR5ICglZClcbiIsIHJldCk7
CisJCXJldHVybiByZXQ7CisJfQorCisJcy0+bW9kZV9pbmRleCA9IC0xOworCWZvciAoaSA9IDA7
IGkgPCA0OyBpKyspIHsKKwkJaWYgKHRtMTYyOF9ncmlkX3BvcGNvdW50KHMtPmluZm8tPm1vZGVz
W2ldLmdyaWRfbWFzaykgIT0gZ3JpZHMpCisJCQljb250aW51ZTsKKwkJcy0+bW9kZV9pbmRleCA9
IGk7CisJCWJyZWFrOworCX0KKwlpZiAocy0+bW9kZV9pbmRleCA9PSAtMSkgeworCQlkZXZfZXJy
KCZzcGktPmRldiwgIiNncmlkcyBvdXQgb2YgcmFuZ2UgKCV1KVxuIiwgZ3JpZHMpOworCQlyZXR1
cm4gLUVJTlZBTDsKKwl9CisKKwlzcGlfc2V0X2RydmRhdGEoc3BpLCBzKTsKKworCWRldmljZV9m
b3JfZWFjaF9jaGlsZF9ub2RlKCZzcGktPmRldiwgY2hpbGQpIHsKKwkJcmV0ID0gZndub2RlX3By
b3BlcnR5X3JlYWRfdTMyX2FycmF5KGNoaWxkLCAicmVnIiwgcmVnLCAyKTsKKwkJaWYgKHJldCkg
eworCQkJZGV2X2Vycigmc3BpLT5kZXYsICJSZWFkaW5nICVzIHJlZyBwcm9wZXJ0eSBmYWlsZWQg
KCVkKVxuIiwKKwkJCQlmd25vZGVfZ2V0X25hbWUoY2hpbGQpLCByZXQpOworCQkJZndub2RlX2hh
bmRsZV9wdXQoY2hpbGQpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJCWlmIChmd25vZGVfcHJv
cGVydHlfY291bnRfdTMyKGNoaWxkLCAicmVnIikgPT0gMikgeworCQkJcmV0ID0gdG0xNjI4X3Jl
Z2lzdGVyX2xlZChzLCBjaGlsZCwgcmVnWzBdLCByZWdbMV0sICZzLT5sZWRzW2krK10pOworCQkJ
aWYgKHJldCAmJiByZXQgIT0gLUVJTlZBTCkgeworCQkJCWRldl9lcnIoJnNwaS0+ZGV2LCAiRmFp
bGVkIHRvIHJlZ2lzdGVyIExFRCAlcyAoJWQpXG4iLAorCQkJCQlmd25vZGVfZ2V0X25hbWUoY2hp
bGQpLCByZXQpOworCQkJCWZ3bm9kZV9oYW5kbGVfcHV0KGNoaWxkKTsKKwkJCQlyZXR1cm4gcmV0
OworCQkJfQorCQkJcy0+bnVtX2xlZHMrKzsKKwkJfQorCX0KKworCXJldCA9IHRtMTYyOF9zZXRf
YWRkcmVzcyhzcGksIDB4MCk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKCZzcGktPmRldiwgIlNl
dHRpbmcgYWRkcmVzcyBmYWlsZWQgKCVkKVxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisK
KwlyZXQgPSB0bTE2Mjhfd3JpdGVfZGF0YShzcGksIHMtPmRhdGEsIHNpemVvZihzLT5kYXRhKSk7
CisJaWYgKHJldCkgeworCQlkZXZfZXJyKCZzcGktPmRldiwgIldyaXRpbmcgZGF0YSBmYWlsZWQg
KCVkKVxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSB0bTE2Mjhfc2V0X2Rp
c3BsYXlfbW9kZShzcGksIHMtPm1vZGVfaW5kZXgpOworCWlmIChyZXQpIHsKKwkJZGV2X2Vycigm
c3BpLT5kZXYsICJTZXR0aW5nIGRpc3BsYXkgbW9kZSBmYWlsZWQgKCVkKVxuIiwgcmV0KTsKKwkJ
cmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSB0bTE2Mjhfc2V0X2Rpc3BsYXlfY3RybChzcGksIHRy
dWUsIHMtPnB3bV9pbmRleCk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKCZzcGktPmRldiwgIlR1
cm5pbmcgZGlzcGxheSBvbiBmYWlsZWQgKCVkKVxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBwd21fY2FwdHVyZSB0bTE2
MjhfcHdtX21hcFs4XSA9IHsKKwl7IC5kdXR5X2N5Y2xlID0gIDEsIC5wZXJpb2QgPSAxNiB9LAor
CXsgLmR1dHlfY3ljbGUgPSAgMiwgLnBlcmlvZCA9IDE2IH0sCisJeyAuZHV0eV9jeWNsZSA9ICA0
LCAucGVyaW9kID0gMTYgfSwKKwl7IC5kdXR5X2N5Y2xlID0gMTAsIC5wZXJpb2QgPSAxNiB9LAor
CXsgLmR1dHlfY3ljbGUgPSAxMSwgLnBlcmlvZCA9IDE2IH0sCisJeyAuZHV0eV9jeWNsZSA9IDEy
LCAucGVyaW9kID0gMTYgfSwKKwl7IC5kdXR5X2N5Y2xlID0gMTMsIC5wZXJpb2QgPSAxNiB9LAor
CXsgLmR1dHlfY3ljbGUgPSAxNCwgLnBlcmlvZCA9IDE2IH0sCit9OworCitzdGF0aWMgY29uc3Qg
c3RydWN0IHRtMTYyOF9tb2RlIHRtMTYyOF9tb2Rlc1s0XSA9IHsKKwl7CisJCS5ncmlkX21hc2sg
PSBHRU5NQVNLKDQsIDEpLAorCQkuc2VnX21hc2sgPSBHRU5NQVNLKDE0LCAxMikgfCBHRU5NQVNL
KDEwLCAxKSwKKwl9LAorCXsKKwkJLmdyaWRfbWFzayA9IEdFTk1BU0soNSwgMSksCisJCS5zZWdf
bWFzayA9IEdFTk1BU0soMTMsIDEyKSB8IEdFTk1BU0soMTAsIDEpLAorCX0sCisJeworCQkuZ3Jp
ZF9tYXNrID0gR0VOTUFTSyg2LCAxKSwKKwkJLnNlZ19tYXNrID0gQklUKDEyKSB8IEdFTk1BU0so
MTAsIDEpLAorCX0sCisJeworCQkuZ3JpZF9tYXNrID0gR0VOTUFTSyg3LCAxKSwKKwkJLnNlZ19t
YXNrID0gR0VOTUFTSygxMCwgMSksCisJfSwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdG0x
NjI4X2luZm8gdG0xNjI4X2luZm8gPSB7CisJLmdyaWRfbWFzayA9IEdFTk1BU0soNywgMSksCisJ
LnNlZ19tYXNrID0gR0VOTUFTSygxNCwgMTIpIHwgR0VOTUFTSygxMCwgMSksCisJLm1vZGVzID0g
dG0xNjI4X21vZGVzLAorCS5kZWZhdWx0X21vZGUgPSAzLAorCS5wd21fbWFwID0gdG0xNjI4X3B3
bV9tYXAsCisJLmRlZmF1bHRfcHdtID0gMCwKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3Qgb2Zf
ZGV2aWNlX2lkIHRtMTYyOF9zcGlfb2ZfbWF0Y2hlc1tdID0geworCXsgLmNvbXBhdGlibGUgPSAi
dGl0YW5tZWMsdG0xNjI4IiwgLmRhdGEgPSAmdG0xNjI4X2luZm8gfSwKKwl7fQorfTsKK01PRFVM
RV9ERVZJQ0VfVEFCTEUob2YsIHRtMTYyOF9zcGlfb2ZfbWF0Y2hlcyk7CisKK3N0YXRpYyBzdHJ1
Y3Qgc3BpX2RyaXZlciB0bTE2Mjhfc3BpX2RyaXZlciA9IHsKKwkucHJvYmUgPSB0bTE2Mjhfc3Bp
X3Byb2JlLAorCS5kcml2ZXIgPSB7CisJCS5uYW1lID0gInRtMTYyOCIsCisJCS5vZl9tYXRjaF90
YWJsZSA9IHRtMTYyOF9zcGlfb2ZfbWF0Y2hlcywKKwl9LAorfTsKK21vZHVsZV9zcGlfZHJpdmVy
KHRtMTYyOF9zcGlfZHJpdmVyKTsKKworTU9EVUxFX0RFU0NSSVBUSU9OKCJUTTE2MjggTEVEIGNv
bnRyb2xsZXIgZHJpdmVyIik7CitNT0RVTEVfQVVUSE9SKCJBbmRyZWFzIEbDpHJiZXIiKTsKK01P
RFVMRV9MSUNFTlNFKCJHUEwiKTsKLS0gCjIuMTYuNAoKCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCmxpbnV4LWFybS1rZXJuZWwgbWFpbGluZyBsaXN0Cmxp
bnV4LWFybS1rZXJuZWxAbGlzdHMuaW5mcmFkZWFkLm9yZwpodHRwOi8vbGlzdHMuaW5mcmFkZWFk
Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbnV4LWFybS1rZXJuZWwK
